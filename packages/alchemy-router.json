{"name":"alchemy-router","description":"alchemy-router is the gateway from HTTP to Alchemy Resources for the Alchemy Micro-services Framework","version":"1.0.2","homepage":"https://github.com/LoyaltyNZ/alchemy-router","repository":"https://github.com/LoyaltyNZ/alchemy-router","bin":{"alchemy-router":"./bin/alchemy-router"},"main":"src/alchemy-router.litcoffee","engines":{"node":">= 0.12.7"},"dependencies":{"coffee-script":"1.10.0","express":"4.13.3","bluebird":"2.9.34","lodash":"3.10.1","alchemy-ether":"1.0.0","qs":"4.0.0","dotenv":"1.1.0"},"devDependencies":{"mocha":"2.2.5","chai":"2.3.0","sinon":"1.14.1","request":"2.51.0","throat":"2.0.2"},"scripts":{"test":"mocha","doc":"cat src/alchemy-router.litcoffee > README.md && docco -l linear src/alchemy-router.litcoffee && docco src/*.coffee -o docs/src && docco examples/*.coffee -o docs/examples"},"license":"LGPL-3.0","gitHead":"8ac1301919876317bad414aad35f3f0a38319f40","versions":[{"number":"0.0.1","date":"2015-12-22T01:57:02.629Z"},{"number":"0.0.2","date":"2015-12-22T21:32:39.410Z"},{"number":"0.0.3","date":"2016-01-06T23:38:00.590Z"},{"number":"0.0.4","date":"2016-01-26T02:50:40.337Z"},{"number":"0.0.5","date":"2016-02-10T22:10:19.719Z"},{"number":"1.0.0","date":"2016-02-29T03:20:28.882Z"},{"number":"1.0.2","date":"2016-05-13T05:04:12.889Z"}],"readme":"# Alchemy Router\n\n[![npm version](https://badge.fury.io/js/alchemy-router.svg)](https://badge.fury.io/js/alchemy-router)\n[![Build Status](https://travis-ci.org/LoyaltyNZ/alchemy-router.svg?branch=master)](https://travis-ci.org/LoyaltyNZ/alchemy-router)\n[![License](https://img.shields.io/badge/license-LGPL--3.0-blue.svg)](http://www.gnu.org/licenses/lgpl-3.0.en.html)\n\nAlchemy Router is the gateway from HTTP to Alchemy Resources for the [Alchemy Micro-services Framework](https://github.com/LoyaltyNZ/alchemy-framework). It can be used directly as an application or as a library to build and customise using [express](http://expressjs.com/en/guide/using-middleware.html) middleware and routes.\n\n## Router Application\n\nTo install the alchemy router run:\n\n```\nnpm install -g alchemy-router\n```\n\nThen execute:\n\n```\nalchemy-router\n```\n\nYou can configure the router with the environment variables:\n\n1. `AMQP_URI`  *default `'amqp://localhost'`*: the location of the (RabbitMQ) AMQP server\n2. `PORT` *default `8080`*: the port to open the HTTP server on\n3. `TIMEOUT` *default `5000`*: the router will return a `408` timeout response after waiting for the service.\n4. `PATHS` *default `'{}'`*: the JSON string that matches service queues directly with paths, e.g. `PATHS='{\"/hello\" : 'service.hello'}'` will direct all calls that start with path `/hello` to the queue `service.hello`.\n\n### Docker\n\nThis repository also comes with an example Docker container, which is published to the docker hub.\n\nBuild the Docker container with:\n\n```\ndocker build -t alchemy-router:$VERSION .\n```\n\nPush the docker container with:\n\n```\ndocker push alchemy-router:$VERSION\n```\n\n## Router Library\n\nTo install the router as a library:\n\n```\nnpm install alchemy-router\n```\n\nTo start a router:\n\n```coffeescript\nAlchemyRouter = require 'alchemy-router'\nrouter = new AlchemyRouter()\nrouter.start()\n```\n\n### Middleware\n\nMiddleware can be used to extend the routers with custom functionality. Middleware are objects with a `callback` that is an [express middleware](http://expressjs.com/en/guide/using-middleware.html) callback function, an optional `start` and `stop` functions that can control the life cycle of the middleware.\n\n```coffeescript\nlogging_middleware = {\n  callback: (req, res, next) ->\n    console.log req.path\n    next()\n\n  # promise to start middleware\n  start: -> true\n\n  # promise to stop middleware\n  stop: -> true\n}\n\nAlchemyRouter = require 'alchemy-router'\nrouter = new AlchemyRouter()\nrouter.start({\n  middleware: [logging_middleware]\n})\n```\n\n### Additional Routes\n\nAdditional hard-coded routes can be added to the router, these can be useful for health-checks, logging, versioning ... *Note: these routes will override any service routes.*\n\n```coffeescript\nhello_route = (app) ->\n  app.get '/hello', (req, res) =>\n    res.send {say: \"hello\"}\n    res.end()\n\nAlchemyRouter = require 'alchemy-router'\nrouter = new AlchemyRouter()\nrouter.start({\n  additional_routes: [hello_route]\n})\n```\n\n## Documentation\n\n*This Alchemy-Router documentation is generated with [docco](https://jashkenas.github.io/docco/) from its annotated source code.*\n\nThe Alchemy-Router package exports [Router](./src/router.html):\n\n    module.exports = require(\"./router\")\n\n## Examples\n\n* [Sending a message to a Resource](./examples/example_1_send_message.html)\n\n","created":"2015-12-22T01:57:02.629Z","modified":"2016-05-13T05:04:12.889Z","lastPublisher":{"name":"loyaltynz","email":"cloudservices@loyalty.co.nz"},"owners":[{"name":"grahamjenson","email":"grahamjenson@maori.geek.nz"},{"name":"loyaltynz","email":"cloudservices@loyalty.co.nz"}],"other":{"_attachments":{},"_from":".","_id":"alchemy-router","_nodeVersion":"4.4.4","_npmOperationalInternal":{"host":"packages-16-east.internal.npmjs.com","tmp":"tmp/alchemy-router-1.0.2.tgz_1463115851004_0.7261660925578326"},"_npmUser":{"name":"loyaltynz","email":"cloudservices@loyalty.co.nz"},"_npmVersion":"2.15.1","_rev":"1-0d06d5c806e8e39d8d1237665418bbcc","_shasum":"2a278d3d74dd4d15be37cd816742e04d4bb771b8","author":{"name":"Graham Jenson","email":"Graham.Jenson@loyalty.co.nz"},"bugs":{"url":"https://github.com/LoyaltyNZ/alchemy-router/issues"},"directories":{},"dist-tags":{"latest":"1.0.2"},"dist":{"shasum":"2a278d3d74dd4d15be37cd816742e04d4bb771b8","tarball":"http://registry.npmjs.org/alchemy-router/-/alchemy-router-1.0.2.tgz"},"maintainers":[{"name":"grahamjenson","email":"grahamjenson@maori.geek.nz"},{"name":"loyaltynz","email":"cloudservices@loyalty.co.nz"}],"readmeFilename":"README.md","time":{"modified":"2016-05-13T05:04:12.889Z","created":"2015-12-22T01:57:02.629Z","0.0.1":"2015-12-22T01:57:02.629Z","0.0.2":"2015-12-22T21:32:39.410Z","0.0.3":"2016-01-06T23:38:00.590Z","0.0.4":"2016-01-26T02:50:40.337Z","0.0.5":"2016-02-10T22:10:19.719Z","1.0.0":"2016-02-29T03:20:28.882Z","1.0.2":"2016-05-13T05:04:12.889Z"}}}