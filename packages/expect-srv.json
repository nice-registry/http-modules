{"name":"expect-srv","version":"1.0.0","description":"Fake Http Server for testing","main":"index.js","scripts":{"test":"standard && nyc jasmine"},"repository":"https://github.com/maxpolun/expect-srv","license":"ISC","homepage":"https://github.com/maxpolun/expect-srv#readme","devDependencies":{"jasmine":"^2.4.1","nyc":"^6.4.4","standard":"^7.1.2"},"standard":{"globals":["jasmine","it","fit","describe","beforeEach","afterEach","expect"]},"nyc":{"exclude":["spec/**"]},"gitHead":"475bf384a94003cf5afeb0bffdda6085960eb667","versions":[{"number":"1.0.0","date":"2016-06-15T19:08:37.699Z"}],"readme":"Expect-srv\n==========\n\nA fake HTTP server for testing.\n\n## Why?\n\nOptions:\n\n1. Nock or similar: have similar benefit to Expect-srv, but work totally in-\nprocess, making it unsuitable for end-to-end testing of isomorphic/universal\napps.\n\n2. VCR clones (VCR.js, yakbak, etc): work with isomorphic apps, but some APIs\nare hard to test repeatably when you aren't also in control of the server\n(think things like registration), and especially they can be hard to use when\nan API is under development.\n\nexpect-srv is for the other cases, where you want a real server (especially for universal/isomorphic javascript apps), but don't want to use a record/playback type test server, but rather specify the responses directly.\n\n## Getting it\n\n```sh\n$ npm install --save-dev expect-srv\n```\n\n## Usage\n\n```js\nlet ExpectSrv = require('expect-srv')\nlet server = new ExpectSrv({\n  port: 8888\n})\n\n// shorthand\nserver.get('/path', {\n  body: {\n    json: true\n  }\n})\n\nserver.post('/path', {\n  body: {\n    json: true\n  },\n}, {\n  body: {\n    json: true\n  },\n  headers: {\n    'Content-Type': 'xxx/yyy'\n  }\n})\n\n// fully general API\nserver.expect({\n  accept (request) {\n    // check if the request should be handled by this expectation\n    // this just returns true for the shorthands because they always are handled in order\n    // no other callbacks are called if this returns false\n  },\n  valid (request) {\n    // does the request match our expectation?\n  }\n  respond (request, response) {\n    // send response if acceptable\n    // tries to json-stringify return-values and send as response\n    // or you can just write to http response object\n  },\n  repeat (request) {\n    // do we keep accepting responses?\n  }\n})\n\nserver.listen()\n\n// if any expectations are pending, throw an error.\n// can be skipped if you set up routes that will always return\nserver.noPendingExpectations()\n// checks that all exptations are valid\nserver.validate()\n\nserver.close()\n```\n\n## Example, using jasmine\n\n```js\ndescribe('echo', () => {\n  let server\n  beforeEach(() => {\n    server = new ExpectSrv({port: 8888})\n    server.post('/echo', {\n      x: 1\n    }, {\n      x: 1\n    })\n    server.listen()\n  })\n\n  afterEach(() => {\n    server.allExpectationsMatched()\n    server.validate()\n    server.close()\n  })\n\n  it('echos', (done) => {\n    fetch('http://localhost:8888/echo', { method: 'POST', body: JSON.stringify({x: 1})})\n      .then(res => res.json())\n      .then(json => expect(json).toEqual({x: 1}))\n      .then(done)\n      .catch(done.fail)\n  })\n})\n```\n","created":"2016-06-15T19:08:37.699Z","modified":"2016-06-15T19:08:37.699Z","lastPublisher":{"name":"maxpolun","email":"maxpolun@gmail.com"},"owners":[{"name":"maxpolun","email":"maxpolun@gmail.com"}],"other":{"_attachments":{},"_from":".","_id":"expect-srv","_nodeVersion":"6.0.0","_npmOperationalInternal":{"host":"packages-12-west.internal.npmjs.com","tmp":"tmp/expect-srv-1.0.0.tgz_1466017715400_0.7181923754978925"},"_npmUser":{"name":"maxpolun","email":"maxpolun@gmail.com"},"_npmVersion":"3.8.6","_rev":"1-59e048380e36263504863ef55bdad3b9","_shasum":"9602f547f5ffe8c081dc35a71191195e5e968541","author":{"name":"Max Polun","email":"maxpolun@gmail.com"},"bugs":{"url":"https://github.com/maxpolun/expect-srv/issues"},"directories":{},"dist-tags":{"latest":"1.0.0"},"dist":{"shasum":"9602f547f5ffe8c081dc35a71191195e5e968541","tarball":"http://registry.npmjs.org/expect-srv/-/expect-srv-1.0.0.tgz"},"maintainers":[{"name":"maxpolun","email":"maxpolun@gmail.com"}],"readmeFilename":"README.md","time":{"modified":"2016-06-15T19:08:37.699Z","created":"2016-06-15T19:08:37.699Z","1.0.0":"2016-06-15T19:08:37.699Z"}}}