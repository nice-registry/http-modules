{"name":"sails-affiliate-tracker","version":"0.0.1","description":"A simple http middleware package to track your websites affiliates visitors in a sails application","main":"index.js","scripts":{"test":"echo \"Error: no test specified\" && exit 1"},"keywords":["sails.js","node.js","express","middleware","affiliate"],"license":"MIT","gitHead":"f483935ec5389f7ac8ac888eb8fb2216ed331e4e","versions":[{"number":"0.0.1","date":"2015-10-06T04:51:02.158Z"}],"readme":"# sails-affiliate-tracker\n\nsails-affiliate-tracker is middleware that can be used to track your application affiliate's by\nchecking if an affiliate code is present in the URL.\n\nIt will assign a cookie '{referral:1234}' to the request, if one does not already exist, based on a user ID found from the username in the URL after a Users.find({username:username}) query.\n\nThis is quite a rigid package and will only work if you want your affiliate URL structures in the format of: http://mydomain.com/{unique-affiliate-username} or http://mydomain.com/page1/page2/etc/{unique-affiliate-username}.\nIt will not work for query strings, although it could be modified quite easily to do so. I just do not have the need to do so.\n\nHowever, it does have some nifty features for SEO, in that it will NOT perform a redirect to serve the original page. Instead it will modify the req.url to\nremove the affiliates username and pass that through behind the scenes - meaning your normal routes apply and controller logic for that page is executed. \n\nOne other SEO thing it will do is provide your views with a parameter for canonical links, should it be required. You use it like this in your view files:\n\n    <% if(typeof req.affiliateTracker !== 'undefined' && typeof req.affiliateTracker.canon !== 'undefined'){ %>\n\t<link rel=\"canonical\" href=\"<%= sails.getBaseurl() + req.affiliateTracker.canon %>\" />\n\t<% } %>\n\n\n## Installation\n\nVia git:\n\n    $ git clone git://github.com/mrpetef10/sails-affiliate-tracker.git ~/.node_libraries/sails-affiliate-tracker\n\nVia npm:\n\n    $ npm install sails-affiliate-tracker\n\n## Setup\n\nThere are a couple of things you must do to set this up first.\n\n1) Require this in your config/http.js config file and add an entry 'affiliateTracker' after cookieParser:\n\n     middleware: {\n   \n\t\taffiliateTracker: require('sails-affiliate-tracker'),\n\n\t  /***************************************************************************\n\t  *                                                                          *\n\t  * The order in which middleware should be run for HTTP request. (the Sails *\n\t  * router is invoked by the \"router\" middleware below.)                     *\n\t  *                                                                          *\n\t  ***************************************************************************/\n\n     order: [\n\t\t.....,\n\t\t.....,\n\t\t'cookieParser',\n\t\t'affiliateTracker',\n\t\t.....,\n\t\t.....,\n     ],\n\n\n\n2) Since I am still new to working with node.js/sails.js I am unsure how to actually pass custom config vars to this middleware (I would welcome anyone to create a pull request with an update to add this in!). Due to that you need to go into the node_modules/sails-affiliate-tracker/index.js file, go to line 42 and change the regex to your specific affiliate URL format. I set mine to use:\n\n\t// Will match /page1/user-mrpetef10\n\t// or /page1/user-anotherusername\n\tvar regex = /^user-[\\w]{5,22}$/i;\n\nI set it in this way so that it is easily extractable from URLs and I could still if I want to in future link to my users profile pages without concern of this breaking it.\n\nNot the best way to creating this I know, however it is an initial version that took around 15 mins to put together.","created":"2015-10-06T04:51:02.158Z","modified":"2015-10-06T04:51:02.158Z","lastPublisher":{"name":"mrpetem","email":"pete_mardell@hotmail.com"},"owners":[{"name":"mrpetem","email":"pete_mardell@hotmail.com"}],"other":{"_attachments":{},"_from":".","_id":"sails-affiliate-tracker","_nodeVersion":"0.12.0","_npmUser":{"name":"mrpetem","email":"pete_mardell@hotmail.com"},"_npmVersion":"2.5.1","_rev":"1-e59fa9b77c34f9d60f5a2b48c93a2a98","_shasum":"76e59f0f66db75aa4c515ec4e26fa38f26302437","author":{"name":"Pete Mardell"},"directories":{},"dist-tags":{"latest":"0.0.1"},"dist":{"shasum":"76e59f0f66db75aa4c515ec4e26fa38f26302437","tarball":"http://registry.npmjs.org/sails-affiliate-tracker/-/sails-affiliate-tracker-0.0.1.tgz"},"maintainers":[{"name":"mrpetem","email":"pete_mardell@hotmail.com"}],"readmeFilename":"README.md","time":{"modified":"2015-10-06T04:51:02.158Z","created":"2015-10-06T04:51:02.158Z","0.0.1":"2015-10-06T04:51:02.158Z"}}}