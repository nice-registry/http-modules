{"name":"aws_es","version":"1.1.2","description":"Creates a clone of the http class that signs each request before its sent.","main":"index.js","scripts":{"test":"echo \"Error: no test specified\" && exit 1"},"license":"MIT","dependencies":{"aws4":"~1.2.1"},"gitHead":"00a1aa640201ba6eba05e50bcb6328718aaa9934","versions":[{"number":"1.0.0","date":"2015-10-28T16:58:09.930Z"},{"number":"1.1.0","date":"2015-10-31T20:16:11.819Z"},{"number":"1.1.1","date":"2015-11-09T00:28:22.921Z"},{"number":"1.1.2","date":"2016-03-03T02:48:42.182Z"}],"readme":"# Minimal AWS Elasticsearch connector\n\nCreates a clone of the http class that signs each request before its sent.\n\nUsage:\n```js\nvar elasticsearch = require('elasticsearch');\nrequire('aws_es')(elasticsearch);\n\nvar client = new elasticsearch.Client({\n  host : 'xxxxx.es.amazonaws.com',\n  amazonES: {\n    region : 'us-east-1',\n    accessKey : 'XXXX',\n    secretKey : 'XXXX'\n  }\n})\n\n```\n\nConfig variables `service`, `region`, `accessKey` and `secretKey` can be defined in an `amazonES` object at client creation.  Alternatively, service defaults to 'es', region defaults to 'us-east-1' and the keys default to environment variables: `AWS_ACCESS_KEY_ID` and `AWS_SECRET_ACCESS_KEY`\n\nThe complete code is as follows: \n\n```js\nvar aws4 = require('aws4');\n\nmodule.exports = function(es) {\n  var pool = es.ConnectionPool,\n      http = pool.connectionClasses.http;\n\n  var aws = function() { http.apply(this,arguments); };\n  require('util').inherits(aws,http);\n\n  aws.prototype.createAgent = function(config) {\n    this._amazonES = config.amazonES || {};\n    http.prototype.createAgent.call(this,config);\n  };\n\n  aws.prototype.makeReqParams = function (_params) {\n    var params = http.prototype.makeReqParams.call(this,_params);\n    params.body = _params.body;\n    params.headers = params.headers || {};\n    params.headers['Content-Type'] = params.headers['Content-Type'] || 'application/json';\n    if (params.gzip === undefined) params.gzip = true;\n\n    var config = this._amazonES;\n    params.service =  config.service || 'es';\n    params.region = config.region || 'us-east-1';\n    \n    aws4.sign(params,{\n      accessKeyId: config.accessKey || process.env.AWS_ACCESS_KEY_ID,\n      secretAccessKey: config.secretKey || process.env.AWS_SECRET_ACCESS_KEY\n    });\n    \n    return params;\n  };\n\n  pool.defaultConnectionClass = 'aws';\n  pool.connectionClasses.aws = aws;\n  return es;\n};\n```","created":"2015-10-28T16:58:09.930Z","modified":"2016-03-03T02:48:42.182Z","lastPublisher":{"name":"zjonsson","email":"ziggy.jonsson.nyc@gmail.com"},"owners":[{"name":"zjonsson","email":"ziggy.jonsson.nyc@gmail.com"}],"other":{"_attachments":{},"_from":".","_id":"aws_es","_nodeVersion":"5.6.0","_npmOperationalInternal":{"host":"packages-12-west.internal.npmjs.com","tmp":"tmp/aws_es-1.1.2.tgz_1456973318902_0.6842328500933945"},"_npmUser":{"name":"zjonsson","email":"ziggy.jonsson.nyc@gmail.com"},"_npmVersion":"3.5.3","_rev":"1-f6bebd27ec6e1753259332c28b38fbc2","_shasum":"29b5f3db8d3c846aa2ca54828fcebc70380ee7d2","author":{"name":"Ziggy Jonsson https://github.com/ZJONSSON"},"directories":{},"dist-tags":{"latest":"1.1.2"},"dist":{"shasum":"29b5f3db8d3c846aa2ca54828fcebc70380ee7d2","tarball":"http://registry.npmjs.org/aws_es/-/aws_es-1.1.2.tgz"},"maintainers":[{"name":"zjonsson","email":"ziggy.jonsson.nyc@gmail.com"}],"readmeFilename":"README.md","time":{"modified":"2016-03-03T02:48:42.182Z","created":"2015-10-28T16:58:09.930Z","1.0.0":"2015-10-28T16:58:09.930Z","1.1.0":"2015-10-31T20:16:11.819Z","1.1.1":"2015-11-09T00:28:22.921Z","1.1.2":"2016-03-03T02:48:42.182Z"}}}