{"name":"strummer-middleware","version":"1.1.0","description":"HTTP middleware to validate requests with strummer","main":"index.js","scripts":{"test":"mocha","lint":"require-lint && eslint ."},"license":"MIT","repository":"https://github.com/TabDigital/node-strummer-middleware","devDependencies":{"chai":"^3.5.0","eslint":"^2.5.3","mocha":"^2.4.5","require-lint":"^1.1.1"},"gitHead":"4d42baf7e6eb960a8596f91eecbd32e33f69e6c1","homepage":"https://github.com/TabDigital/node-strummer-middleware#readme","versions":[{"number":"1.0.0","date":"2016-04-26T04:20:12.185Z"},{"number":"1.1.0","date":"2016-04-26T09:03:48.307Z"}],"readme":"# strummer-middleware\n\n[![NPM](http://img.shields.io/npm/v/strummer.svg?style=flat-square)](https://npmjs.org/package/strummer-middleware)\n[![License](http://img.shields.io/npm/l/node-strummer-middleware.svg?style=flat-square)](https://github.com/TabDigital/node-strummer-middleware)\n\n[![Build Status](https://travis-ci.com/TabDigital/node-strummer-middleware.svg?token=RfpP7WAYQqnR4gnFRm4r&branch=master)](https://travis-ci.com/TabDigital/node-strummer-middleware)\n\n## Description\n\nWraps your [strummer](https://github.com/TabDigital/strummer) validation logic into middleware ready for a HTTP request!\n\n## Usage\n\n```bash\nnpm install strummer-middleware --save\n```\n\n```js\nvar s = require('strummer');\nvar sware = require('strummer-middleware');\n\nvar validate = sware({\n  body: s({ id: 'uuid', name: 'string', age: 'number' })\n});\n\nserver.post('/users', validate, controller);\n```\n\n`strummer-middleware` can validate 4 areas of the request:\n\n```js\nsware({\n  params:   /* match req.params    */\n  query:    /* match req.query    */\n  body:     /* match req.body     */\n  headers:  /* match req.headers  */\n})\n```\n\nThese fields were chosen because they are a well established standard. `strummer-middleware` is not responsible for creating `req.params`, `req.query` or `req.body`, you must follow the documentation of your web framework.\n\nCustom fields can be added using the method `setValidationArea(name, errorString)`. For example:\n\n```js\nsware.setValidationArea('jwt', 'Invalid JWT');\nsware({\n  jwt: {\n    'iss': 'string'\n  }\n})\n```\n\n## Error handling\n\n`strummer-middleware` will call `next(err)` in case of validation errors.\nIn [Express](http://expressjs.com/) this means you will also need to set up an error handler.\n\n```js\nfunction errorHandler(err, req, res, next) {\n  res.statusCode(400).send('Bad request')\n}\n\n// global handler\nserver.use(errorHandler)\n\n// or local handler\nserver.post('/users', validation, errorHandler, controller)\n```\n\nThe `err` object also contains more information:\n\n```js\nconsole.log(err.message)\nconsole.log(err.details)\n```\n\n## Strummer integration\n\nNote that [strummer](https://github.com/TabDigital/strummer) is not included in `package.json` as a dependency, peerDependency or devDependency. This is to ensure we stay compatible with most versions of Node.\n\nIt also makes it very obvious which version of `strummer` you are using. For example, if `strummer-middleware` bundled its own version the following code would be quite confusing:\n\n```js\nvar s = require('strummer')\n\nsware({\n  body: {\n    name: 'string',    // would use the built-in version\n    age: s.custom()    // would use the provided version\n  }\n})\n```\n\nInstead of `strummer`, you can also choose to use a custom validation library,\nas long as matchers have a `.match(path, value)` function that returns an array.\n","created":"2016-04-26T04:20:12.185Z","modified":"2016-04-26T09:03:48.307Z","lastPublisher":{"name":"tabdigital","email":"npm@tabdigital.com.au"},"owners":[{"name":"tabdigital","email":"npm@tabdigital.com.au"}],"other":{"_attachments":{},"_from":".","_id":"strummer-middleware","_nodeVersion":"4.2.3","_npmOperationalInternal":{"host":"packages-12-west.internal.npmjs.com","tmp":"tmp/strummer-middleware-1.1.0.tgz_1461661427700_0.5696717991959304"},"_npmUser":{"name":"tabdigital","email":"npm@tabdigital.com.au"},"_npmVersion":"2.14.7","_rev":"1-98a864653a3020c23c43c46d14599518","_shasum":"2be2ca09092df0ab18fe1ad694eac918ecacd5f0","author":{"name":"Tabcorp Digital Team"},"bugs":{"url":"https://github.com/TabDigital/node-strummer-middleware/issues"},"directories":{},"dist-tags":{"latest":"1.1.0"},"dist":{"shasum":"2be2ca09092df0ab18fe1ad694eac918ecacd5f0","tarball":"http://registry.npmjs.org/strummer-middleware/-/strummer-middleware-1.1.0.tgz"},"maintainers":[{"name":"tabdigital","email":"npm@tabdigital.com.au"}],"readmeFilename":"README.md","time":{"modified":"2016-04-26T09:03:48.307Z","created":"2016-04-26T04:20:12.185Z","1.0.0":"2016-04-26T04:20:12.185Z","1.1.0":"2016-04-26T09:03:48.307Z"}}}