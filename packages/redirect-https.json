{"name":"redirect-https","version":"1.1.4","description":"Redirect from HTTP to HTTPS using meta redirects","main":"index.js","scripts":{"test":"echo \"Error: no test specified\" && exit 1"},"repository":{"type":"git","url":"git+https://git.daplie.com/Daplie/node-redirect-https.git"},"keywords":["https","http","redirect","force","upgrade","location","meta"],"license":"Apache-2.0","homepage":"https://git.daplie.com/Daplie/node-redirect-https#readme","dependencies":{"escape-html":"^1.0.2"},"gitHead":"1a73ffd7c4cd5607cd1dc32dfedb82289c588cf1","versions":[{"number":"1.0.0","date":"2015-07-07T23:20:06.572Z"},{"number":"1.1.0","date":"2015-07-07T23:31:24.275Z"},{"number":"1.1.1","date":"2016-11-21T22:50:22.589Z"},{"number":"1.1.3","date":"2017-05-05T17:25:41.243Z"},{"number":"1.1.4","date":"2017-05-05T17:33:45.355Z"}],"readme":"<!-- BANNER_TPL_BEGIN -->\n\nAbout Daplie: We're taking back the Internet!\n--------------\n\nDown with Google, Apple, and Facebook!\n\nWe're re-decentralizing the web and making it read-write again - one home cloud system at a time.\n\nTired of serving the Empire? Come join the Rebel Alliance:\n\n<a href=\"mailto:jobs@daplie.com\">jobs@daplie.com</a> | [Invest in Daplie on Wefunder](https://daplie.com/invest/) | [Pre-order Cloud](https://daplie.com/preorder/), The World's First Home Server for Everyone\n\n<!-- BANNER_TPL_END -->\n\n# redirect-https\n\nRedirect from HTTP to HTTPS using meta redirects\n\nSee <https://coolaj86.com/articles/secure-your-redirects/>\n\n## Installation and Usage\n\n```bash\nnpm install --save redirect-https\n```\n\n```js\n'use strict';\n\nvar express = require('express');\nvar app = express();\n\napp.use('/', require('redirect-https')({\n  body: '<!-- Hello Mr Developer! Please use HTTPS instead -->'\n}));\n\nmodule.exports = app;\n```\n\n## Options\n\n```\n{ port: 443           // defaults to 443\n, body: ''            // defaults to an html comment to use https\n, trustProxy: true    // useful if you haven't set this option in express\n}\n```\n\n* This module will call `next()` if the connection is already tls / https.\n* If `trustProxy` is true, and `X-Forward-Proto` is https, `next()` will be called.\n* If you use `{{URL}}` in the body text it will be replaced with a URI encoded and HTML escaped url (it'll look just like it is)\n* If you use `{{HTML_URL}}` in the body text it will be replaced with a URI decoded and HTML escaped url (it'll look just like it would in Chrome's URL bar)\n\n## Demo\n\n```javascript\n'use strict';\n\nvar http = require('http');\nvar server = http.createServer();\nvar securePort = process.argv[2] || 8443;\nvar insecurePort = process.argv[3] || 8080;\n\nserver.on('request', require('redirect-https')({\n  port: securePort\n, body: '<!-- Hello! Please use HTTPS instead -->'\n, trustProxy: true // default is false\n}));\n\nserver.listen(insecurePort, function () {\n  console.log('Listening on http://localhost.daplie.com:' + server.address().port);\n});\n```\n\n# Why meta redirects?\n\nWhen something is broken (i.e. insecure), you don't want it to kinda work, you want developers to notice.\n\nUsing a meta redirect will break requests from `curl` and api calls from a programming language, but still have all the SEO and speed benefits of a normal `301`.\n\n```html\n<html><head>\n<meta http-equiv=\"refresh\" content=\"0;URL='https://example.com/foo'\" />\n</head><body>\n<!-- Hello Mr. Developer! Please use https instead. Thank you! -->\n</html>\n```\n\n# Other strategies\n\nIf your application is properly separated between static assets and api, then it would probably be more beneficial to return a 200 OK with an error message inside\n\n# Security\n\nThe incoming URL is already URI encoded by the browser but, just in case, I run an html escape on it\nso that no malicious links of this sort will yield unexpected behavior:\n\n  * `http://localhost.daplie.com:8080/\"><script>alert('hi')</script>`\n  * `http://localhost.daplie.com:8080/';URL=http://example.com`\n  * `http://localhost.daplie.com:8080/;URL=http://example.com`\n","created":"2015-07-07T23:20:06.572Z","modified":"2017-05-05T17:33:45.355Z","lastPublisher":{"name":"drewwarrentiy","email":"drewwarrentiy@gmail.com"},"owners":[{"email":"coolaj86@gmail.com","name":"coolaj86"},{"email":"insightful_schmidt@yahoo.com.au","name":"insightfuls"},{"email":"jim.hager@daplie.com","name":"jimh"},{"email":"tim@creationix.com","name":"creationix"},{"email":"slgibelyou@gmail.com","name":"tigerbot"},{"email":"drewwarrentiy@gmail.com","name":"drewwarrentiy"},{"email":"npm@daplie.com","name":"daplieinc"}],"other":{"_attachments":{},"_from":".","_id":"redirect-https","_nodeVersion":"7.4.0","_npmOperationalInternal":{"host":"packages-12-west.internal.npmjs.com","tmp":"tmp/redirect-https-1.1.4.tgz_1494005625003_0.9467968298122287"},"_npmUser":{"name":"drewwarrentiy","email":"drewwarrentiy@gmail.com"},"_npmVersion":"4.0.5","_rev":"9-d3f3dcf8070fd5fd073b72e35126ef2d","_shasum":"aaa1fc72ac51623a5c49e80425051fea43bcee32","author":{"name":"AJ ONeal","email":"coolaj86@gmail.com","url":"http://coolaj86.com/"},"bugs":{"url":"https://git.daplie.com/Daplie/node-redirect-https/issues"},"directories":{},"dist-tags":{"latest":"1.1.4"},"dist":{"shasum":"aaa1fc72ac51623a5c49e80425051fea43bcee32","tarball":"https://registry.npmjs.org/redirect-https/-/redirect-https-1.1.4.tgz"},"maintainers":[{"email":"coolaj86@gmail.com","name":"coolaj86"},{"email":"insightful_schmidt@yahoo.com.au","name":"insightfuls"},{"email":"jim.hager@daplie.com","name":"jimh"},{"email":"tim@creationix.com","name":"creationix"},{"email":"slgibelyou@gmail.com","name":"tigerbot"},{"email":"drewwarrentiy@gmail.com","name":"drewwarrentiy"},{"email":"npm@daplie.com","name":"daplieinc"}],"readmeFilename":"README.md","time":{"modified":"2017-05-05T17:33:45.355Z","created":"2015-07-07T23:20:06.572Z","1.0.0":"2015-07-07T23:20:06.572Z","1.1.0":"2015-07-07T23:31:24.275Z","1.1.1":"2016-11-21T22:50:22.589Z","1.1.3":"2017-05-05T17:25:41.243Z","1.1.4":"2017-05-05T17:33:45.355Z"}}}