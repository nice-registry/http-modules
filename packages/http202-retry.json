{"name":"http202-retry","version":"1.0.0","description":"A module to automatically retry http requests if a HTTP 202 response is returned","main":"index.js","scripts":{"test":"tape test.js"},"keywords":["request","arcgis-open-data"],"license":"ISC","dependencies":{"backoff":"^2.5.0","nets":"^3.2.0","xtend":"^4.0.1"},"devDependencies":{"request":"^2.81.0","tape":"^4.6.3"},"gitHead":"68cb454bdd47a9d307c665424b71a32bb7ee8450","versions":[{"number":"1.0.0","date":"2017-04-24T18:10:17.599Z"}],"readme":"# http202-retry\r\n\r\nA module to automatically retry HTTP requests if a [HTTP 202 response][2] is returned.\r\n\r\nI built this module specifically for interacting with GeoJSON APIs on [ArcGIS Open Data websites][1], but it may be useful for other purposes.\r\n\r\nThe GeoJSON API on [ArcGIS Open Data websites][1] returns a [202 Accepted response code][2] when a filter is applied to a dataset. This means the server is still processing the request. This module catches that response code and automatically schedules another request after a short duration. By default the process repeats for 30s or until data is returned.\r\n\r\n# Usage\r\n``` javascript\r\nvar reqRetry = require('http202-retry')\r\n\r\nreqRetry('http://data.sjcgis.org/datasets/167317f36825482abeae53637ad7a7f4_3.geojson?where=Island%20like%20\\'%25Decatur%25\\'', {\r\n  reqOpts: {\r\n    json: true\r\n  }\r\n}, function (err, res, body) {\r\n  if (err) throw err\r\n  if (res.statusCode === 200) {\r\n    console.log('GeoJSON data: ', body)\r\n  } else {\r\n    console.log('Response returned: ', res.statusCode)\r\n  }\r\n})\r\n\r\n\r\n```\r\n\r\n# API\r\n\r\n``` javascript\r\nvar reqRetry = require('http202-retry')\r\n```\r\n\r\n### `reqRetry([url], [opts], cb)`\r\n___\r\nBy default, creates a new [request][3] ([xhr][4] in browsers). Automatically retries the request several times (up to 30s by default) if `response.statusCode === 202`.\r\n\r\n* `[opts.request]` {Function} if specified, a [substitute XMLHttpRequest GET function](https://github.com/zeke/npm-collection-http-clients). See [this example](./example/request.js). If not specified, [nets](http://npmjs.com/nets) is used.\r\n\r\n* `[opts.reqOpts]` {Object} options passed to [requestOptions][6] parameter ([xhrOptions][7] in the browser). Include `json:true` if requesting JSON or GeoJSON data.\r\n\r\n* `[opts.timeout]` {Number} Time, in milliseconds, to wait until timeout (default `30000`)\r\n\r\n* `cb` {Function} is called with the arguments ([`Error`][5], `response`, `body`)\r\n\r\n[`Error`][5] is only returned if something is preventing the request or after time out. HTTP 400 or 500 responses will not return an error. You should catch these yourself.\r\n\r\n# Installation\r\n\r\n```\r\nnpm install http202-retry\r\n```\r\n\r\n# License\r\n\r\n\r\nISC License (ISC)\r\n\r\nCopyright 2017 Nick Peihl\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any purpose with or without fee is hereby granted, provided that the above copyright notice and this permission notice appear in all copies.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\r\n\r\n\r\n[1]: http://opendata.arcgis.com\r\n[2]: https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.2.3\r\n[3]: https://www.npmjs.org/package/request\r\n[4]: https://www.npmjs.org/package/xhr\r\n[5]: http://es5.github.com/#x15.11\r\n[6]: https://www.npmjs.com/package/request#requestoptions-callback\r\n[7]: https://www.npmjs.com/package/xhr#var-req--xhroptions-callback\r\n","created":"2017-04-24T18:10:17.599Z","modified":"2017-04-24T18:10:17.599Z","lastPublisher":{"name":"nickpeihl","email":"nickpeihl@gmail.com"},"owners":[{"name":"nickpeihl","email":"nickpeihl@gmail.com"}],"other":{"_attachments":{},"_from":".","_id":"http202-retry","_nodeVersion":"6.3.0","_npmOperationalInternal":{"host":"packages-18-east.internal.npmjs.com","tmp":"tmp/http202-retry-1.0.0.tgz_1493057415783_0.7064855163916945"},"_npmUser":{"name":"nickpeihl","email":"nickpeihl@gmail.com"},"_npmVersion":"4.5.0","_rev":"1-b162d542caf26d93348263ede46046ce","_shasum":"7f531ec850629078ddff586ce751c56ef288f734","author":{"name":"Nick Peihl","email":"nickpeihl@gmail.com","url":"http://npeihl.com/"},"directories":{},"dist-tags":{"latest":"1.0.0"},"dist":{"shasum":"7f531ec850629078ddff586ce751c56ef288f734","tarball":"https://registry.npmjs.org/http202-retry/-/http202-retry-1.0.0.tgz"},"maintainers":[{"name":"nickpeihl","email":"nickpeihl@gmail.com"}],"readmeFilename":"README.md","time":{"modified":"2017-04-24T18:10:17.599Z","created":"2017-04-24T18:10:17.599Z","1.0.0":"2017-04-24T18:10:17.599Z"}}}