{"name":"kinto-client","version":"0.9.2","description":"JavaScript HTTP client for the Kinto API.","main":"lib/index.js","scripts":{"build":"babel -d lib/ src/","dist":"mkdir -p dist && rm -f dist/*.* && npm run dist-dev && npm run dist-prod && npm run dist-noshim && npm run dist-fx","dist-dev":"browserify -s KintoClient -d -e src/index.js -o dist/kinto-client.js -t [ babelify --sourceMapRelative . ]","dist-noshim":"browserify -s KintoClient -g uglifyify --ignore isomorphic-fetch --ignore babel-polyfill -e src/index.js -o dist/kinto-client.noshim.js -t [ babelify --sourceMapRelative . ]","dist-prod":"browserify -s KintoClient -g uglifyify -e src/index.js -o dist/kinto-client.min.js -t [ babelify --sourceMapRelative . ]","dist-fx":"BABEL_ENV=firefox browserify -s KintoHttpClient --ignore isomorphic-fetch --ignore events --bare -e fx-src/index.js -o temp.jsm -t [ babelify --sourceMapRelative . ] && mkdir -p dist && cp fx-src/jsm_prefix.js dist/moz-kinto-http-client.js && echo \"\n/*\n * Version $npm_package_version - $(git rev-parse --short HEAD)\n */\n\" >> dist/moz-kinto-http-client.js && cat temp.jsm >> dist/moz-kinto-http-client.js && rm temp.jsm","prepublish":"toctoc -w -d 2 README.md","publish-to-npm":"npm run build && npm run dist && npm publish","report-coverage":"npm run test-cover && ./node_modules/coveralls/bin/coveralls.js < ./coverage/lcov.info","tdd":"babel-node node_modules/.bin/_mocha --watch 'test/**/*_test.js'","test":"npm run test-nocover","test-cover":"babel-node node_modules/.bin/babel-istanbul cover --report text $npm_package_config_ISTANBUL_OPTS node_modules/.bin/_mocha -- 'test/**/*_test.js'","test-cover-html":"babel-node node_modules/.bin/babel-istanbul cover --report html $npm_package_config_ISTANBUL_OPTS node_modules/.bin/_mocha -- 'test/**/*_test.js' && open coverage/index.html","test-nocover":"babel-node node_modules/.bin/_mocha 'test/**/*_test.js'","lint":"eslint src test"},"repository":"https://github.com/Kinto/kinto-client","keywords":["kinto","http","client","api"],"license":"Apache-2.0","homepage":"https://github.com/Kinto/kinto-client#readme","dependencies":{"isomorphic-fetch":"^2.2.1"},"devDependencies":{"babel-cli":"^6.6.5","babel-core":"^6.6.5","babel-eslint":"^5.0.0-beta6","babel-istanbul":"^0.6.1","babel-loader":"^6.2.4","babel-plugin-transform-decorators-legacy":"^1.3.4","babel-plugin-transform-es2015-modules-commonjs":"^6.6.5","babel-plugin-transform-object-rest-spread":"^6.5.5","babel-polyfill":"^6.6.1","babel-preset-es2015":"^6.6.0","babelify":"^7.2.0","browserify":"^13.0.0","btoa":"^1.1.2","chai":"^3.4.1","chai-as-promised":"^5.0.0","coveralls":"^2.11.8","esdoc":"^0.4.6","esdoc-es7-plugin":"0.0.3","esdoc-importpath-plugin":"0.0.1","eslint":"2.2.0","kinto-node-test-server":"0.0.1","mocha":"^2.3.4","sinon":"^1.17.2","toctoc":"^0.2.2","uglifyify":"^3.0.1","uuid":"^2.0.1"},"engines":{"node":">=6"},"gitHead":"d851472d88362b7f4f310e1fc1b492dfe522a6b4","deprecated":"WARNING: This module has been renamed to kinto-http. Please install it instead. See https://github.com/Kinto/kinto-http.js/pull/102 for more information.","versions":[{"number":"0.1.0","date":"2016-02-08T14:55:05.591Z"},{"number":"0.1.1","date":"2016-02-08T15:02:27.124Z"},{"number":"0.2.0","date":"2016-02-18T14:24:42.337Z"},{"number":"0.2.1","date":"2016-02-18T15:36:35.091Z"},{"number":"0.2.2","date":"2016-02-18T16:10:32.217Z"},{"number":"0.2.3","date":"2016-02-20T17:33:03.237Z"},{"number":"0.3.0","date":"2016-03-02T17:15:37.192Z"},{"number":"0.4.0","date":"2016-03-03T17:28:49.915Z"},{"number":"0.4.1","date":"2016-03-04T12:22:38.660Z"},{"number":"0.4.2","date":"2016-03-07T13:15:57.541Z"},{"number":"0.5.0","date":"2016-03-16T17:07:45.238Z"},{"number":"0.6.0","date":"2016-04-08T14:39:40.734Z"},{"number":"0.7.0","date":"2016-05-25T18:11:10.317Z"},{"number":"0.8.0","date":"2016-05-28T14:00:13.800Z"},{"number":"0.8.1","date":"2016-05-30T07:26:20.106Z"},{"number":"0.8.2","date":"2016-05-30T07:41:04.286Z"},{"number":"0.8.3","date":"2016-05-31T07:52:21.256Z"},{"number":"0.9.0","date":"2016-06-02T09:09:52.801Z"},{"number":"0.9.1","date":"2016-06-02T13:47:04.006Z"},{"number":"0.9.2","date":"2016-06-02T14:46:21.713Z"}],"readme":"kinto-client\n============\n\n[![Build Status](https://travis-ci.org/Kinto/kinto-client.svg?branch=master)](https://travis-ci.org/Kinto/kinto-client)\n\nA JavaScript HTTP Client for the [Kinto](http://kinto-storage.org/) API.\n\nRead the [API documentation](https://doc.esdoc.org/github.com/Kinto/kinto-client/).\n\n## Table of Contents\n\n  - [Installation](#installation)\n  - [Usage](#usage)\n  - [Authentication](#authentication)\n     - [Using Basic Auth](#using-basic-auth)\n     - [Using an OAuth Bearer Token](#using-an-oauth-bearer-token)\n  - [Server information](#server-information)\n  - [Buckets](#buckets)\n     - [Listing buckets](#listing-buckets)\n     - [Creating a new bucket](#creating-a-new-bucket)\n     - [Selecting a bucket](#selecting-a-bucket)\n     - [Getting bucket data](#getting-bucket-data)\n     - [Setting bucket data](#setting-bucket-data)\n     - [Getting bucket permissions](#getting-bucket-permissions)\n     - [Setting bucket permissions](#setting-bucket-permissions)\n     - [Deleting a bucket](#deleting-a-bucket)\n     - [Creating a collection](#creating-a-collection)\n     - [Listing bucket collections](#listing-bucket-collections)\n     - [Deleting a collection](#deleting-a-collection)\n     - [Creating a user group](#creating-a-user-group)\n     - [Listing bucket groups](#listing-bucket-groups)\n     - [Getting a bucket group](#getting-a-bucket-group)\n     - [Updating an existing group](#updating-an-existing-group)\n     - [Deleting a group](#deleting-a-group)\n  - [Collections](#collections)\n     - [Selecting a collection](#selecting-a-collection)\n     - [Getting collection data](#getting-collection-data)\n     - [Setting collection data](#setting-collection-data)\n     - [Getting collection permissions](#getting-collection-permissions)\n     - [Setting collection permissions](#setting-collection-permissions)\n     - [Creating a new record](#creating-a-new-record)\n     - [Retrieving an existing record](#retrieving-an-existing-record)\n     - [Updating an existing record](#updating-an-existing-record)\n     - [Deleting record](#deleting-record)\n     - [Listing records](#listing-records)\n     - [Batching operations](#batching-operations)\n  - [Options](#options)\n  - [The safe option explained](#the-safe-option-explained)\n     - [Safe creations](#safe-creations)\n     - [Safe updates](#safe-updates)\n     - [Safe deletions](#safe-deletions)\n  - [Events](#events)\n     - [The backoff event](#the-backoff-event)\n     - [The deprecated event](#the-deprecated-event)\n     - [The retry-after event](#the-retry-after-event)\n\n---\n\n## Installation\n\nIn the browser, you can load prebuilt scripts hosted on npmcdn:\n\n- [kinto-client.js](https://npmcdn.com/kinto-client/dist/kinto-client.js)\n- [kinto-client.min.js](https://npmcdn.com/kinto-client/dist/kinto-client.min.js)\n- [kinto-client.noshim.js](https://npmcdn.com/kinto-client/dist/kinto-client.noshim.js)\n\n```html\n<script src=\"https://npmcdn.com/kinto-client/dist/kinto-client.min.js\"></script>\n```\n\nIn nodejs:\n\n```\n$ npm install kinto-client --save\n```\n\nThen (ES6):\n\n```js\nimport KintoClient from \"kinto-client\";\n```\n\nOr (ES5):\n\n```js\nvar KintoClient = require(\"kinto-client\").default;\n```\n\nNote that this HTTP client can be transparently used server side or in a regular browser page.\n\n## Usage\n\nA client instance is created using the `KintoClient` constructor, passing it the remote Kinto server root URL, including the version:\n\n```js\nconst client = new KintoClient(\"https://kinto.dev.mozaws.net/v1\");\n```\n\n#### Options\n\n- `safe`: Adds concurrency headers to every requests. (default: `true`)\n- `events`: The events handler. If none provided an `EventEmitter` instance will be created.\n- `headers`: The key-value headers to pass to each request. (default: `{}`)\n- `bucket`: The default bucket to use. (default: `\"default\"`)\n- `requestMode`: The HTTP [CORS](https://fetch.spec.whatwg.org/#concept-request-mode) mode. (default: `\"cors\"`)\n- `timeout`: The requests timeout in milliseconds. (default: `5000`)\n\n\n## Authentication\n\nAuthenticating against a Kinto server can be achieved by adding an `Authorization` header to the request.\n\nBy default Kinto server supports Basic Auth authentication, but others mechanisms can be activated such as OAuth (eg. [Firefox Account](https://accounts.firefox.com/))\n\n### Using Basic Auth\n\nSimply provide an `Authorization` header option to the `Kinto` constructor:\n\n```js\nconst secretString = `${username}:${password}`;\nconst kinto = new KintoClient(\"https://my.server.tld/v1\", {\n  headers: {\n    Authorization: \"Basic \" + btoa(secretString)\n  }\n});\n```\n\n> #### Notes\n>\n> - As explained in the [server docs](http://kinto.readthedocs.io/en/stable/api/1.x/authentication.html#basic-auth), any string is accepted. You're not obliged to use the `username:password` format.\n\n### Using an OAuth Bearer Token\n\nAs for Basic Auth, once you have retrieved a valid OAuth Bearer Token, simply pass it in an `Authorization` header:\n\n```js\nconst kinto = new KintoClient(\"https://my.server.tld/v1\", {\n  headers: {\n    Authorization: `Bearer ` + oauthBearerToken)\n  }\n});\n```\n\n## Server information\n\nA Kinto server exposes some of its internal settings, information about authenticated user, the HTTP API version and the API capabilities (e.g. plugins).\n\n```js\nclient.fetchServerInfo([options])\n  .then(({data}) => ...);\n```\n\nSample result:\n\n```js\n{\n    \"project_name\": \"kinto\",\n    \"project_version\": \"3.0.2\",\n    \"url\": \"http://0.0.0.0:8889/v1/\",\n    \"project_docs\": \"https://kinto.readthedocs.io/\",\n    \"http_api_version\": \"1.6\",\n    \"settings\": {\n        \"batch_max_requests\": 25,\n        \"readonly\": false\n    },\n    \"user\": {\n        \"bucket\": \"2f9b1aaa-552d-48e8-1b78-371dd08688b3\",\n        \"id\": \"basicauth:f505765817a6b4ea46278be0620ddedd83b10f71f7695683719fe001cf0871d7\"\n    },\n    \"capabilities\": {\n        \"default_bucket\": {\n            \"description\": \"The default bucket is an alias for a personal bucket where collections are created implicitly.\",\n            \"url\": \"http://kinto.readthedocs.io/en/latest/api/1.x/buckets.html#personal-bucket-default\"\n        }\n    }\n}\n```\n\n#### Options\n\n- `headers`: Custom headers object to send along the HTTP request\n\n\n#### Helpers\n\n- `fetchServerSettings([options])`: server settings\n- `fetchServerCapabilities([options])`: API capabilities\n- `fetchUser()`: authenticated user information\n- `fetchHTTPApiVersion([options])`: HTTP API version\n\n\n## Buckets\n\n### Listing buckets\n\n```js\nclient.listBuckets([options])\n  .then(({data}) => ...);\n```\n\nSample result:\n\n```js\n{\n  data: [\n    {\n      id: \"comments\",\n      last_modified: 1456182233221,\n    },\n    {\n      id: \"blog\",\n      last_modified: 1456181213214,\n    },\n  ]\n}\n```\n\n#### Options\n\n- `headers`: Custom headers object to send along the HTTP request\n\n### Creating a new bucket\n\n```js\nclient.createBucket(\"blog\"[, options])\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"data\": {\n    \"last_modified\": 1456182233221,\n    \"id\": \"foo\"\n  },\n  \"permissions\": {\n    \"write\": [\n      \"basicauth:0f7c1b72cdc89b9d42a2d48d5f0b291a1e8afd408cc38a2197cdf508269cecc8\"\n    ]\n  }\n}\n```\n\n#### Options\n\n- `data`: Arbitrary data to attach to the bucket\n- `headers`: Custom headers object to send along the HTTP request\n- `safe`: Whether to override existing resource if it already exists (default: `false`)\n\n### Selecting a bucket\n\n```js\nclient.bucket(\"blog\");\n```\n\n### Getting bucket data\n\n```js\nclient.bucket(\"blog\").getData()\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"last_modified\": 1456182336242,\n  \"id\": \"blog\",\n  \"foo\": \"bar\"\n}\n```\n\n#### Options\n\n- `headers`: Custom headers object to send along the HTTP request\n\n\n### Setting bucket data\n\n```js\nclient.bucket(\"blog\").setData({foo: \"bar\"})\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"data\": {\n    \"last_modified\": 1456182336242,\n    \"id\": \"blog\",\n    \"foo\": \"bar\"\n  },\n  \"permissions\": {\n    \"write\": [\n      \"basicauth:0f7c1b72cdc89b9d42a2d48d5f0b291a1e8afd408cc38a2197cdf508269cecc8\"\n    ]\n  }\n}\n```\n\n#### Options\n\n- `patch`: Patches existing bucket data instead of replacing them (default: `false`)\n- `headers`: Custom headers object to send along the HTTP request\n- `safe`: Whether to override existing resource if it already exists (default: `false`)\n\n### Getting bucket permissions\n\n```js\nclient.bucket(\"blog\").getPermissions()\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"write\": [\n    \"basicauth:0f7c1b72cdc89b9d42a2d48d5f0b291a1e8afd408cc38a2197cdf508269cecc8\"\n  ]\n}\n```\n\n#### Options\n\n- `headers`: Custom headers object to send along the HTTP request\n\n### Setting bucket permissions\n\n```js\nconst permissions = {\n  read:  [\"github:bob\"],\n  write: [\"github:bob\", \"github:john\"]\n};\n\nclient.bucket(\"blog\").setPermissions(permissions[, options])\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"data\": {\n    \"last_modified\": 1456182888466,\n    \"id\": \"blog\"\n  },\n  \"permissions\": {\n    \"read\": [\"github:bob\"],\n    \"write\": [\n      \"github:bob\",\n      \"basicauth:0f7c1b72cdc89b9d42a2d48d5f0b291a1e8afd408cc38a2197cdf508269cecc8\",\n      \"github:john\"\n    ]\n  }\n}\n```\n\n#### Options\n\n- `headers`: Custom headers object to send along the HTTP request;\n- `safe`: If `last_modified` is provided, ensures the resource hasn't been modified since that timestamp. Otherwise ensures no existing resource with the provided id will be overriden (default: `false`);\n- `last_modified`: The last timestamp we know the resource has been updated on the server.\n\n#### Notes\n\n- This operation replaces any previously set permissions;\n- Owners will always keep their `write` permission bit, as per the Kinto protocol.\n\n### Deleting a bucket\n\n```js\nclient.deleteBucket(\"testbucket\"[, options])\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"data\": {\n    \"deleted\": true,\n    \"last_modified\": 1456182931974,\n    \"id\": \"blog\"\n  }\n}\n```\n\n#### Options\n\n- `headers`: Custom headers object to send along the HTTP request;\n- `safe`: Ensures the resource hasn't been modified in the meanwhile if `last_modified` is provided (default: `false`);\n- `last_modified`: The last timestamp we know the resource has been updated on the server.\n\n### Creating a collection\n\n#### Named collection\n\n```js\nclient.bucket(\"blog\").createCollection(\"posts\")\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n\n{\n  \"data\": {\n    \"last_modified\": 1456183004372,\n    \"id\": \"posts\"\n  },\n  \"permissions\": {\n    \"write\": [\n      \"basicauth:0f7c1b72cdc89b9d42a2d48d5f0b291a1e8afd408cc38a2197cdf508269cecc8\"\n    ]\n  }\n}\n```\n\n#### With an ID generated automatically\n\n```js\nclient.bucket(\"blog\").createCollection()\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"data\": {\n    \"last_modified\": 1456183040592,\n    \"id\": \"OUh5VEDa\"\n  },\n  \"permissions\": {\n    \"write\": [\n      \"basicauth:0f7c1b72cdc89b9d42a2d48d5f0b291a1e8afd408cc38a2197cdf508269cecc8\"\n    ]\n  }\n}\n```\n\nNote that `OUh5VEDa` is the collection ID automatically generated by the server.\n\n#### Options\n\n- `headers`: Custom headers object to send along the HTTP request\n- `safe`: Whether to override existing resource if it already exists (default: `false`)\n\n> Note: For generated names, options can be specified only if the first parameters are provided: `createCollection(undefined, {safe: true})`\n\n### Listing bucket collections\n\n```js\nclient.bucket(\"blog\").listCollections()\n  .then(({data}) => ...);\n```\n\nSample result:\n\n```js\n{\n  data: [\n    {\n      \"last_modified\": 1456183153840,\n      \"id\": \"posts\"\n    },\n    {\n      \"last_modified\": 1456183159386,\n      \"id\": \"comments\"\n    }\n  ]\n}\n```\n\n#### Options\n\n- `headers`: Custom headers object to send along the HTTP request\n\n### Deleting a collection\n\n```js\nclient.bucket(\"blog\").deleteCollection(\"test\")\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"data\": {\n    \"deleted\": true,\n    \"last_modified\": 1456183116571,\n    \"id\": \"posts\"\n  }\n}\n```\n\n#### Options\n\n- `headers`: Custom headers object to send along the HTTP request;\n- `safe`: Ensures the resource hasn't been modified in the meanwhile if `last_modified` is provided (default: `false`);\n- `last_modified`: The last timestamp we know the resource has been updated on the server.\n\n### Creating a user group\n\nKinto has a concept of groups of users. A group has a list of members and belongs to a bucket.\n\nPermissions can refer to the group instead of an individuals - this makes it easy to define «roles», especially if the same set of permissions is applied to several objects.\n\nWhen used in permissions definitions, the full group URI has to be used:\n\n```js\n    {\n      data: {\n        title: \"My article\"\n      },\n      permissions: {\n        write: [\"/buckets/blog/groups/authors\", \"github:lili\"],\n        read: [\"system.Everyone\"]\n      }\n    }\n```\n\n#### Named group\n\n```js\nclient.bucket(\"blog\").createGroup(\"admins\")\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"data\": {\n    \"last_modified\": 1456183004372,\n    \"id\": \"admins\",\n    \"members\": []\n  },\n  \"permissions\": {\n    \"write\": [\n      \"basicauth:0f7c1b72cdc89b9d42a2d48d5f0b291a1e8afd408cc38a2197cdf508269cecc8\"\n    ]\n  }\n}\n```\n\n#### With a list of members and attributes\n\n```js\nclient.bucket(\"blog\").createGroup(\"admins\", [\"system.Authenticated\"], {data: {pi: 3.14}})\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"data\": {\n    \"last_modified\": 1456183004372,\n    \"id\": \"admins\",\n    \"members\": [\"system.Authenticated\"],\n    \"pi\": 3.14\n  },\n  \"permissions\": {\n    \"write\": [\n      \"basicauth:0f7c1b72cdc89b9d42a2d48d5f0b291a1e8afd408cc38a2197cdf508269cecc8\"\n    ]\n  }\n}\n```\n\n#### With an ID generated automatically\n\n```js\nclient.bucket(\"blog\").createGroup()\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"data\": {\n    \"last_modified\": 1456183040592,\n    \"members\": [],\n    \"id\": \"7YHFF565\"\n  },\n  \"permissions\": {\n    \"write\": [\n      \"basicauth:0f7c1b72cdc89b9d42a2d48d5f0b291a1e8afd408cc38a2197cdf508269cecc8\"\n    ]\n  }\n}\n```\n\nNote that `7YHFF565` is the group ID automatically generated by the server.\n\n#### Options\n\n- `headers`: Custom headers object to send along the HTTP request\n- `safe`: Whether to override existing resource if it already exists (default: `false`)\n- `data`: Extra group attributes.\n- `permissions`: Permissions to be set on the created group.\n\n> Note: For generated names, options can be specified only if the first parameters are provided: `createGroup(undefined, [], {safe: true})`\n\n\n### Listing bucket groups\n\n```js\nclient.bucket(\"blog\").listGroups()\n  .then(({data}) => ...);\n```\n\nSample result:\n\n```js\n{\n  \"data\": [\n    {\n      \"last_modified\": 1456183153840,\n      \"id\": \"admins\",\n      \"members\": [\"system.Authenticated\"],\n      \"pi\": 3.14\n    },\n    {\n      \"last_modified\": 1456183159386,\n      \"id\": \"moderators\",\n      \"members\": [\"github:lili\"]\n    }\n  ]\n}\n```\n\n#### Options\n\n- `headers`: Custom headers object to send along the HTTP request\n\n### Getting a bucket group\n\n```js\nclient.bucket(\"blog\").getGroup(\"admins\")\n  .then(({data}) => ...);\n```\n\nSample result:\n\n```js\n{\n  \"data\": {\n      \"last_modified\": 1456183153840,\n      \"id\": \"admins\",\n      \"members\": [\"system.Authenticated\"],\n      \"pi\": 3.14\n  }\n}\n```\n\n#### Options\n\n- `headers`: Custom headers object to send along the HTTP request\n\n### Updating an existing group\n\n```js\nconst updated = {\n  id: \"cb0f7b2b-e78f-41a8-afad-92a56f8c88db\",\n  members: [\"system.Everyone\", \"github:lili\"],\n  pi: 3.141592\n};\n\nclient.bucket(\"blog\").updateGroup(updated, {permissions: {write: [\"fxa:35478\"]}})\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"data\": {\n    \"last_modified\": 1456183778891,\n    \"id\": \"cb0f7b2b-e78f-41a8-afad-92a56f8c88db\",\n    \"members\": [\"system.Everyone\", \"github:lili\"],\n    \"pi\": 3.141592\n  },\n  \"permissions\": {\n    \"write\": [\n      \"basicauth:0f7c1b72cdc89b9d42a2d48d5f0b291a1e8afd408cc38a2197cdf508269cecc8\",\n      \"fxa:35478\"\n    ]\n  }\n}\n```\n\n#### Options\n\n- `patch`: Patches the existing record instead of replacing it (default: `false`)\n- `headers`: Custom headers object to send along the HTTP request;\n- `safe`: If `last_modified` is provided, ensures the resource hasn't been modified since that timestamp. Otherwise ensures no existing resource with the provided id will be overriden (default: `false`);\n- `permissions`: Permissions to be set on the group.\n\n### Deleting a group\n\n```js\nclient.bucket(\"blog\").deleteGroup(\"admins\")\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"data\": {\n    \"deleted\": true,\n    \"last_modified\": 1456183116571,\n    \"id\": \"admins\"\n  }\n}\n```\n\n#### Options\n\n- `headers`: Custom headers object to send along the HTTP request;\n- `safe`: Ensures the resource hasn't been modified in the meanwhile if `last_modified` is provided (default: `false`);\n- `last_modified`: The last timestamp we know the resource has been updated on the server.\n\n\n## Collections\n\n### Selecting a collection\n\n```js\nclient.bucket(\"blog\").collection(\"posts\")\n  .then(result => ...);\n```\n\n### Getting collection data\n\n```js\nclient.bucket(\"blog\").collection(\"posts\").getData()\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"last_modified\": 1456183561206,\n  \"id\": \"posts\",\n  \"preferedAuthor\": \"@chucknorris\"\n}\n```\n\n#### Options\n\n- `headers`: Custom headers object to send along the HTTP request\n\n### Setting collection data\n\n```js\nclient.bucket(\"blog\").collection(\"posts\")\n  .setData({preferedAuthor: \"@chucknorris\"})\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"data\": {\n    \"last_modified\": 1456183561206,\n    \"id\": \"posts\",\n    \"preferedAuthor\": \"@chucknorris\"\n  },\n  \"permissions\": {\n    \"write\": [\n      \"github:bob\",\n      \"basicauth:0f7c1b72cdc89b9d42a2d48d5f0b291a1e8afd408cc38a2197cdf508269cecc8\",\n      \"github:john\"\n    ]\n  }\n}\n```\n\n#### Options\n\n- `patch`: Patches the existing data instead of replacing them (default: `false`)\n- `headers`: Custom headers object to send along the HTTP request;\n- `safe`: If `last_modified` is provided, ensures the resource hasn't been modified since that timestamp. Otherwise ensures no existing resource with the provided id will be overriden (default: `false`);\n- `last_modified`: The last timestamp we know the resource has been updated on the server.\n\n### Getting collection permissions\n\n```js\nclient.bucket(\"blog\").collection(\"posts\").getPermissions()\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"write\": [\n    \"basicauth:0f7c1b72cdc89b9d42a2d48d5f0b291a1e8afd408cc38a2197cdf508269cecc8\",\n  ]\n}\n```\n\n#### Options\n\n- `headers`: Custom headers object to send along the HTTP request\n\n### Setting collection permissions\n\n```js\nclient.bucket(\"blog\").collection(\"posts\")\n  .setPermissions({\n    read: [\"github:bob\"],\n    write: [\"github:john\", \"github:bob\"]\n  })\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"data\": {\n    \"last_modified\": 1456183508926,\n    \"id\": \"posts\"\n  },\n  \"permissions\": {\n    \"read\": [\"github:bob\"],\n    \"write\": [\n      \"github:bob\",\n      \"basicauth:0f7c1b72cdc89b9d42a2d48d5f0b291a1e8afd408cc38a2197cdf508269cecc8\",\n      \"github:john\"\n    ]\n  }\n}\n```\n\n#### Options\n\n- `headers`: Custom headers object to send along the HTTP request;\n- `safe`: If `last_modified` is provided, ensures the resource hasn't been modified since that timestamp. Otherwise ensures no existing resource with the provided id will be overriden (default: `false`);\n- `last_modified`: The last timestamp we know the resource has been updated on the server.\n\n#### Notes\n\n- This operation replaces any previously set permissions;\n- Owners will always keep their `write` permission bit, as per the Kinto protocol.\n\n\n### Creating a new record\n\n```js\nclient.bucket(\"blog\").collection(\"posts\")\n  .createRecord({title: \"My first post\", content: \"Hello World!\"})\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"data\": {\n    \"content\": \"Hello World!\",\n    \"last_modified\": 1456183657846,\n    \"id\": \"cb0f7b2b-e78f-41a8-afad-92a56f8c88db\",\n    \"title\": \"My first post\"\n  },\n  \"permissions\": {\n    \"write\": [\n      \"basicauth:0f7c1b72cdc89b9d42a2d48d5f0b291a1e8afd408cc38a2197cdf508269cecc8\"\n    ]\n  }\n}\n```\n\n#### Options\n\n- `headers`: Custom headers object to send along the HTTP request;\n- `safe`: Whether to override existing resource if it already exists and if an id is provided (default: `false`)\n\n### Retrieving an existing record\n\n```js\nclient.bucket(\"blog\").collection(\"posts\")\n  .getRecord(\"cb0f7b2b-e78f-41a8-afad-92a56f8c88db\")\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"data\": {\n    \"content\": \"Hello World!\",\n    \"last_modified\": 1456183657846,\n    \"id\": \"cb0f7b2b-e78f-41a8-afad-92a56f8c88db\",\n    \"title\": \"My first post\"\n  },\n  \"permissions\": {\n    \"write\": [\n      \"basicauth:0f7c1b72cdc89b9d42a2d48d5f0b291a1e8afd408cc38a2197cdf508269cecc8\"\n    ]\n  }\n}\n```\n\n#### Options\n\n- `headers`: Custom headers object to send along the HTTP request;\n- `safe`: Ensures an existing record with this ID won't be overridden (default: `false`).\n\n### Updating an existing record\n\n```js\nconst updated = {\n  id: \"cb0f7b2b-e78f-41a8-afad-92a56f8c88db\",\n  title: \"My first post, edited\",\n  content: \"Hello World, again!\"\n};\n\nclient.bucket(\"blog\").collection(\"posts\")\n  .updateRecord(updated)\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"data\": {\n    \"content\": \"Hello World, again!\",\n    \"last_modified\": 1456183778891,\n    \"id\": \"cb0f7b2b-e78f-41a8-afad-92a56f8c88db\",\n    \"title\": \"My first post, edited\"\n  },\n  \"permissions\": {\n    \"write\": [\n      \"basicauth:0f7c1b72cdc89b9d42a2d48d5f0b291a1e8afd408cc38a2197cdf508269cecc8\"\n    ]\n  }\n}\n```\n\n#### Options\n\n- `patch`: Patches the existing record instead of replacing it (default: `false`)\n- `headers`: Custom headers object to send along the HTTP request;\n- `safe`: If `last_modified` is provided, ensures the resource hasn't been modified since that timestamp. Otherwise ensures no existing resource with the provided id will be overriden (default: `false`);\n\n### Deleting record\n\n```js\nclient.bucket(\"blog\").collection(\"posts\")\n  .deleteRecord(\"cb0f7b2b-e78f-41a8-afad-92a56f8c88db\")\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  \"data\": {\n    \"deleted\": true,\n    \"last_modified\": 1456183877287,\n    \"id\": \"cb0f7b2b-e78f-41a8-afad-92a56f8c88db\"\n  }\n}\n```\n\n#### Options\n\n- `headers`: Custom headers object to send along the HTTP request;\n- `safe`: Ensures the resource hasn't been modified in the meanwhile if `last_modified` is provided (default: `false`);\n- `last_modified`: When `safe` is true, the last timestamp we know the resource has been updated on the server.\n\n### Listing records\n\n```js\nclient.bucket(\"blog\").collection(\"posts\")\n  .listRecords()\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n{\n  last_modified: \"\\\"1456183930780\\\"\",\n  next: <Function>,\n  data: [\n    {\n      \"content\": \"True.\",\n      \"last_modified\": 1456183930780,\n      \"id\": \"a89dd4b2-d597-4192-bc2b-834116244d29\",\n      \"title\": \"I love cheese\"\n    },\n    {\n      \"content\": \"Yo\",\n      \"last_modified\": 1456183914275,\n      \"id\": \"63c1805a-565a-46cc-bfb3-007dfad54065\",\n      \"title\": \"Another post\"\n    }\n  ]\n}\n```\n\nNote the root `last_modified` value which is the [collection's timestamp](http://kinto.readthedocs.io/en/stable/core/api/timestamps.html). This value is opaque and should be reused as is, eg. passing it as a `since` option (see the *Options* section below).\n\n#### Sorting\n\nBy default, records are listed by `last_modified` descending order. You can set the `sort` option to order by another field:\n\n```js\nclient.bucket(\"blog\").collection(\"posts\")\n  .listRecords({sort: \"title\"})\n  .then(({data, next}) => {\n```\n\n#### Polling for changes\n\nTo retrieve the list of records modified since a given timestamp, use the `since` option:\n\n```js\nclient.bucket(\"blog\").collection(\"posts\")\n  .listRecords({since: \"\\\"1456183930780\\\"\"})\n  .then(({data, next}) => {\n```\n\n#### Pagination\n\nBy default, all records returned by the server are retrieved. To specify a max number of records to retrieve, you can use the `limit` option:\n\n```js\nclient.bucket(\"blog\").collection(\"posts\")\n  .listRecords({limit: 20})\n  .then(({data, next}) => {\n```\n\nTo retrieve the next page of records, just call `next()` from the result object obtained. If no next page is available, `next()` throws an error you can catch to exit the flow:\n\n```js\nlet getNextPage;\n\nclient.bucket(\"blog\").collection(\"posts\")\n  .listRecords({limit: 20})\n  .then(({data, next}) => {\n    console.log(\"Page 1\", data);\n    getNextPage = next;\n  });\n```\n\nLater down the flow:\n\n```js\ngetNextPage()\n  .then(({data, next}) => {\n    console.log(\"Page 2\", data);\n  })\n  .catch(_ => {\n    console.log(\"No more pages.\");\n  });\n```\n\nLast, if you just want to retrieve and aggregate a given number of result pages, instead of dealing with calling `next()` recursively you can simply specify the `pages` option:\n\n```js\nclient.bucket(\"blog\").collection(\"posts\")\n  .listRecords({limit: 20, pages: 3})\n  .then(({data, next}) => ...); // A maximum of 60 records will be retrieved here\n```\n\n> ##### Notes\n>\n> If you plan on fetching all the available pages, you can set the `pages` option to `Infinity`. Be aware that for large datasets this strategy can possibly issue an important amount of HTTP requests.\n\n#### Options\n\n- `sort`: The order field (default: `-last_modified`);\n- `pages`: The number of result pages to retrieve (default: `1`);\n- `limit`: The number of records to retrieve per page: unset by default, uses default server configuration;\n- `filters`: An object defining the filters to apply; read more about [what's supported](http://kinto.readthedocs.io/en/stable/core/api/resource.html#filtering);\n- `since`: The ETag header value received from the last response from the server.\n- `headers`: Custom headers object to send along the HTTP request;\n\n### Batching operations\n\nThis allows performing multiple operations in a single HTTP request.\n\n```js\nclient.bucket(\"blog\").collection(\"posts\")\n  .batch(batch => {\n    batch.deleteRecord(\"cb0f7b2b-e78f-41a8-afad-92a56f8c88db\");\n    batch.createRecord({title: \"new post\", content: \"yo\"});\n    batch.createRecord({title: \"another\", content: \"yo again\"});\n  })\n  .then(result => ...);\n```\n\nSample result:\n\n```js\n[\n  {\n    \"status\": 200,\n    \"path\": \"/v1/buckets/blog/collections/posts/records/a89dd4b2-d597-4192-bc2b-834116244d29\",\n    \"body\": {\n      \"data\": {\n        \"deleted\": true,\n        \"last_modified\": 1456184078090,\n        \"id\": \"a89dd4b2-d597-4192-bc2b-834116244d29\"\n      }\n    },\n    \"headers\": {\n      \"Content-Length\": \"99\",\n      \"Content-Type\": \"application/json; charset=UTF-8\",\n      \"Access-Control-Expose-Headers\": \"Retry-After, Content-Length, Alert, Backoff\"\n    }\n  },\n  {\n    \"status\": 201,\n    \"path\": \"/v1/buckets/blog/collections/posts/records\",\n    \"body\": {\n      \"data\": {\n        \"content\": \"yo\",\n        \"last_modified\": 1456184078096,\n        \"id\": \"afd650b3-1625-42f6-8994-860e52d39201\",\n        \"title\": \"new post\"\n      },\n      \"permissions\": {\n        \"write\": [\n          \"basicauth:0f7c1b72cdc89b9d42a2d48d5f0b291a1e8afd408cc38a2197cdf508269cecc8\"\n        ]\n      }\n    },\n    \"headers\": {\n      \"Content-Length\": \"221\",\n      \"Content-Type\": \"application/json; charset=UTF-8\",\n      \"Access-Control-Expose-Headers\": \"Retry-After, Content-Length, Alert, Backoff\"\n    }\n  },\n  {\n    \"status\": 201,\n    \"path\": \"/v1/buckets/blog/collections/posts/records\",\n    \"body\": {\n      \"data\": {\n        \"content\": \"yo again\",\n        \"last_modified\": 1456184078102,\n        \"id\": \"22c1319e-7b09-46db-bec4-c240bdf4e3e9\",\n        \"title\": \"another\"\n      },\n      \"permissions\": {\n        \"write\": [\n          \"basicauth:0f7c1b72cdc89b9d42a2d48d5f0b291a1e8afd408cc38a2197cdf508269cecc8\"\n        ]\n      }\n    },\n    \"headers\": {\n      \"Content-Length\": \"226\",\n      \"Content-Type\": \"application/json; charset=UTF-8\",\n      \"Access-Control-Expose-Headers\": \"Retry-After, Content-Length, Alert, Backoff\"\n    }\n  }\n]\n```\n\n#### Options\n\n- `headers`: Custom headers object to send along the HTTP request;\n- `safe`: Ensures operations won't override existing resources on the server if their associated `last_modified` value or option are provided; otherwise ensures resources won't be overriden if they already exist on the server;\n- `aggregate`: Produces an aggregated result object, grouped by operation types; the result object has the following structure:\n\n```js\n{\n  \"errors\":    [], // Encountered errors (HTTP 400, >=500)\n  \"published\": [], // Successfully published resources (HTTP 200, 201)\n  \"conflicts\": [], // Conflicting resources (HTTP 412)\n  \"skipped\":   []  // Missing target resources on the server (HTTP 404)\n}\n```\n\n## Options\n\nBoth `bucket()` and `collection()` methods accept an `options` object as a second arguments where you can define the following options:\n\n- `{Object} headers`: Custom headers to send along the request;\n- `{Boolean} safe`: Ensure safe transactional operations; read more about that below.\n\nSample usage:\n\n```js\nclient.bucket(\"blog\", {\n  headers: {\"X-Hello\": \"Hello!\"},\n  safe: true\n});\n```\n\nHere the `X-Hello` header and the `safe` option will be used for building every outgoing request sent to the server, for every collection attached to this bucket.\n\nThis works at the collection level as well:\n\n```js\nclient.bucket(\"blog\")\n  .collection(\"posts\", {\n    headers: {\"X-Hello\": \"Hello!\"},\n    safe: true\n  });\n```\n\nEvery request sent for this collection will have the options applied.\n\nLast, you can of course pass these options at the atomic operation level:\n\n```js\nclient.bucket(\"blog\")\n  .collection(\"posts\")\n  .updateRecord(updatedRecord, {\n    headers: {\"X-Hello\": \"Hello!\"},\n    safe: true\n  });\n```\n\nThe cool thing being you can always override the default defined options at the atomic operation level:\n\n```js\nclient.bucket(\"blog\", {safe: true})\n  .collection(\"posts\")\n  .updateRecord(updatedRecord, {safe: false});\n```\n\n## The `safe` option explained\n\nThe `safe` option can be used:\n\n- when creating or updating a resource, to ensure that any already existing record matching the provided ID won't be overridden if it exists on the server;\n- when updating or deleting a resource, to ensure it won't be overridden remotely if it has changed in the meanwhile on the server (requires a `last_modified` value to be provided).\n\n### Safe creations\n\nWhen creating a new ressource, using the `safe` option will ensure the resource will be created only if it doesn't already exist on the server.\n\n### Safe updates\n\nIf a `last_modified` property value is set in the resource object being updated, the `safe` option will ensure it won't be overriden if it's been modified on the server since that `last_modified` timestamp, raising an `HTTP 412` response describing the conflict when that happens:\n\n```js\nconst updatedRecord = {\n  id: \"fbd2a565-8c10-497a-95b8-ce4ea6f474e1\",\n  title: \"new post, modified\",\n  content: \"yoyo\",\n  last_modified: 1456184189160\n};\n\nclient.bucket(\"blog\")\n  .collection(\"posts\")\n  .updateRecord(updatedRecord, {safe: true});\n```\n\nIf this record has been modified on the server already, meaning its `last_modified` is greater than the one we provide , we'll get a `412` error response.\n\nIf no `last_modified` value is provided at all, a safe update will simply guarantee that an existing resource with the provided ID won't be overriden.\n\n### Safe deletions\n\nThe same applies for deletions, where you can pass both a `safe` and `last_modified` options:\n\n```js\nclient.bucket(\"blog\")\n  .collection(\"posts\")\n  .deleteRecord(\"fbd2a565-8c10-497a-95b8-ce4ea6f474e1\", {\n    safe: true,\n    last_modified: 1456184189160\n  });\n```\n\n\n## Events\n\nThe `KintoClient` exposes an `events` property you can subscribe public events from. That `events` property implements nodejs' [EventEmitter interface](https://nodejs.org/api/events.html#events_class_events_eventemitter).\n\n\n### The `backoff` event\n\nTriggered when a `Backoff` HTTP header has been received from the last received response from the server, meaning clients should hold on performing further requests during a given amount of time.\n\nThe `backoff` event notifies what's the backoff release timestamp you should wait until before performing another operation:\n\n```js\nconst client = new KintoClient();\n\nclient.events.on(\"backoff\", function(releaseTime) {\n  const releaseDate = new Date(releaseTime).toLocaleString();\n  alert(`Backed off; wait until ${releaseDate} to retry`);\n});\n```\n\n### The `deprecated` event\n\nTriggered when an `Alert` HTTP header is received from the server, meaning that a feature has been deprecated; the `event` argument received by the event listener contains the following deprecation information:\n\n- `type`: The type of deprecation, which in ou case is always `soft-eol` (`hard-eol` alerts trigger an `HTTP 410 Gone` error);\n- `message`: The deprecation alert message;\n- `url`: The URL you can get information about the related deprecation policy.\n\n```js\nconst client = new KintoClient();\n\nclient.events.on(\"deprecated\", function(event) {\n  console.log(event.message);\n});\n```\n\n### The `retry-after` event\n\nWhen an error occurs on server, a `Retry-After` HTTP header indicates the duration in seconds that clients should wait before retrying the request.\n\nThe `retry-after` event notifies what is the timestamp you should wait until before performing another operation:\n\n```js\nconst client = new KintoClient();\n\nclient.events.on(\"retry-after\", function(releaseTime) {\n  const releaseDate = new Date(releaseTime).toLocaleString();\n  alert(`Wait until ${releaseDate} to retry`);\n});\n```\n\n> #### Note:\n> Eventually, we would like to automate the retry behaviour for requests. See https://github.com/Kinto/kinto-client/issues/34\n","created":"2016-02-08T14:55:05.591Z","modified":"2016-06-16T11:58:18.949Z","lastPublisher":{"name":"leplatrem","email":"leplatrem@gmail.com"},"owners":[{"name":"ametaireau","email":"alexis@notmyidea.org"},{"name":"leplatrem","email":"leplatrem@gmail.com"},{"name":"n1k0","email":"nicolas@perriault.net"},{"name":"natim","email":"natim@mozilla.com"}],"other":{"_attachments":{},"_from":".","_id":"kinto-client","_nodeVersion":"6.0.0","_npmOperationalInternal":{"host":"packages-16-east.internal.npmjs.com","tmp":"tmp/kinto-client-0.9.2.tgz_1464878779945_0.520914315013215"},"_npmUser":{"name":"leplatrem","email":"leplatrem@gmail.com"},"_npmVersion":"3.8.6","_rev":"1-f4c18caedd7eb183249ac45f1630fc38","_shasum":"7a5167308158330971593b3cf40aacf98c4375dd","author":{"name":"Mozilla","email":"storage-team@mozilla.com"},"bugs":{"url":"https://github.com/Kinto/kinto-client/issues"},"directories":{},"dist-tags":{"latest":"0.9.2"},"dist":{"shasum":"7a5167308158330971593b3cf40aacf98c4375dd","tarball":"http://registry.npmjs.org/kinto-client/-/kinto-client-0.9.2.tgz"},"maintainers":[{"name":"ametaireau","email":"alexis@notmyidea.org"},{"name":"leplatrem","email":"leplatrem@gmail.com"},{"name":"n1k0","email":"nicolas@perriault.net"},{"name":"natim","email":"natim@mozilla.com"}],"readmeFilename":"README.md","time":{"modified":"2016-06-16T11:58:18.949Z","created":"2016-02-08T14:55:05.591Z","0.1.0":"2016-02-08T14:55:05.591Z","0.1.1":"2016-02-08T15:02:27.124Z","0.2.0":"2016-02-18T14:24:42.337Z","0.2.1":"2016-02-18T15:36:35.091Z","0.2.2":"2016-02-18T16:10:32.217Z","0.2.3":"2016-02-20T17:33:03.237Z","0.3.0":"2016-03-02T17:15:37.192Z","0.4.0":"2016-03-03T17:28:49.915Z","0.4.1":"2016-03-04T12:22:38.660Z","0.4.2":"2016-03-07T13:15:57.541Z","0.5.0":"2016-03-16T17:07:45.238Z","0.6.0":"2016-04-08T14:39:40.734Z","0.7.0":"2016-05-25T18:11:10.317Z","0.8.0":"2016-05-28T14:00:13.800Z","0.8.1":"2016-05-30T07:26:20.106Z","0.8.2":"2016-05-30T07:41:04.286Z","0.8.3":"2016-05-31T07:52:21.256Z","0.9.0":"2016-06-02T09:09:52.801Z","0.9.1":"2016-06-02T13:47:04.006Z","0.9.2":"2016-06-02T14:46:21.713Z"}}}