{"name":"http-master","version":"1.2.6","description":"Easy to setup, convenient, universal, parallel, http/https proxy daemon. Setup in 1 minute, run, configure, adapt. Proxying based on excellent node-http-proxy.","main":"src/HttpMaster.js","scripts":{"test":"istanbul cover node_modules/mocha/bin/_mocha -- -R spec tests/"},"repository":"https://github.com/encharm/http-master","keywords":["http","https","proxy"],"bin":{"http-master":"./bin/http-master","cert-scan":"./bin/cert-scan"},"license":"MIT","dependencies":{"async":"^2.1.4","bluebird":"^3.4.3","bugsnag":"1.8.0","compression":"^1.6.2","connect-gzip-static":"^1.0.0","eventemitter3":"^1.2.0","extend":"3.0.0","greenlock":"^2.1.11","http-auth":"~2.2.9","http-proxy":"^1.16.2","js-yaml":"3.6.1","jsonfn":"0.31.0","jsonlint-lines":"1.7.1","le-challenge-standalone":"^2.0.0","le-sni-auto":"^2.0.1","memoizee":"^0.4.1","moment":"^2.17.1","morgan":"1.7.0","node-watch":"^0.4.0","ocsp":"^1.1.0","parseurl":"^1.3.1","send":"^0.14.2","spdy":"^3.4.0","uid-number":"0.0.6","uuid":"^2.0.2","ws":"^1.1.1","x509.js":"1.0.0","xregexp":"^3.1.1","yargs":"^6.6.0","bufferutil":"^1.2.1","codeclimate-test-reporter":"~0.3.3","utf-8-validate":"^1.2.1"},"devDependencies":{"chai":"^3.5.0","fs.extra":"1.3.2","istanbul":"^0.4.5","mocha":"^3.0.2","request":"^2.79.0","request-promise":"^4.1.1","should":"^11.1.0"},"optionalDependencies":{"bufferutil":"^1.2.1","codeclimate-test-reporter":"~0.3.3","utf-8-validate":"^1.2.1"},"gitHead":"2851248a600950df0153d0812de2e1d509d58bed","homepage":"https://github.com/encharm/http-master#readme","versions":[{"number":"0.4.0","date":"2014-01-25T23:41:32.325Z"},{"number":"0.4.1","date":"2014-01-26T00:03:00.216Z"},{"number":"0.5.0","date":"2014-01-27T00:16:52.783Z"},{"number":"0.5.1","date":"2014-01-30T01:46:44.459Z"},{"number":"0.5.2","date":"2014-01-30T01:52:10.746Z"},{"number":"0.5.3","date":"2014-01-30T02:17:59.817Z"},{"number":"0.5.4","date":"2014-01-30T02:21:01.425Z"},{"number":"0.5.5","date":"2014-01-30T23:24:33.099Z"},{"number":"0.5.6","date":"2014-01-31T00:29:47.086Z"},{"number":"0.5.7","date":"2014-02-01T17:41:37.626Z"},{"number":"0.5.8","date":"2014-02-01T21:17:26.383Z"},{"number":"0.5.9","date":"2014-02-02T11:54:34.411Z"},{"number":"0.6.0","date":"2014-02-02T17:19:01.871Z"},{"number":"0.6.2","date":"2014-02-11T10:30:56.955Z"},{"number":"0.6.3","date":"2014-03-05T15:43:08.234Z"},{"number":"0.6.4","date":"2014-03-06T17:12:01.741Z"},{"number":"0.6.5","date":"2014-03-06T20:21:48.175Z"},{"number":"0.6.6","date":"2014-03-06T20:29:52.640Z"},{"number":"0.6.7","date":"2014-03-06T22:28:25.989Z"},{"number":"0.6.8","date":"2014-03-07T23:05:31.535Z"},{"number":"0.6.9","date":"2014-03-11T21:09:24.017Z"},{"number":"0.6.10","date":"2014-03-12T01:02:26.370Z"},{"number":"0.6.11","date":"2014-03-12T22:04:24.359Z"},{"number":"0.7.0","date":"2014-04-15T22:01:14.822Z"},{"number":"0.7.1","date":"2014-04-15T23:07:02.363Z"},{"number":"0.7.2","date":"2014-04-15T23:38:27.130Z"},{"number":"0.7.3","date":"2014-04-16T21:41:11.770Z"},{"number":"0.7.4","date":"2014-04-16T21:52:49.141Z"},{"number":"0.7.5","date":"2014-04-16T21:56:35.132Z"},{"number":"0.7.6","date":"2014-04-16T23:16:38.620Z"},{"number":"0.7.7","date":"2014-04-16T23:22:47.948Z"},{"number":"0.7.8","date":"2014-04-23T09:24:10.641Z"},{"number":"0.7.9","date":"2014-05-13T14:33:00.279Z"},{"number":"0.7.10","date":"2014-05-21T22:00:15.774Z"},{"number":"0.7.14","date":"2014-10-03T18:30:39.088Z"},{"number":"0.7.15","date":"2014-10-05T09:38:18.840Z"},{"number":"0.8.0-beta1","date":"2014-10-15T00:52:05.665Z"},{"number":"0.8.0","date":"2014-10-15T01:01:35.381Z"},{"number":"1.0.0","date":"2014-10-19T16:36:01.557Z"},{"number":"1.0.1","date":"2014-10-23T19:48:49.998Z"},{"number":"1.0.2","date":"2014-11-24T14:33:02.382Z"},{"number":"1.0.3","date":"2014-11-28T18:37:32.446Z"},{"number":"1.0.4","date":"2014-11-29T01:37:59.521Z"},{"number":"1.0.5","date":"2014-11-29T01:59:24.660Z"},{"number":"1.0.6","date":"2015-03-03T04:23:18.069Z"},{"number":"1.0.7","date":"2015-03-06T03:15:06.216Z"},{"number":"1.0.8","date":"2015-04-01T22:58:37.798Z"},{"number":"1.0.9","date":"2015-04-01T23:15:52.296Z"},{"number":"1.0.10","date":"2015-05-21T03:35:41.608Z"},{"number":"1.0.11","date":"2015-05-21T05:09:32.312Z"},{"number":"1.0.12","date":"2015-05-25T11:33:08.520Z"},{"number":"1.0.13","date":"2015-05-31T20:10:34.094Z"},{"number":"1.0.14","date":"2015-06-01T13:10:16.824Z"},{"number":"1.0.15","date":"2015-07-05T17:34:40.012Z"},{"number":"1.0.16","date":"2015-07-05T18:07:47.885Z"},{"number":"1.0.17","date":"2015-08-15T05:19:48.223Z"},{"number":"1.0.18","date":"2015-08-26T19:36:40.100Z"},{"number":"1.0.19","date":"2015-10-05T15:50:04.742Z"},{"number":"1.0.20","date":"2015-10-05T21:08:24.088Z"},{"number":"1.0.22","date":"2015-11-24T17:58:13.476Z"},{"number":"1.0.23","date":"2015-11-24T18:06:49.426Z"},{"number":"1.0.24","date":"2015-11-27T15:30:02.206Z"},{"number":"1.0.25","date":"2015-12-07T20:50:36.282Z"},{"number":"1.0.26","date":"2016-01-06T16:00:02.338Z"},{"number":"1.0.27","date":"2016-01-07T14:20:38.279Z"},{"number":"1.0.28","date":"2016-02-10T21:58:14.425Z"},{"number":"1.0.29","date":"2016-04-04T17:57:05.648Z"},{"number":"1.0.30","date":"2016-04-28T21:59:01.317Z"},{"number":"1.1.0","date":"2016-05-02T06:19:36.659Z"},{"number":"1.1.1","date":"2016-05-02T07:14:08.076Z"},{"number":"1.1.2","date":"2016-06-29T20:35:48.184Z"},{"number":"1.1.3","date":"2016-07-05T21:13:46.922Z"},{"number":"1.1.4","date":"2016-07-18T21:01:12.910Z"},{"number":"1.1.5","date":"2016-08-07T07:32:16.155Z"},{"number":"1.1.6","date":"2016-08-07T17:05:18.669Z"},{"number":"1.1.7","date":"2016-08-11T01:41:15.752Z"},{"number":"1.1.8","date":"2016-08-18T01:54:04.250Z"},{"number":"1.2.0","date":"2016-08-28T06:01:13.488Z"},{"number":"1.2.1","date":"2016-08-29T02:15:51.681Z"},{"number":"1.2.2","date":"2016-08-29T02:45:14.319Z"},{"number":"1.2.3","date":"2016-09-20T22:35:37.749Z"},{"number":"1.2.4","date":"2016-09-20T23:02:16.442Z"},{"number":"1.2.5","date":"2017-01-27T22:22:15.006Z"},{"number":"1.2.6","date":"2017-01-29T12:29:05.529Z"}],"readme":"![http-master](https://raw.github.com/CodeCharmLtd/http-master/master/assets/http-master.png)\n===============\n\n[![Package version](https://img.shields.io/npm/v/http-master.svg)](https://www.npmjs.org/package/http-master)\n[![Package version](https://img.shields.io/npm/dm/http-master.svg)](https://www.npmjs.org/package/http-master)\n[![GPA](https://img.shields.io/codeclimate/github/encharm/http-master.svg)](https://codeclimate.com/github/encharm/http-master)\n[![Code coverage](https://img.shields.io/codeclimate/coverage/github/encharm/http-master.svg)](https://codeclimate.com/github/encharm/http-master)\n[![Build status](https://img.shields.io/travis/encharm/http-master.svg)](https://travis-ci.org/encharm/http-master)\n[![Dependcies status](http://img.shields.io/gemnasium/encharm/http-master.svg)](https://gemnasium.com/encharm/http-master)\n\n\n* [About](#about)\n* [Installation and basic usage](#installandbasicusage)\n* [Usage as a module](#module)\n* [Watch config for changes](#watchconfig)\n* [Use custom config loader](#configloader)\n* Features\n  * [Proxy](#proxy)\n  * [URL rewrite](#urlrewrite)\n  * [Redirect](#redirect)\n  * [Automatic free SSL / Letsencrypt](#autossl)\n  * [SSL](#ssl)\n  * [Websockify](#websockify)\n  * [Logging](#logging)\n  * [HTTP authentication](#auth)\n  * [Add header](#addheader)\n  * [Compression / GZIP](#gzip)\n  * [Regexp matching](#regexpmatching)\n  * [Error handling](#reject)\n  * [Serve static directory](#static)\n  * [Advanced routing](#advancedrouting)\n* [Upstart](#upstart)\n* [Systemd](#systemd)\n* [Contributors](#contributors)\n* [Sponsors](#sponsors)\n* [License](#license)\n\n<a name=\"about\" />\n## About\n\nhttp-master is a front end http service with with easy setup of reverse proxy/redirecting/other-actions logic. It means it was designed to run on your port 80 and 443 but can run on any. It can run as a module or as a standalone application. Your average use case could be having several web applications (node.js, rails, Java etc.) running on different internal ports and Apache running on port 8080. http-master allows you to easily define rules which domain should target which server and if no rules match, everything else could go to the Apache server. This way you setup your SSL in one place, in http-master and even non-SSL compatible http server can be provided with HTTPS. Many different flexible routing configurations are possible to set up.\n\nSome of the features:\n* Zero-effort HTTPS configuration. Provide only primary domain and configuration is loaded automatically from a given certificate directory.\n* Support SNI extension - multiple SSL certificates on the same IP.\n* Supports web sockets.\n* Easy all in one place configuration for every listening port (eg. 80 and 443 together)\n  * Setup reverse proxy with optional URL rewriting and optional regexp matching of host and path.\n  * Setup redirect with optional regexp matching to construct final URL.\n  * Setup basic static files server for a given route.\n  * Setup Basic-AUTH for a given route (sponsored feature)\n  * Create logs in apache format for any given point in routing setup.\n  * Easily turn any local or remote TCP servers to web sockets. (websockify) Destination may be determined dynamically from a path.\n  * Allows flexible definition of matching behaviour.\n  * Enable compression on one, any or all of the routes.\n  * Add headers to any defined route.\n* Supports unicode domains out of the box.\n* Multi-core/cpu friendly. Runs multiple instances/workers which will serve connections in a round-robin fashion. You can of course choose to run in a single process  without any workers, if you use http-master as a module or set worker count to 0.\n* SSL tweaked to reasonable security level supporting TLS session resumption.\n* Automatically watches for config changes and reloads the logic without any downtime. Simply start the deamon and add new rules while having the http-master online.\n* Possibility to load config from Redis/etcd or another remote resource. (\\*\\*)\n* May drop privileges to user/group once started.\n* Forward secrecy support when running on Node >= 0.11.14\n\nOngoing development on:\n* Easier and easier configuration format.\n* Automatic management of time expiration of certificates.\n* Request/response filters. (including to modify data)\n\n\n(\\*\\*) Needs writing a custom config loader as a javascript file.\n\n\n<a name=\"installandbasicusage\"/>\n## Installation and basic usage\nRefer to section [Usage as a module](#module) if you are interested in that use-case.\n\nTo install, Node.JS is required to be installed and in your PATH:\n`npm install -g http-master` (may be needed to run as root depending on your setup)\n\nTo run: `http-master --config http-master.conf`\n\nConfig files may be written in either JSON or YAML. For the sake of documentation (YAML allows comments) all examples will be written in YAML (but with JSON style).\n\nSimple example config (more advanced features are convered elsewhere):\n\n```YAML\nwatchConfig: true # watch config file for changes\nports: { # each port gets a separate configuration\n  80: {\n    router: {\n      # redirect .net requests to .com\n      'code2flow.net': 'redirect -> http://code2flow.com/[path]',\n      # redirect http to https\n      'secure.code2flow.com': 'redirect -> https://code2flow.com/[path]'\n      # Proxy all traffic at domain code2flow.com to port 8099\n      'code2flow.com' : 8099,\n      # Proxy all traffic for any subdomains of services.com to IP 192.168.10.6 and port 8099\n      '*.services.com' : '192.168.10.6:8099', \n      # Proxy remaning traffic to port 8080, for example Apache could run there\n      '*' : 8080\n    }\n  }\n  443: {\n    router: {\n      'code2flow.com': '127.0.0.1:9991',\n       # choose application depending on path\n      'service.myapp.com/downloads/*': 10443,\n       # choose application depending on path\n      'service.myapp.com/uploads/*': 15000,\n      # all remaining https traffic goes to port 4443, for example apache\n      \"*\": \"127.0.0.1:4443\"\n    },\n    ssl: {\n      # needs to be provided for non-SNI browsers\n      primaryDomain: \"code2flow.com\",\n      # simply put certificates inside this dir, run with --debug=config to see what was read\n      certDir: \"/etc/http-master/certificates\" \n    }\n  },\n  middleware: ['log -> /path/to/access.log' ], # Totally optional access.log, other middleware such as gzip could be added here\n  modules: {\n    appLog: '/path/to/app.log'\n  },\n  silent: false # if using above appLog, you can silence standard output\n}\n```\n\nIf for some reason automatic ssl setup is not working for you, you can debug the loaded certificates with the included `cert-scan` tool:\n```\ncert-scan /path/to/certificate-dir\n```\nand/or\n```\nhttp-master --config http-master.conf --show-rules\n```\n\nAlternatively you may setup ssl manually:\n```YAML\n# this part belongs to some port configuration\nssl : {\n  key: \"/path/to/crt/domain.key\",\n  cert: \"/path/to/crt/domain.crt\", # or .pem\n \"ca\": [ # may be one or many or a bundle (without array)\n    \"/path/to/ca/file/sub.class1.server.ca.pem\"\n  ],\n  \"SNI\": {\n    \"*.codecharm.co.uk\": {\n      \"key\": \"/path/to/crt/codecharm.co.uk.key\",\n      \"crt\": \"/path/to/crt/codecharm.co.uk.crt\",\n      \"ca\" : \"/path/to/cabundle/ca.pem\" # may be an array if not bundle\n    },\n    \"someotherdomain.com\": {\n      \"key\": \"/path/to/crt/someotherdomain.com.key\",\n      \"crt\": \"/path/to/crt/someotherdomain.com.crt\",\n      \"ca\": [\n        \"/path/to/ca/file/someca.pem\"\n      ]\n    }\n  }\n}\n```\n\n\n<a name=\"module\"/>\n## Usage as a module\n\n```\nnpm install --save http-master\n```\n```JavaScript\nvar HttpMaster = require('http-master');\nvar httpMaster = new HttpMaster();\nhttpMaster.init({\n // your config in here\n}, function(err) {\n // listening\n});\n```\n####Class: HttpMaster\n\n####Event: 'allWorkersStarted'\n`function()`\nEmitted after succesful `.init()`\n\n####Event: 'allWorkersReloaded'\n`function()`\nEmitted after succesful `.reload()`\n\n####Event: 'logNotice'\n`function(msg)`\nHelpful logging information in case something got wrong.\n\n####Event: 'logError'\n`function(msg)`\nInformation about errors that could be logged.\n\n####Event: 'error'\n`function(err)`\nEmitted on failure to listen on any sockets/routes or failure to use given configuration.\n\n#### httpMaster.init(config, [callback])\nInitialize http master with a given config. See the section about config to learn about acceptable input.\nCallback if given will call `function(err)`. This function should be called only once.\n\n#### httpMaster.reload(config, [callback])\nPerform a zero-downtime reload of configuration. Should be very fast and ports will not stop listening.\nStopping httpMaster may be done using `httpMaster.reload({})`. Which should close all servers.\n\nNote: Changing workerCount is the only thing that may not change.\n\n\n<a name=\"watchconfig\"/>\n## Watch config for changes\n\nAdd `--watch` or add to config `\"watchConfig\": true`.\n\nYou may also trigger reload manually by sending USR1 signal to the master process. (only on *nix)\n\nIf you run via systemd then you may use the following `systemctl reload http-master.service`\n\n\n<a name=\"configloader\"/>\n## Use custom config loader\n \nSee this repository for an example https://github.com/CodeCharmLtd/http-master-example-httploader\n\nIf you have an old 0.7.0 config, you can also load it with a provided config loader by:\n\n`http-master --configloader /path/to/lib/node_modules/http-master/migrateV1Config.js --config oldconfig.json`\n\n<a name=\"proxy\"/>\n## Proxy\nProxy is a default action what to do with a http request but in each place where a number or host are used, you could do a redirect as well.\n\n### Proxy all requests from port 80 to port 4080\n```YAML\n# Short-hand syntax\nports: {\n  80: 4080\n}\n```\n```YAML\n# A bit longer short-hand syntax (but could be used with ssl)\nports: {\n  443: {\n    router: 4080,\n    ssl: {} # this needs setting up\n  }\n}\n```\n```YAML\n# Normal syntax - baseline for extending\nports: {\n  80: {\n    router: {\n      \"*\": 4080\n    }\n  }\n}\n```\n\n### Proxy by domain name\n```YAML\nports: {\n  80: {\n    router: {\n      # two rules will match all domain1.com and www.domain1.com requsts\n      \"domain1.com\": 3333,\n      \"www.domain1.com\": 3334,\n      # will match all domain2.com requsts (but not www.domain2.com)\n      # and proxy it to a host with different ip in internal network\n      \"domain2.com\": \"192.168.1.1:80\",\n      # this will match every subdomain of domain4.com, but not domain4.com\n      \"*.domain4.com\" : \"5050\",\n      # this will match every subdomain of domain4.com, and domain4.com\n      \"*?.domain4.com\": \"some_machine_by_host:4020\"\n    }\n  }\n}\n```\n\n### Proxy by domain name and/or path\n```YAML\nports: {\n  80: {\n    router: {\n      # will match domain1.com/path1 or domain1/path/whatever or domain1/path/whatever/whatever\n      # Last * in path match matches everything and makes last slash optional \n      \"domain1.com/path1/*\" : 5010,\n      \"domain1.com/path2/*\" : 5011,\n      # and rest goes to 5012 - this needs to be defined as patch matching\n      # happens after domain matching\n      \"domain1.com/*\" : 5012\n    }\n  }\n}\n```\n\n### Proxy port settings\n```YAML\nports: {\n  80: {\n    router: {\n      \"domain.com\" : 5012\n    },\n    agentSettings: {\n      keepAlive: true\n    },\n    proxyTargetTimeout: 1500,\n    proxyTimeout: 1000\n  }\n}\n```\nIn addition to `router`, following setting could be set per port:\n* `agentSettings`, for full list of options check node documentation for [http.Agent](http://nodejs.org/api/http.html#http_class_http_agent). You can also set default agent settings at the root level in your config, using the same `agentSettings` name\n* `proxyTargetTimeout` sets timeout for target connection\n* `proxyTimeout` sets timeout for proxy connection\n\n<a name=\"urlrewrite\"/>\n## URL rewrite\nAll proxy example can be adapted to also do URL rewriting. All matching rules can do either wildcard (implicit) regexp matching explicit regexp matching. Let's focus on implicit first.\n\n```YAML\nports: {\n  80: {\n    router: {\n      # * will match all subdomains\n      # http://abc.domain.com will rewrite to -> /abc/\n      # http://abc.domain.com/test will rewrite to -> /abc/test\n      # http://xyz.abc.domain.com/test will rewrite to -> /xyz.abc/test\n      \"*.domain.com\": \"5050/[1]/[path]\"\n    }\n  }\n}\n```\nSo what if you want to rewrite two levels of subdomains?\n```YAML\nports: {\n  80: {\n    router: {\n      \"*.*.domain.com\" : \"5050/[1]/[2]/[path]\"\n    }\n  }\n}\n```\n\nYou can also match paths and rewrite:\n```YAML\nports: {\n  80: {\n    router: {\n      \"*.code2flow.com/test/*\": \"[1].somewhere.net/something/[2]\"\n    }\n  }\n}\n```\nEverything above and more you can also do with regexp matching which is described in [Regexp matching](#regexpmatching) section.\n\n<a name=\"redirect\"/>\n## Redirect\nRedirect is a feature implemented and invoked in a similiar way to proxy.\nThe different is that instead of proxy target, you should point rules to `\"redirect -> http://target\"`. The way target is constructed often is desired to be dynamic, for example that's how https to http redirect is usually used.\n\n```YAML\nports: {\n  80: {\n    router: {\n      # rewrite all http://atlashost.eu/* requests to https://atlashost/eu/*\n      # [path] is a special macro that will be replaced with the request's pathname\n      \"atlashost.eu\": \"https://atlashost.eu/[path]\",\n      # for example proxy rest to apache's port\n      '*' : 80443\n    }\n  },\n  443: {\n    router: {\n      # proxy to actual application\n      \"atlashost.eu\": 3333,\n      # proxy rest to apache\n      \"*\": 8080\n    },\n    ssl: {} # ssl should be configured here\n  }\n}\n```\n\n<a name=\"autossl\"/>\n## Automatic free SSL / Letsencrypt\nThe following configuration will enable free encryption of websites. See [https://letsencrypt.org/](letsencrypt website) for details.\n\n```YAML\nports: {\n  80: {\n    router: {\n      \"virtkick.com\": \"https://virtkick.com/[path]\",\n    }\n  },\n  443: {\n    router: {\n      \"virtkick.com\": 3333\n    },\n    ssl: {\n      letsencrypt: true\n    }\n  }\n},\nmodules: {\n  letsencrypt: {\n    configDir: '/etc/letsencrypt', # needs to be writable\n    email: 'your@email.com',\n    agreeTos: true\n  }\n}\n```\n\n<a name=\"ssl\"/>\n## SSL\nSSL can be configured for any port by simply providing \"ssl\" key to its entry, for example below is an auto-configuration example that also handles SNI:\n\n```YAML\nports: {\n  443: {\n    router: {}, # your rules here\n    ssl: {\n      # Even SNI configuration requires at least one certificate that \n      # will be served to non-SNI browsers\n      primaryDomain: \"yourdomain.com\",\n      certDir: \"/etc/http-master/certificates\"\n    }\n  }\n}\n```\n\nIf for some reason auto-configuration does not work for you, it may be configured manually:\n```YAML\nports: {\n  443: {\n    router: {}, # your rules here\n    ssl: {\n      key: \"/path/to/key/domain.key\",\n      cert: \"/path/to/key/domain.crt\",\n      ca: \"/path/to/ca/bundle/ca.pem\",\n      # alternatively above could be written as\n      # ca: [\"/path/to/ca1.crt\", \"/path/to/ca2.crt\"]\n      SNI: {\n        \"*.codecharm.co.uk\" : {\n          key: \"/path/to/key/codecharm.key\",\n          cert: \"/path/to/key/codecharm.crt\",\n          ca: \"/path/to/ca/bundle.pem\"\n        },\n        \"singledomain.net\" : {\n          key: \"/path/to/key/singledomain.key\",\n          cert: \"/path/to/key/singledomain.crt\",\n          ca: \"/path/to/ca/bundle.pem\"\n        }\n      }\n    }\n  }\n}\n```\n\n<a name=\"websockify\"/>\n## Websockify\nWebsockify is a feature which can turn any TCP socket to a web socket.\n\n```YAML\nports: {\n  443: {\n    router: {\n      \"myserver.net/services/ssh\" : \"websockify -> 22\"\n    },\n    ssl: {} # ssl should be configured here\n  }\n}\n```\nThe above makes it possible to access ssh server over https, for example from the browser. Simply connect to `wss://myserver.net/services/ssh`, it will initiate connection to ssh and proxy raw tcp data. Note: for it to be usable requires someone to implement openssh in asm.js.\n\nTo do something in reverse, for example access the above websocket via original ssh client on other machine, one could do the following:\n```\nnpm install -g dewebsockify\ndewebsockify wss://myserver.net/services/ssh 2222\nssh localhost -p 2222 # this will connect to the remote server over HTTPS!!\n```\n\nAnother interesting use is running websockify to turn other services such as VNC to be usable by the browser. That's what [noVNC project]{http://kanaka.github.io/noVNC/} is already doing. In fact, http-master works out of the box with noVNC.\n\nInteresting type of use would be to turn this into a general gateway to any TCP services (auth can be added for some security):\n\n```YAML\nports: {\n  443: {\n    router: {\n      # call to wss://myserver.net/tcpgate/otherserver.com/22 would connect\n      # to remote server's SSH\n      \"myserver.net/tcpgate/*/*\" : \"websockify -> [1]:[2]\"\n    },\n    ssl: {} # ssl should be configured here\n  }\n}\n```\n<a name=\"logging\"/>\n## Logging\nTo enable application log:\n```YAML\nports: {}, # your port config here\nmodules: {\n  appLog: \"/path/to/app.log\"\n}\n```\n\nTo enable general access log:\n```YAML\nmiddleware: [\"log -> /path/to/access.log\"],\nports: {} # your port config here\n```\n\nTo enable logging per route (note, consult [Advanced routing](#advancedrouting) for more details)\n```YAML\nports: {\n  80: {\n    router: {\n      \"myapp.net\": [\"log -> /path/to/myapp.log\", 3333]\n    }\n  }\n}\n```\nRule of thumb is, wherever you had some target be it proxy or redirect, you can turn it to an array and place logging rule as first element.\n\nLogging is in apache format.\n\nNote: you may log to the same file from multiple routes, not a problem.\n\n<a name=\"auth\"/>\n## HTTP authentication\n```YAML\nports: {\n  80: {\n    router: {\n      \"myapp.net\": [\"auth -> file.passwd\", 3333]\n    }\n  }\n}\n```\nBasically you need to generate a passwd file and point http-master to it.\nYou can generate one with [node version of htpasswd]{https://www.npmjs.org/package/htpasswd}.\n\n<a name=\"addheader\"/>\n## Add header\nYou can add one or more arbitrary requests to incoming headers/\n```YAML\nports: {\n  80: {\n    router: {\n      \"myapp.net\": [\"addHeader -> X-Some-Header1=Value1\", \"addHeader -> X-Some-Header2=Value2\", 3333]\n    }\n  }\n}\n```\n\n<a name=\"gzip\"/>\n## Compression / GZIP\n\nThe single passed argument is compression level, from 1 to 9. 9 is most compression but slowest. To enable compression for all requests:\n\n```YAML\nmiddleware: [\"gzip -> 9\"],\nports: {\n  router: {} #your rules here\n}\n```\n\nTo enable compression for a single route:\n```YAML\nports: {\n  router: {\n    \"domain.com\" : [\"gzip -> 9\", 3333]\n  }\n}\n```\n\n<a name=\"regexpmatching\"/>\n## Regexp matching\n\nShort-hand matching format with using `*` or `*?` can be replaced by using explicit regexp expression, such as this:\n\n```YAML\nports: {\n  80: {\n    # [1] will contain app1 or app2, each number will reference regexp catch groups\n    \"^(app1|app2)\\\\.go\\\\.there\\\\.com\": \"5050/[1]\"\n  }\n}\n```\nOnly problem is the necessity to escape characters for string inclusion.\nNamed groups are also supported. Please open an issue to request more docs.\n\n<a name=\"reject\" />\n## Error handling\n\nHTTP master will report some errors in plain text, you can override this behaviour by providing a custom html error page:\n```YAML\nports: {}, # your port config here\nerrorHtmlFile: \"/path/to/error.html\"\n```\nThe html file may reference simple images which will be embedded to the response in form of base64. It cannot reference other files. Error html needs to be fast.\n\nYou can in fact trigger errors manually as well, for scheduled downtime for example:\n```YAML\nports: {\n  80: {\n    # this will report error 503\n    \"domain.com\" : \"reject -> 503\"\n  }\n}\n```\n\n<a name=\"static\" />\n## Serve static directory\nYou may also serve a static files , example:\n```YAML\nports: {\n  80: {\n    \"domain.com/*\" : \"static -> /home/domain/[1]\"\n  }\n}\n```\nPlease open an issue to request more docs.\n\n<a name=\"advancedrouting\"/>\n## Advanced routing\n\nAdvanced routing refers to ability of nesting multiple layers of rules, such as:\n\n```YAML\nports: {\n  80 : {\n    \"*.domain.com\" : [\"log -> domain.log\", {\n      \"*/path1\" : 3333,\n      \"*/path2\" : 3334,\n      \"*/*\": 3335\n    }]\n  }\n}\n```\nPlease open an issue to request more docs.\n\n<a name=\"systemd\"/>\n## Systemd\n\nWe provide an example systemd unit file. The config file is set to /etc/http-master/http-master.conf by default. Copy the `http-master.service` to /etc/systemd/system to use it.\n\n* `systemctl start/stop/restart http-master`\n* `systemctl enable http-master` - auto-start\n* `systemctl reload http-master` - reload config with `kill -USR1`\n\n<a name=\"upstart\"/>\n## Upstart\n\nAlso provided is `http-master-upstart.conf` which can be used with Upstart. As above, the config file is set to /etc/http-master/http-master.conf by default. Copy `http-master-upstart.conf` to `/etc/init/http-master.conf` to use it.\n\n* `service http-master start`\n* `service http-master stop`\n* `service http-master restart`\n\n<a name=\"contributors\"/>\n## Contributors\n\n* Damian Kaczmarek <damian@codecharm.co.uk>\n* Damian Nowak <nowaker@virtkick.com>\n* Sergey Zarouski <sergey@webuniverse.io>\n\n<a name=\"sponsors\"/>\n## Sponsors\n\n[eeGeo](http://sdk.eegeo.com/) - basic HTTP authentication against htpasswd file [#32](https://github.com/CodeCharmLtd/http-master/issues/32)\n\nPlease open an issue if you would like a specific feature to be implemented and sponsored.\n\nExample sponsored features could include:\n* Automatically lazy-starting FastCGI apps such as PHP without overhead of running separate Apache and with better security handling.\n* Home directory support\n* Some form of .htaccess support\n* Additional logging formats\n\n<a name=\"license\"/>\n## License\nCopyright (c) 2013-2015 [Virtkick, Inc.](https://www.virtkick.com/)\n\nLicensed under the MIT license, see `LICENSE` for details.\n","starsCount":9,"created":"2014-01-25T23:41:32.325Z","modified":"2017-01-29T12:29:05.529Z","lastPublisher":{"name":"rush","email":"rush@rushbase.net"},"owners":[{"name":"rush","email":"rush@rushbase.net"}],"other":{"_attachments":{},"_from":".","_id":"http-master","_nodeVersion":"6.9.1","_npmOperationalInternal":{"host":"packages-12-west.internal.npmjs.com","tmp":"tmp/http-master-1.2.6.tgz_1485692943207_0.5969504537060857"},"_npmUser":{"name":"rush","email":"rush@rushbase.net"},"_npmVersion":"3.10.8","_rev":"3-ba8c723469d7154832654263bc5b9f65","_shasum":"4ea006338a5ac0e80b956977afa2f3fec145194c","author":{"name":"Damian Kaczmarek","email":"damian@codecharm.co.uk"},"bugs":{"url":"https://github.com/encharm/http-master/issues"},"contributors":[{"name":"Damian Nowak","email":"damian.nowak@atlashost.eu"},{"name":"Sergey Zarouski","email":"sergey@webuniverse.io"}],"directories":{},"dist-tags":{"latest":"1.2.6","beta":"0.8.0"},"dist":{"shasum":"4ea006338a5ac0e80b956977afa2f3fec145194c","tarball":"https://registry.npmjs.org/http-master/-/http-master-1.2.6.tgz"},"maintainers":[{"name":"rush","email":"rush@rushbase.net"}],"readmeFilename":"README.md","time":{"modified":"2017-01-29T12:29:05.529Z","created":"2014-01-25T23:41:32.325Z","0.4.0":"2014-01-25T23:41:32.325Z","0.4.1":"2014-01-26T00:03:00.216Z","0.5.0":"2014-01-27T00:16:52.783Z","0.5.1":"2014-01-30T01:46:44.459Z","0.5.2":"2014-01-30T01:52:10.746Z","0.5.3":"2014-01-30T02:17:59.817Z","0.5.4":"2014-01-30T02:21:01.425Z","0.5.5":"2014-01-30T23:24:33.099Z","0.5.6":"2014-01-31T00:29:47.086Z","0.5.7":"2014-02-01T17:41:37.626Z","0.5.8":"2014-02-01T21:17:26.383Z","0.5.9":"2014-02-02T11:54:34.411Z","0.6.0":"2014-02-02T17:19:01.871Z","0.6.2":"2014-02-11T10:30:56.955Z","0.6.3":"2014-03-05T15:43:08.234Z","0.6.4":"2014-03-06T17:12:01.741Z","0.6.5":"2014-03-06T20:21:48.175Z","0.6.6":"2014-03-06T20:29:52.640Z","0.6.7":"2014-03-06T22:28:25.989Z","0.6.8":"2014-03-07T23:05:31.535Z","0.6.9":"2014-03-11T21:09:24.017Z","0.6.10":"2014-03-12T01:02:26.370Z","0.6.11":"2014-03-12T22:04:24.359Z","0.7.0":"2014-04-15T22:01:14.822Z","0.7.1":"2014-04-15T23:07:02.363Z","0.7.2":"2014-04-15T23:38:27.130Z","0.7.3":"2014-04-16T21:41:11.770Z","0.7.4":"2014-04-16T21:52:49.141Z","0.7.5":"2014-04-16T21:56:35.132Z","0.7.6":"2014-04-16T23:16:38.620Z","0.7.7":"2014-04-16T23:22:47.948Z","0.7.8":"2014-04-23T09:24:10.641Z","0.7.9":"2014-05-13T14:33:00.279Z","0.7.10":"2014-05-21T22:00:15.774Z","0.7.14":"2014-10-03T18:30:39.088Z","0.7.15":"2014-10-05T09:38:18.840Z","0.8.0-beta1":"2014-10-15T00:52:05.665Z","0.8.0":"2014-10-15T01:01:35.381Z","1.0.0":"2014-10-19T16:36:01.557Z","1.0.1":"2014-10-23T19:48:49.998Z","1.0.2":"2014-11-24T14:33:02.382Z","1.0.3":"2014-11-28T18:37:32.446Z","1.0.4":"2014-11-29T01:37:59.521Z","1.0.5":"2014-11-29T01:59:24.660Z","1.0.6":"2015-03-03T04:23:18.069Z","1.0.7":"2015-03-06T03:15:06.216Z","1.0.8":"2015-04-01T22:58:37.798Z","1.0.9":"2015-04-01T23:15:52.296Z","1.0.10":"2015-05-21T03:35:41.608Z","1.0.11":"2015-05-21T05:09:32.312Z","1.0.12":"2015-05-25T11:33:08.520Z","1.0.13":"2015-05-31T20:10:34.094Z","1.0.14":"2015-06-01T13:10:16.824Z","1.0.15":"2015-07-05T17:34:40.012Z","1.0.16":"2015-07-05T18:07:47.885Z","1.0.17":"2015-08-15T05:19:48.223Z","1.0.18":"2015-08-26T19:36:40.100Z","1.0.19":"2015-10-05T15:50:04.742Z","1.0.20":"2015-10-05T21:08:24.088Z","1.0.22":"2015-11-24T17:58:13.476Z","1.0.23":"2015-11-24T18:06:49.426Z","1.0.24":"2015-11-27T15:30:02.206Z","1.0.25":"2015-12-07T20:50:36.282Z","1.0.26":"2016-01-06T16:00:02.338Z","1.0.27":"2016-01-07T14:20:38.279Z","1.0.28":"2016-02-10T21:58:14.425Z","1.0.29":"2016-04-04T17:57:05.648Z","1.0.30":"2016-04-28T21:59:01.317Z","1.1.0":"2016-05-02T06:19:36.659Z","1.1.1":"2016-05-02T07:14:08.076Z","1.1.2":"2016-06-29T20:35:48.184Z","1.1.3":"2016-07-05T21:13:46.922Z","1.1.4":"2016-07-18T21:01:12.910Z","1.1.5":"2016-08-07T07:32:16.155Z","1.1.6":"2016-08-07T17:05:18.669Z","1.1.7":"2016-08-11T01:41:15.752Z","1.1.8":"2016-08-18T01:54:04.250Z","1.2.0":"2016-08-28T06:01:13.488Z","1.2.1":"2016-08-29T02:15:51.681Z","1.2.2":"2016-08-29T02:45:14.319Z","1.2.3":"2016-09-20T22:35:37.749Z","1.2.4":"2016-09-20T23:02:16.442Z","1.2.5":"2017-01-27T22:22:15.006Z","1.2.6":"2017-01-29T12:29:05.529Z"},"users":{"trusktr":true,"southern":true,"djk":true,"abdul":true,"tarkeshwar":true,"kmiddlesworth":true,"alexu84":true,"itskdk":true,"shanewholloway":true}}}