{"name":"katar-worker-http","version":"0.0.2","description":"HTTP Server for interacting with polling katar workers","main":"index.js","scripts":{"test":"mocha --bail --harmony --timeout 5000"},"repository":"https://github.com/jksdua/katar-worker-http","keywords":["queue","katar","worker","http"],"license":"MIT","homepage":"https://github.com/jksdua/katar-worker-http","devDependencies":{"request":"~2.34.0","chai":"~1.9.0","mocha":"~1.18.0","co":"~3.0.5"},"dependencies":{"koa-framework":"~1.0.0","katar":"~0.0.1"},"versions":[{"number":"0.0.1","date":"2014-04-16T10:08:02.959Z"},{"number":"0.0.2","date":"2014-04-16T10:14:26.997Z"}],"readme":"Katar HTTP Polling Workers\r\n==========================\r\n\r\nCreates a HTTP server that binds to a katar server and listens for incoming workers to:\r\n- Distribute tasks to workers\r\n- Update tasks on the queue\r\n\r\nThe worker does not need to be written in node.js. It can be written in any language and on any platform that is able to do HTTP requests.\r\n\r\n\r\n\r\nUsage\r\n-----\r\n\r\n```js\r\n// create a katar queue server with default configuration\r\nvar katar = require('katar')();\r\n// create a dummy queue that deletes tasks when they are done\r\nvar queue = katar.queue('queue', { persistent: false });\r\n\r\n// create a server that workers can poll to fetch tasks\r\nvar workerServer = require('http-queue-worker')({\r\n\tkatar: katar, // required\r\n\tport: 3000, // required\r\n\thost: host // optional\r\n});\r\n\r\n// let the workers know:\r\n// - they should poll for tasks in this queue every 1000 milliseconds\r\n// - the custom configuration required to execute tasks\r\nworkerServer.config(queue, { interval: 1000, custom: 'config' });\r\n```\r\n\r\n\r\n\r\nAuthentication\r\n--------------\r\n\r\nAuthentication is not supported currently. This is a big security risk if workers are not in an isolated network segment. This will be fixed in a future release.\r\n\r\n\r\n\r\nRoutes\r\n------\r\n\r\n### Get configuration ###\r\n\r\n#### Request\r\n\r\n```\r\nGET /v1/queue/:queue\r\n```\r\n\r\n#### Response\r\n\r\nA json payload is returned that contains the interval at which the worker should poll the server and any other custom application level configuration.\r\n\r\n```js\r\n{\r\n\tconfiguration: {\r\n\t\t// 10 seconds, specified in milliseconds\r\n\t\tinterval: 10000,\r\n\t\tsome: 'other',\r\n\t\tdata: { can: { go: 'here' } },\r\n\t}\r\n}\r\n```\r\n\r\n\r\n### Poll for next queued task\r\n\r\n#### Request\r\n\r\n```\r\nPOST /v1/queue/:queue\r\n\r\n{}\r\n```\r\n\r\n#### Response\r\n\r\nThe server sends a `204 No Content` status code if there are no more tasks to execute\r\n\r\nOtherwise, the server will send a JSON payload with a `200 OK` status code. The returned response is an array of tasks that have been assigned to the worker. Currently, only one task at a time is supported due to a limitation in katar.\r\n\r\n```\r\n{\r\n\ttasks: [{ _id: 1, data: 'data' }]\r\n}\r\n```\r\n\r\n\r\n### Mark task/tasks as done\r\n\r\nThe exact same route can be used to specify when a task has been completed. Upon receiving the request, the server will issue a new task or return `204 No Content`.\r\n\r\n#### Request\r\n\r\n```\r\nPOST /v1/queue/:queue\r\n\r\n{\r\n\ttasks: [\r\n\t { _id: 'abc', status: 'done' },\r\n\t { _id: 'def', status: 'failed', error: 'some error' }\r\n\t]\r\n}\r\n```\r\n\r\n#### Response\r\n\r\nThe server sends a `204 No Content` status code if there are no more tasks to execute\r\n\r\nOtherwise, the server will send a JSON payload with a `200 OK` status code and a list of tasks. See [Poll for next queued task](#poll-for-next-queued-task) above for a description of the response.\r\n\r\n\r\nConfiguration\r\n-------------\r\n\r\nApplication specific configuration can be sent to workers for each of the queues. Any arbitrary configuration setting hash can be set based on the requirements of the application.\r\n\r\n### Polling interval\r\n\r\nThe only required configuration setting is `interval` which lets the workers know how often they should poll the server. By default, a 30 second interval is specified.\r\n\r\n### Example\r\n\r\n```js\r\n// create a katar queue server with default configuration\r\nvar katar = require('katar')();\r\n// create a dummy queue\r\nvar queue = katar.queue('queue', { persistent: false });\r\n\r\n// create a server that workers can poll to fetch tasks\r\nvar workerServer = require('http-queue-worker')({\r\n\tkatar: katar, // required\r\n\tport: 3000, // required\r\n\thost: host // optional\r\n});\r\n\r\n// queue configuration settings\r\nworkerServer.config(queue, {\r\n\tinterval: 1000,\r\n\tcustom: 'config',\r\n\tsome: {\r\n\t\tmore: 'config'\r\n\t},\r\n\tdate: new Date()\r\n});\r\n```\r\n\r\n\r\nClients\r\n-------\r\n\r\nClients that interact with the server can be written in any language. Simply call a `GET` method to get the queue configuration, then send `POST` requests to fetch new tasks or mark tasks as done/failed.\r\n\r\n\r\n\r\nChangelog\r\n---------\r\n\r\n### v0.0.1 - Alpha\r\n- Initial commit","created":"2014-04-16T10:08:02.959Z","modified":"2014-04-16T10:14:26.997Z","lastPublisher":{"name":"jksdua","email":"jksdua@gmail.com"},"owners":[{"name":"jksdua","email":"jksdua@gmail.com"}],"other":{"_attachments":{},"_from":".","_id":"katar-worker-http","_npmUser":{"name":"jksdua","email":"jksdua@gmail.com"},"_npmVersion":"1.3.25","_rev":"1-c3cc9b4ab074baf842276abe785054b0","author":{"name":"Jaap Karan Singh"},"bugs":{"url":"https://github.com/jksdua/katar-worker-http/issues"},"directories":{},"dist-tags":{"latest":"0.0.2"},"dist":{"shasum":"9b44de69fd011728f26a2b8b8169d267891dd50b","tarball":"http://registry.npmjs.org/katar-worker-http/-/katar-worker-http-0.0.2.tgz"},"maintainers":[{"name":"jksdua","email":"jksdua@gmail.com"}],"readmeFilename":"readme.md","time":{"modified":"2014-04-16T10:14:26.997Z","created":"2014-04-16T10:08:02.959Z","0.0.1":"2014-04-16T10:08:02.959Z","0.0.2":"2014-04-16T10:14:26.997Z"}}}