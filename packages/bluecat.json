{"name":"bluecat","version":"1.1.5","description":"Library for building RESTful API HTTP requests, best for generic RESTful API Test Framework","repository":"https://github.com/chenchaoyi/bluecat","license":"MIT","bin":{"bluecat":"./bin/bluecat.bin.js"},"engines":{"node":">=0.10.21"},"keywords":["testing","api","REST","bdd","bluecat"],"dependencies":{"columnify":"^1.5.4","fibers":"^1.0.15","hoek":"^2.16.3","inquirer":"^3.0.6","path":"^0.12.7","promise":"^7.1.1","request":"2.81.0","yargs":"^7.1.0"},"scripts":{"test":"mocha test/"},"devDependencies":{"chai":"^3.4.1","mocha":"^3.2.0","grunt-cli":"^1.2.0","grunt":"^1.0.1","grunt-contrib-jshint":"^1.1.0","grunt-jscs":"^3.0.1"},"gitHead":"35272cff701f2de4df70ca3f925e50623dfd62ce","homepage":"https://github.com/chenchaoyi/bluecat#readme","versions":[{"number":"0.0.1","date":"2014-03-28T17:15:00.395Z"},{"number":"0.0.2","date":"2014-03-28T17:58:06.769Z"},{"number":"0.0.4","date":"2014-03-31T21:49:43.263Z"},{"number":"0.0.5","date":"2014-03-31T22:41:45.252Z"},{"number":"0.0.6","date":"2014-04-15T21:44:39.459Z"},{"number":"0.0.7","date":"2014-04-22T21:04:03.051Z"},{"number":"0.0.8","date":"2014-04-23T18:29:27.752Z"},{"number":"0.0.9","date":"2014-06-04T19:10:20.550Z"},{"number":"0.1.0","date":"2014-06-04T23:15:02.068Z"},{"number":"0.1.1","date":"2014-07-10T18:06:54.092Z"},{"number":"0.1.2","date":"2014-08-07T22:18:26.982Z"},{"number":"0.1.3","date":"2014-08-11T22:56:40.705Z"},{"number":"0.1.4","date":"2014-08-11T23:22:01.229Z"},{"number":"0.1.5","date":"2014-08-21T21:52:18.161Z"},{"number":"0.1.6","date":"2014-11-05T22:11:14.103Z"},{"number":"0.1.7","date":"2014-12-02T00:02:53.304Z"},{"number":"0.1.8","date":"2014-12-02T00:57:31.241Z"},{"number":"0.1.9","date":"2014-12-04T19:08:21.848Z"},{"number":"0.2.0","date":"2015-01-03T00:07:30.085Z"},{"number":"0.2.1","date":"2015-01-03T00:43:23.879Z"},{"number":"0.2.2","date":"2015-01-03T00:48:12.195Z"},{"number":"0.2.3","date":"2015-03-09T18:22:22.646Z"},{"number":"0.2.4","date":"2015-03-09T23:06:38.360Z"},{"number":"0.2.5","date":"2015-03-10T07:09:28.328Z"},{"number":"0.2.6","date":"2015-03-26T18:49:34.827Z"},{"number":"0.2.7","date":"2015-03-26T20:08:03.217Z"},{"number":"0.2.8","date":"2015-03-28T07:11:48.856Z"},{"number":"0.2.9","date":"2015-03-30T18:29:32.788Z"},{"number":"0.3.0","date":"2015-05-07T23:19:30.438Z"},{"number":"0.3.1","date":"2015-05-11T23:30:03.988Z"},{"number":"0.3.2","date":"2015-05-14T19:05:52.698Z"},{"number":"0.3.3","date":"2015-05-21T22:42:27.302Z"},{"number":"0.3.4","date":"2015-12-04T22:16:10.964Z"},{"number":"0.3.5","date":"2015-12-09T23:35:25.370Z"},{"number":"0.3.6","date":"2015-12-13T07:10:42.574Z"},{"number":"0.3.7","date":"2015-12-15T23:11:28.458Z"},{"number":"0.3.8","date":"2015-12-15T23:53:43.730Z"},{"number":"0.3.9","date":"2015-12-16T07:30:05.162Z"},{"number":"1.0.0","date":"2015-12-27T07:31:28.616Z"},{"number":"1.0.1","date":"2015-12-28T07:44:00.058Z"},{"number":"1.0.2","date":"2016-01-11T23:35:21.415Z"},{"number":"1.0.3","date":"2016-01-19T23:08:20.530Z"},{"number":"1.0.4","date":"2016-03-21T18:13:13.512Z"},{"number":"1.0.5","date":"2016-03-21T18:26:29.938Z"},{"number":"1.0.6","date":"2016-04-16T20:36:16.920Z"},{"number":"1.0.7","date":"2016-04-30T15:14:57.747Z"},{"number":"1.0.8","date":"2016-05-21T15:20:23.734Z"},{"number":"1.0.9","date":"2016-09-22T19:14:42.389Z"},{"number":"1.1.0","date":"2016-11-20T08:15:21.794Z"},{"number":"1.1.1","date":"2016-12-26T07:05:10.482Z"},{"number":"1.1.2","date":"2016-12-29T06:20:58.948Z"},{"number":"1.1.3","date":"2017-02-10T05:56:04.422Z"},{"number":"1.1.4","date":"2017-03-13T22:11:05.445Z"},{"number":"1.1.5","date":"2017-04-19T00:06:56.945Z"}],"readme":"## Bluecat  <img src=\"https://raw.github.com/chenchaoyi/bluecat/master/images/bluecat.png\" align=\"middle\" />\n\n\n[![NPM version][npm-image]][npm-url]\n[![Build Status](https://travis-ci.org/chenchaoyi/bluecat.svg?branch=master)](https://travis-ci.org/chenchaoyi/bluecat)\n[![Dependency Status][david-image]][david-url]\n[![Downloads][downloads-image]][downloads-url]\n<!-- [![Gitter](https://badges.gitter.im/chenchaoyi/bluecat.svg)](https://gitter.im/chenchaoyi/bluecat?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge)-->\n<!-- [![Gittip][gittip-image]][gittip-url] -->\n\n**Bluecat** is a library that helps to easily create HTTP requests and maintain session information underlayer.\n\nIt could be integrated with any Node.js test framework and assertion library to create a clear and straighforward **Web services API testing framework**.\n\n* Define your APIs in a JSON file, **Bluecat** automatically creates all the methods for you\n* Callbacks are removed so complex requests flow is more clear\n* Full control over the HTTP request URL query, headers and body\n* Automatically maintains session cookies information for HTTP API call flows\n* [Convenience methods](#usage) that help to handle more complex scenario\n* The `bluecat` command line interface comes with a nice configuration utility that helps you to create your test framework in less than a minute.\n\n## Table of contents\n\n- [Installation](#installation)\n- [Examples](#example)\n  - [Regular RESTful API](#regular-restful-api)\n  - [Control query and/or headers in request](#control-query-andor-headers-in-request)\n  - [RESTful API with characters that cannot be used with dot notation in the URL](#restful-api-with-characters-that-cannot-be-used-with-dot-notation-in-the-url)\n  - [RESTful API with parameters in the URL](#restful-api-with-parameters-in-the-url)\n  - [Full example](#full-example-of-test-structure-using-bluecat)\n- [Usage](#usage)\n- [Command line tool](#command-line-tool)\n- [Logging](#logging)\n- [License](#license)\n\n---\n\n## Installation ##\n```bash\n$ npm install bluecat\n```\n\n---\n\n## Example ##\n\n#### Regular RESTful API\n```\nPOST /checkout/contract\nGET  /checkout/contract\n```\n\n* First define your API in config/api.json, following the exact URL path structure:\n\n```\n{\n  \"api\": {\n    \"checkout\": {\n      \"contract\": {\n        \"schema\": \"http\",\n        \"method\": [\"GET\", \"POST\"]\n      }\n    }\n  }\n}\n```\n\n* Then create a Bluecat service object. You are all set to send request and validate response:\n\n```javascript\nvar expect = require('chai').expect;\nvar Bluecat = require('bluecat');\nvar Service = new Bluecat.ServiceSync(Bluecat.Api('api'), 'sample-host.com');\n\n// All requests need to be put as callback function in Service.run(), so they will run synchronously\nService.run(function() {\n    // send POST http://sample-host.com/checkout/contract\n    // with body: {\"cartid\": \"test-cart-id\"}\n    var r = Service.checkout.contract.POST({\n      body: {\n        cartid: 'test-cart-id'\n      }\n    });\n    // verify response\n    expect(r.data.statusCode).to.equal(200);\n    expect(r.data.body).to.have.ownProperty('id');\n\n    // send GET http://sample-host.com/checkout/contract\n    // cookies are automatically maintained if there is any\n    r = Service.checkout.contract.GET();\n    // verify response\n    expect(r.data.statusCode).to.equal(200);\n    expect(r.data.body.cartId).to.eql('test-cart-id');\n})\n\n```\n\n#### Control query and/or headers in request\n```\nPUT /search/fitness/result?start=0&limit=50&error=true\n```\n\n* First define your API in config/api.json:\n\n```\n{\n  \"api\": {\n    \"search\": {\n      \"fitness\": {\n        \"result\": {\n          \"schema\": \"https\",\n          \"method\": [\"PUT\"]\n        }\n      }\n    }\n  }\n}\n```\n\n* Then create a Bluecat service object. You are all set to send request and validate response:\n\n```javascript\nvar expect = require('chai').expect;\nvar Bluecat = require('bluecat');\nvar Service = new Bluecat.ServiceSync(Bluecat.Api('api'), 'sample-host.com');\n\n// All requests need to be put as callback function in Service.run(), so they will run synchronously\nService.run(function() {\n    // send PUT http://sample-host.com/search/fitness/result?start=0&limit=50&error=true\n    // with body: {\"term\": \"testTerm\"}\n    // and header: {\"User-agent\": \"automation\"}\n    var r = Service.search.fitness.result.PUT({\n      body: {\n        term: 'testTerm'\n      },\n      query: {\n        start: 0,\n        limit: 50,\n        error: true\n      },\n      headers: {\n        'User-agent': 'automation'\n      }\n    });\n    // verify response\n    expect(r.data.statusCode).to.equal(200);\n})\n\n```\n\n\n#### RESTful API with characters that cannot be used with [dot notation] (https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Property_Accessors) in the URL\n```\nGET  /cart/v1/add-item/item\n```\n\n* First define your API in config/api.json:\n\n```\n{\n  \"api\": {\n    \"cart\": {\n      \"v1\": {\n        \"add-item\": {\n          \"item\": {\n            \"schema\": \"http\",\n            \"method\": [\"GET\"]\n          }\n        }\n      }\n    }\n  }\n}\n```\n\n* Then create a Bluecat service object and send request:\n\n```javascript\nvar expect = require('chai').expect;\nvar Bluecat = require('bluecat');\nvar Service = new Bluecat.ServiceSync(Bluecat.Api('api'), 'sample-host.com');\n\n// All requests need to be put as callback function in Service.run(), so they will run synchronously\nService.run(function() {\n    // send GET http://sample-host.com/cart/v1/add-item/item\n    // we cannot use 'r = Service.cart.v1.add-item.item.GET()' because 'add-item' cannot be used\n    // as dot notation property accessor, we need to use bracket notation in such case\n    r = Service.cart.v1['add-item'].item.GET();\n    // verify response\n    expect(r.data.statusCode).to.equal(200);\n})\n\n```\n\n#### RESTful API with parameters in the URL\n```\nGET /checkout/${uuid}/contract\n```\n* First define your API in config/api.json:\n\n```\n{\n  \"api\": {\n    \"checkout\": {\n      \"${uuid}\": {\n        \"contract\": {\n          \"schema\": \"http\",\n          \"method\": [\"GET\"]\n        }\n      }\n    }\n  }\n}\n```\n\n* Then create a Bluecat service object. You are all set to send request and validate response:\n\n```javascript\nvar expect = require('chai').expect;\nvar Bluecat = require('bluecat');\nvar Service = new Bluecat.ServiceSync(Bluecat.Api('api'), 'sample-host.com');\n\n// All requests are needed to be put as callback function in Service.run(), so they will run synchronously\nService.run(function() {\n    // send GET http://sample-host.com/checkout/5e586387-6d5a-4874-8a98-5836bdc45c7b/contract\n    var r = Service.checkout['${uuid}'].contract.GET({\n      params: {\n        uuid: '5e586387-6d5a-4874-8a98-5836bdc45c7b'\n      }\n    });\n    // verify response\n    expect(r.data.statusCode).to.equal(200);\n})\n```\n\n#### Full example of test structure using Bluecat\n\n[Example](https://github.com/chenchaoyi/bluecat/tree/master/examples)\n\n\n---\n\n## Usage ##\n<!--Usage is a two steps process. First, define the API structure in config/api.json:-->\n\n#### `Bluecat.ServiceSync(api, host, options)`\nCreate a new bluecat service object, with desired [options](https://github.com/request/request/blob/master/README.md#requestoptions-callback).\n```javascript\nvar Bluecat = require('bluecat');\nvar Api = Bluecat.Api('mobileapi');\nvar Service = new Bluecat.ServiceSync(Api, 'api.mobile.walmart.com', {\n  gzip: true\n});\n```\n\n#### `rawRequest(options)`\nSometimes we just want to send a request to some host, which is different than the API host we gave to the bluecat service object. You can use `rawRequest(options)` to send it.\n\n```javascript\nvar Bluecat = require('bluecat');\nvar Api = Bluecat.Api('mobileapi');\nvar Service = new Bluecat.ServiceSync(Api, 'api.mobile.walmart.com');\n\nvar r = Service.rawRequest({\n  method: 'GET',\n  json: true,\n  uri: 'https://thirdparty-host/creditcard/encryption.js',\n  headers: {'accept-encoding': 'gzip'},\n});\nexpect(r.err).to.equal(null);\nexpect(r.data.statusCode).to.equal(200);\n```\n\n#### `setProxy(proxy)`\nSet proxy address, all the requests will be sent via a connection to the proxy server.\n```javascript\nvar Bluecat = require('bluecat');\nvar Api = Bluecat.Api('mobileapi');\nvar Service = new Bluecat.ServiceSync(Api, 'api.mobile.walmart.com');\n\nService.setProxy('http://127.0.0.1:8888')\n```\n\n#### `resetCookie()`\nClean up cookie jar, so the next request won't set any cookies in the header.\n\n```javascript\nvar Bluecat = require('bluecat');\nvar Api = Bluecat.Api('mobileapi');\nvar Service = new Bluecat.ServiceSync(Api, 'api.mobile.walmart.com');\n\nService.v1.products.search.GET();\nService.resetCookie();\nService.v1.cart.POST({\n  body: {\n    location: '94066'\n  }\n})\n```\n\n#### `setHeaders(headers)`\nSet headers that will be sent in all the requests.\n\n```javascript\nvar Bluecat = require('bluecat');\nvar Api = Bluecat.Api('mobileapi');\nvar Service = new Bluecat.ServiceSync(Api, 'api.mobile.walmart.com');\n\nService.setHeaders({'User-Agent': 'Automation'});\n```\n\n#### `setSessionRules(rules)`\nSet extra session rules other than cookie. Some RESTful APIs defines their own session rules, you can set such rules to the bluecat service object, so you don't have to deal with it before sending every single HTTP request.\n\n```javascript\nvar Bluecat = require('bluecat');\nvar Api = Bluecat.Api('mobileapi');\nvar Service = new Bluecat.ServiceSync(Api, 'api.mobile.walmart.com');\n\n// The following sessions rules start with value 'start-auth-token-value' in the request header AUTH_TOKEN,\n// then grab new value from response header REFRESH_AUTH_TOKEN\n// and put it in the next request header AUTH_TOKEN\nService.setSessionRules({\n  requestHeader: 'AUTH_TOKEN',\n  responseHeader: 'REFRESH_AUTH_TOKEN',\n  startSessionHeader: 'start-auth-token-value'\n});\n```\n\n#### `sleep(ms)`\nSleep for `ms` milliseconds.\n\n```javascript\nvar Bluecat = require('bluecat');\nvar Api = Bluecat.Api('mobileapi');\nvar Service = new Bluecat.ServiceSync(Api, 'api.mobile.walmart.com');\n// Sleep for 5 seconds\nService.sleep(5000);\n```\n\n\n---\n\n## Command line tool ##\nBluecat comes with `bluecat` command line interface that helps you to create a basic Web services API test framework and check defined APIs.\n\n#### Create basic Web services API test structure:\n\n```bash\n$ npm install bluecat\n$ ./node_modules/.bin/bluecat config\n```\nFollow the instructions and it will create a scaffold of a basic web services API test framework for you.\n\n#### Check currently defined Web services APIs:\n\n```bash\n$ ./node_modules/.bin/bluecat api\n```\nIt will print out all the current defined Web services APIs that could be called from test case.\n\n---\n\n## Logging\n\n* Launch the node process like `BLUECAT_DEBUG_FILE=/path/to/bluecat.log node script.js` to keep a log file of all the requests/responses information.\n\n* Launch the node process like `BLUECAT_DEBUG_CONSOLE=true node script.js` to see all the requests/responses information from your console (stdout).\n\n---\n\n## License\nLicensed under the [MIT](http://opensource.org/licenses/MIT)\n\n[npm-image]: https://img.shields.io/npm/v/bluecat.svg?style=flat-square\n[npm-url]: https://www.npmjs.org/package/bluecat\n[github-tag]: http://img.shields.io/github/tag/chenchaoyi/bluecat.svg?style=flat-square\n[github-url]: https://github.com/chenchaoyi/bluecat/tags\n[david-image]: http://img.shields.io/david/chenchaoyi/bluecat.svg?style=flat-square\n[david-url]: https://david-dm.org/chenchaoyi/bluecat\n[license-image]: http://img.shields.io/npm/l/bluecat.svg?style=flat-square\n[license-url]: http://opensource.org/licenses/MIT\n[downloads-image]: http://img.shields.io/npm/dm/bluecat.svg?style=flat-square\n[downloads-url]: https://npmjs.org/package/bluecat\n[gittip-image]: https://img.shields.io/gittip/chenchaoyi.svg?style=flat-square\n[gittip-url]: https://www.gittip.com/chenchaoyi/\n","starsCount":1,"created":"2014-03-28T17:15:00.395Z","modified":"2017-04-19T00:06:56.945Z","lastPublisher":{"name":"chaoyi.chen","email":"ccy.chenchaoyi@gmail.com"},"owners":[{"name":"chaoyi.chen","email":"ccy.chenchaoyi@gmail.com"}],"other":{"_attachments":{},"_from":".","_id":"bluecat","_nodeVersion":"6.10.1","_npmOperationalInternal":{"host":"packages-12-west.internal.npmjs.com","tmp":"tmp/bluecat-1.1.5.tgz_1492560416720_0.20835503516718745"},"_npmUser":{"name":"chaoyi.chen","email":"ccy.chenchaoyi@gmail.com"},"_npmVersion":"3.10.10","_rev":"7-3f4f8d28e2745ad5848d615c04eba1fd","_shasum":"7aaedf1c16a1496d37edf8842a382bcd1fc163ce","author":{"name":"Chaoyi Chen","email":"ccy.chenchaoyi@gmail.com"},"bugs":{"url":"https://github.com/chenchaoyi/bluecat/issues"},"directories":{},"dist-tags":{"latest":"1.1.5"},"dist":{"shasum":"7aaedf1c16a1496d37edf8842a382bcd1fc163ce","tarball":"https://registry.npmjs.org/bluecat/-/bluecat-1.1.5.tgz"},"maintainers":[{"name":"chaoyi.chen","email":"ccy.chenchaoyi@gmail.com"}],"readmeFilename":"README.md","time":{"modified":"2017-04-19T00:06:56.945Z","created":"2014-03-28T17:15:00.395Z","0.0.1":"2014-03-28T17:15:00.395Z","0.0.2":"2014-03-28T17:58:06.769Z","0.0.4":"2014-03-31T21:49:43.263Z","0.0.5":"2014-03-31T22:41:45.252Z","0.0.6":"2014-04-15T21:44:39.459Z","0.0.7":"2014-04-22T21:04:03.051Z","0.0.8":"2014-04-23T18:29:27.752Z","0.0.9":"2014-06-04T19:10:20.550Z","0.1.0":"2014-06-04T23:15:02.068Z","0.1.1":"2014-07-10T18:06:54.092Z","0.1.2":"2014-08-07T22:18:26.982Z","0.1.3":"2014-08-11T22:56:40.705Z","0.1.4":"2014-08-11T23:22:01.229Z","0.1.5":"2014-08-21T21:52:18.161Z","0.1.6":"2014-11-05T22:11:14.103Z","0.1.7":"2014-12-02T00:02:53.304Z","0.1.8":"2014-12-02T00:57:31.241Z","0.1.9":"2014-12-04T19:08:21.848Z","0.2.0":"2015-01-03T00:07:30.085Z","0.2.1":"2015-01-03T00:43:23.879Z","0.2.2":"2015-01-03T00:48:12.195Z","0.2.3":"2015-03-09T18:22:22.646Z","0.2.4":"2015-03-09T23:06:38.360Z","0.2.5":"2015-03-10T07:09:28.328Z","0.2.6":"2015-03-26T18:49:34.827Z","0.2.7":"2015-03-26T20:08:03.217Z","0.2.8":"2015-03-28T07:11:48.856Z","0.2.9":"2015-03-30T18:29:32.788Z","0.3.0":"2015-05-07T23:19:30.438Z","0.3.1":"2015-05-11T23:30:03.988Z","0.3.2":"2015-05-14T19:05:52.698Z","0.3.3":"2015-05-21T22:42:27.302Z","0.3.4":"2015-12-04T22:16:10.964Z","0.3.5":"2015-12-09T23:35:25.370Z","0.3.6":"2015-12-13T07:10:42.574Z","0.3.7":"2015-12-15T23:11:28.458Z","0.3.8":"2015-12-15T23:53:43.730Z","0.3.9":"2015-12-16T07:30:05.162Z","1.0.0":"2015-12-27T07:31:28.616Z","1.0.1":"2015-12-28T07:44:00.058Z","1.0.2":"2016-01-11T23:35:21.415Z","1.0.3":"2016-01-19T23:08:20.530Z","1.0.4":"2016-03-21T18:13:13.512Z","1.0.5":"2016-03-21T18:26:29.938Z","1.0.6":"2016-04-16T20:36:16.920Z","1.0.7":"2016-04-30T15:14:57.747Z","1.0.8":"2016-05-21T15:20:23.734Z","1.0.9":"2016-09-22T19:14:42.389Z","1.1.0":"2016-11-20T08:15:21.794Z","1.1.1":"2016-12-26T07:05:10.482Z","1.1.2":"2016-12-29T06:20:58.948Z","1.1.3":"2017-02-10T05:56:04.422Z","1.1.4":"2017-03-13T22:11:05.445Z","1.1.5":"2017-04-19T00:06:56.945Z"},"users":{"chaoyi.chen":true}}}