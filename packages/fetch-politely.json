{"name":"fetch-politely","version":"1.1.0","description":"Ensures polite outgoing HTTP requests that respects robots.txt and aren't made too close to each other","homepage":"http://github.com/voxpelli/node-fetch-politely","repository":"https://github.com/voxpelli/node-fetch-politely","license":"MIT","dependencies":{"bunyan-adaptor":"^1.1.0","lodash.isequal":"^4.4.0","lodash.pull":"^4.1.0","lru-cache":"^4.0.0","request":"^2.51.0","robots":"^0.9.4","verror":"^1.6.0"},"engines":{"node":">=4.0.0"},"main":"./lib/main.js","scripts":{"dependency-check":"JS_FILES=\"example/*.js lib/*.js\" && dependency-check . $JS_FILES && dependency-check . $JS_FILES --unused --no-dev","test":"eslint . && npm run dependency-check","prepush":"npm test"},"devDependencies":{"dependency-check":"^2.5.2","eslint":"^3.4.0","eslint-config-semistandard":"^7.0.0","eslint-config-standard":"^6.0.0","eslint-plugin-promise":"^3.0.0","eslint-plugin-standard":"^2.0.0","husky":"~0.11.4"},"gitHead":"55ee8e9ca16e42454f98482ce09c9a765099e1ea","versions":[{"number":"0.1.0","date":"2015-01-16T22:53:12.089Z"},{"number":"0.2.0","date":"2015-03-28T21:47:05.116Z"},{"number":"0.3.0","date":"2015-04-01T13:51:08.382Z"},{"number":"0.3.1","date":"2015-04-01T13:55:08.947Z"},{"number":"0.4.0","date":"2015-04-07T19:23:51.212Z"},{"number":"0.5.0","date":"2015-04-08T08:34:38.935Z"},{"number":"0.6.0","date":"2015-04-10T08:34:55.375Z"},{"number":"0.6.2","date":"2015-04-16T09:31:48.433Z"},{"number":"0.7.0","date":"2015-04-21T10:13:44.839Z"},{"number":"1.0.0","date":"2016-11-04T11:21:55.175Z"},{"number":"1.0.1","date":"2016-11-04T11:38:48.612Z"},{"number":"1.1.0","date":"2016-11-04T19:37:36.367Z"}],"readme":"# Fetch Politely\n\n[![Build Status](https://travis-ci.org/voxpelli/node-fetch-politely.svg?branch=master)](https://travis-ci.org/voxpelli/node-fetch-politely)\n[![Dependency Status](https://gemnasium.com/voxpelli/node-fetch-politely.svg)](https://gemnasium.com/voxpelli/node-fetch-politely)\n[![js-semistandard-style](https://img.shields.io/badge/code%20style-semistandard-brightgreen.svg?style=flat)](https://github.com/Flet/semistandard)\n\nA library for ensuring polite outgoing HTTP requests that respect robots.txt and aren't made too close to each other\n\n## Installation\n\n```bash\nnpm install fetch-politely --save\n```\n\n## Usage\n\nSimple:\n\n```javascript\nvar fetchInstance = new FetchPolitely(function (err, url, message) {\n  if (err) { return; }\n\n  // The URL has been cleared for fetching – the hostname isn't throttled and robots.txt doesn't ban it\n}, {\n  // Robots.txt checking requires specification of a User Agent as Robots.txt can contain User Agent specific rules\n  // See http://en.wikipedia.org/wiki/User_agent for more info in format\n  userAgent: 'Your-Application-Name/your.app.version (http://example.com/optional/full/app/url)',\n});\n\n// When a slot has been reserved the callback sent in the constructor will be called\nfetchInstance.requestSlot('http://foo.example.org/interesting/content/');\n```\n\n## FetchPolitely()\n\n`var fetchInstance = new FetchPolitely(callback, [options]);`\n\n### Parameters\n\n* **callback** – `function (err, url, message, [content]) {};`, called for each succesful request slot\n\n### Options\n\n* **throttleDuration** – for how long in milliseconds to throttle requests to each `hostname`. Defaults to `10` seconds.\n* **returnContent** – whether to fetch and return the content with the callback when a URL has received a request slot. Defaults to `false`.\n* **logger** – a [Bunyan](https://github.com/trentm/node-bunyan) compatible logger library. Defaults to [bunyan-duckling](https://github.com/bloglovin/node-bunyan-duckling) which uses `console.log()`/`.error()`.\n* **lookup** – an object or class that keeps track of throttled hosts and queued URL:s. Defaults to `PoliteLookup`.\n* **lookupOptions** – an object that defines extra lookup options.\n* **allowed** – a function that checks whether a URL is allowed to be fetched. Defaults to `PoliteRobot.allowed()`.\n* **robotCache** – a cache method used by `PoliteRobot` to cache fetched `robots.txt`. Defaults to wrapped [lru-cache](https://www.npmjs.com/package/lru-cache).\n* **robotCacheLimit** – a limit of the number of items to keep in the default lru-cache of `PoliteRobot`.\n* **robotPool** – an HTTP agent to use for the request-library of `PoliteRobot`.\n* **userAgent** – _required_ by `PoliteRobot` and `options.returnContent`. The [User Agent](http://en.wikipedia.org/wiki/User_agent) to use for HTTP requests.\n\n### Methods\n\n* **requestSlot** – tries to reserve a request slot for a URL.\n\n### Static\n\n* **FetchPolitely.PoliteError** – a very polite error object used for eg. informing about denied URL:s\n* **FetchPolitely.PoliteLookup** – defines the interface for keeping track of throttled hosts and queued URL:s\n* **FetchPolitely.PolitePGLookup** – alternative lookup that uses PostgreSQL as the backend\n* **FetchPolitely.PoliteRobot** – checks whether URL:s are allowed to be fetched according to [Robots.txt](http://en.wikipedia.org/wiki/Robots_exclusion_standard).\n\n## fetchInstance.requestSlot()\n\n`fetchInstance.requestSlot(url, [message], [options]);`\n\n### Parameters\n\n* **url** – the URL to reserve a request slot for\n* **message** – a JSON-encodeable optional message containing eg. instructions for the `FetchPolitely` callback.\n\n### Options\n\n* **allow** – if set to `true` the URL will always be allowd and not be sent to the `allowed` function.\n* **allowDuplicates** – if set to `false` no more than one item of every `url` + `message` combination will be queued.\n\n## PoliteLookup\n\nThe simplest of simple implementations for keeping track of throttled hosts and queued URL:s. Handles it all in-memory. Same interface can be used to build a database backend for this though.\n\n## PolitePGLookup\n\nA PostgreSQL + [Knex](http://knexjs.org/)-driven lookup that throttles hosts and queues URL using database tables.\n\nUse by setting up the tables in `pglookup.sql` and include by setting the `FetchPolitely` options to:\n\n```javascript\n{\n  lookup: FetchPolitely.PolitePGLookup,\n  lookupOptions: {\n    knex: knexInstance\n  }\n}\n```\n\nPull Requests are welcome if someone wants to pull out the Knex-dependency. Most projects where this has been used with Postgres has been using Knex so it got used here as well.\n\n### lookupOptions\n\n* **knex** – *required* – the database connection to use, provided through a [Knex](http://knexjs.org/) object.\n* **purgeWindow** – the minimum interval in milliseconds between two host purges. Defaults to `500` ms.\n* **concurrentReleases** – how many parallell database lookups to perform to check for released URL:s. Defaults to `2`.\n* **releasesPerBatch** – how many URL:s to fetch in each database lookup. Defaults to `5`.\n* **onlyDeduplicateMessages** – bool that if set will only deduplicate URL:s with the same message when deduplicating. Defaults to `false`.\n\n## Lint / Test\n\n`npm test` or to watch, install `grunt-cli` then do `grunt watch`\n","created":"2015-01-16T22:53:12.089Z","modified":"2016-11-04T19:37:36.367Z","lastPublisher":{"name":"voxpelli","email":"pelle@kodfabrik.se"},"owners":[{"name":"voxpelli","email":"pelle@kodfabrik.se"}],"other":{"_attachments":{},"_from":".","_id":"fetch-politely","_nodeVersion":"6.9.1","_npmOperationalInternal":{"host":"packages-18-east.internal.npmjs.com","tmp":"tmp/fetch-politely-1.1.0.tgz_1478288255842_0.7656893355306238"},"_npmUser":{"name":"voxpelli","email":"pelle@kodfabrik.se"},"_npmVersion":"3.10.8","_rev":"4-d5703bd06e3108e43eb2f7927ce40fae","_shasum":"857ed1c594108061b30eb21611ff754d24dc98ac","author":{"name":"Pelle Wessman","email":"pelle@kodfabrik.se","url":"http://kodfabrik.se/"},"bugs":{"url":"https://github.com/voxpelli/node-fetch-politely/issues"},"directories":{"example":"./example","lib":"./lib"},"dist-tags":{"latest":"1.1.0"},"dist":{"shasum":"857ed1c594108061b30eb21611ff754d24dc98ac","tarball":"http://registry.npmjs.org/fetch-politely/-/fetch-politely-1.1.0.tgz"},"maintainers":[{"name":"voxpelli","email":"pelle@kodfabrik.se"}],"readmeFilename":"README.md","time":{"modified":"2016-11-04T19:37:36.367Z","created":"2015-01-16T22:53:12.089Z","0.1.0":"2015-01-16T22:53:12.089Z","0.2.0":"2015-03-28T21:47:05.116Z","0.3.0":"2015-04-01T13:51:08.382Z","0.3.1":"2015-04-01T13:55:08.947Z","0.4.0":"2015-04-07T19:23:51.212Z","0.5.0":"2015-04-08T08:34:38.935Z","0.6.0":"2015-04-10T08:34:55.375Z","0.6.2":"2015-04-16T09:31:48.433Z","0.7.0":"2015-04-21T10:13:44.839Z","1.0.0":"2016-11-04T11:21:55.175Z","1.0.1":"2016-11-04T11:38:48.612Z","1.1.0":"2016-11-04T19:37:36.367Z"}}}