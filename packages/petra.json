{"name":"petra","version":"0.2.1","description":"ES6 reverse HTTP proxy with dogpile locking and filesystem-backed cache","scripts":{"test":"semistandard && ava","coverage":"nyc --reporter=html ava"},"main":"index.js","repository":"https://github.com/lovell/petra","keywords":["proxy","cache","dogpile"],"dependencies":{"got":"^6.7.1"},"devDependencies":{"ava":"^0.19.1","mock-fs":"^4.3.0","nock":"^9.0.13","nyc":"^10.3.2","semistandard":"^11.0.0","sinon":"^2.3.2"},"license":"Apache-2.0","engines":{"node":">=6"},"gitHead":"a20c3a30baec225a1f39bea56a8a881af7e0c9dc","homepage":"https://github.com/lovell/petra#readme","versions":[{"number":"0.0.1","date":"2015-07-16T11:05:03.967Z"},{"number":"0.0.2","date":"2015-08-26T15:47:41.666Z"},{"number":"0.0.3","date":"2016-03-22T09:31:47.277Z"},{"number":"0.0.4","date":"2016-03-24T20:03:23.207Z"},{"number":"0.0.5","date":"2016-09-11T14:22:25.079Z"},{"number":"0.1.0","date":"2016-12-14T13:24:39.736Z"},{"number":"0.1.1","date":"2016-12-14T18:09:02.078Z"},{"number":"0.1.2","date":"2016-12-18T09:57:24.798Z"},{"number":"0.2.0","date":"2017-03-05T20:34:50.267Z"},{"number":"0.2.1","date":"2017-05-27T12:59:13.187Z"}],"readme":"# petra\n\nEmbed a reverse HTTP proxy into an existing ES6 application.\n\nFeatures:\n\n- Filesystem-backed cache\n- Prevention of the thundering herd problem via a dogpile lock\n- Respects upstream Cache-Control headers\n\nDoes not yet support:\n\n- [ ] Upstream authentication\n- [ ] Caching of full response headers\n- [ ] Use of If-Modified-Since\n\n_This is alpha-quality software and is not yet ready for use in production environments._\n\n## Usage example\n\n```javascript\nimport Petra from 'petra';\nconst petra = new Petra();\npetra.fetch('http://api.upstream.com/resource', (err, filename, created, expires) => {\n  // filename is the path to the local file containing the response\n  // created is the Date when the response was originally cached\n  // expires is the Date when the response will become stale\n});\n```\n\n## API\n\n### new Petra(options)\n\nWhere `options` is an Object containing:\n\n#### cacheDirectory\n\nThe directory in which to store cached items, defaulting to `/tmp/petra`.\n\n#### hash\n\nA function to generate cache keys, defaults to SHA-256.\n\n#### minimumTtl\n\nThe minimum TTL for cached items in seconds, defaults to 7 days.\n\nThe TTL for each response will be the minimum of this value or the max age of the upstream HTTP `Cache-Control` response header.\n\n#### purgeStaleInterval\n\nThe interval in seconds between purges of stale content in the cache, defaults to 1 hour.\n\n#### mediaTypes\n\nAn array of accepted `Content-Type` upstream response headers, defaulting to the empty list and therefore allowing any.\n\n#### requestTimeout\n\nThe length of time to wait to connect to an upstream source, defaulting to 10000ms.\n\n#### responseTimeout\n\nThe length of time to wait, after connecting, for an upstream source to provide data, defaulting to 10000ms.\n\n#### retries\n\nThe number of attempts that will be made to connect to an upstream source, defaulting to none.\n\n#### userAgent\n\nThe `User-Agent` header for upstream requests, defaulting to `lovell/petra`.\n\n#### debug\n\nEnable debug to help trace peer/upstream problems, defaults to `false`.\n\n#### log\n\nThe function to call with debug messages, defaults to `console.log`.\n\n### fetch(url, callback)\n\nFetches a remote `url`, first checking with the local filesystem cache.\n\nThe `callback` function is passed `(err, filename, created, expires)` where:\n\n- `err` is the error, if any.\n- `filename` is the path to the cached file containing the response.\n- `created` is the Date when the response was originally cached.\n- `expires` is the Date when the response will become stale.\n\n### purge(url, callback)\n\nRemoves cached copy of the URL, if any, from the local filesystem only.\n\n## Licence\n\nCopyright 2015, 2016, 2017 Lovell Fuller.\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n[http://www.apache.org/licenses/LICENSE-2.0](http://www.apache.org/licenses/LICENSE-2.0.html)\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n","starsCount":1,"created":"2015-07-16T11:05:03.967Z","modified":"2017-06-05T14:27:06.825Z","lastPublisher":{"name":"lovell","email":"npm@lovell.info"},"owners":[{"name":"lovell","email":"npm@lovell.info"}],"other":{"_attachments":{},"_from":".","_id":"petra","_nodeVersion":"6.10.3","_npmOperationalInternal":{"host":"s3://npm-registry-packages","tmp":"tmp/petra-0.2.1.tgz_1495889952253_0.7126898574642837"},"_npmUser":{"name":"lovell","email":"npm@lovell.info"},"_npmVersion":"3.10.10","_rev":"7-bec3d9e79d01ea3c51607492265dec1e","_shasum":"0ebf7a43ccd861ba8b4a5a9cac6cf25594e0f937","author":{"name":"Lovell Fuller","email":"npm@lovell.info"},"bugs":{"url":"https://github.com/lovell/petra/issues"},"directories":{},"dist-tags":{"latest":"0.2.1"},"dist":{"shasum":"0ebf7a43ccd861ba8b4a5a9cac6cf25594e0f937","tarball":"https://registry.npmjs.org/petra/-/petra-0.2.1.tgz"},"maintainers":[{"name":"lovell","email":"npm@lovell.info"}],"readmeFilename":"README.md","time":{"modified":"2017-06-05T14:27:06.825Z","created":"2015-07-16T11:05:03.967Z","0.0.1":"2015-07-16T11:05:03.967Z","0.0.2":"2015-08-26T15:47:41.666Z","0.0.3":"2016-03-22T09:31:47.277Z","0.0.4":"2016-03-24T20:03:23.207Z","0.0.5":"2016-09-11T14:22:25.079Z","0.1.0":"2016-12-14T13:24:39.736Z","0.1.1":"2016-12-14T18:09:02.078Z","0.1.2":"2016-12-18T09:57:24.798Z","0.2.0":"2017-03-05T20:34:50.267Z","0.2.1":"2017-05-27T12:59:13.187Z"},"users":{"chirag8642":true}}}