{"name":"express-negotiator","description":"Express/connect middleware that does HTTP content negotiation for static files","keywords":["http","content negotiation","connect","accept","accept-language","cookie","express","localization","l10n","internationalization","i18n","locale","content-type","content type","html","static","extension","mime"],"version":"0.5.0","engines":{"node":"*"},"dependencies":{"async":"0.2.8","mario":"1.4.1","memoizeasync":"0.9.0","memoizesync":"0.5.0","mime":"1.2.7","passerror":"0.0.1","underscore":"1.3.3"},"devDependencies":{"express":"2.5.11","mocha":"1.13.0","unexpected":"1.0.1"},"main":"lib/expressNegotiator.js","scripts":{"test":"mocha -R spec","travis":"npm test"},"gitHead":"95e94a0eb40c996aafba3191d1d55b17f9fa1bc2","versions":[{"number":"0.0.1","date":"2012-11-04T22:32:52.448Z"},{"number":"0.1.0","date":"2013-01-10T13:06:56.701Z"},{"number":"0.2.0","date":"2013-04-09T11:04:19.554Z"},{"number":"0.2.1","date":"2013-04-09T12:17:32.948Z"},{"number":"0.2.2","date":"2013-04-09T12:38:03.370Z"},{"number":"0.2.3","date":"2013-04-09T12:49:52.073Z"},{"number":"0.2.4","date":"2013-04-10T13:25:34.987Z"},{"number":"0.2.5","date":"2013-05-01T11:26:28.061Z"},{"number":"0.2.6","date":"2013-05-01T12:48:59.657Z"},{"number":"0.2.7","date":"2013-06-26T06:59:09.959Z"},{"number":"0.2.8","date":"2013-07-01T09:21:27.817Z"},{"number":"0.3.0","date":"2013-07-18T11:28:03.358Z"},{"number":"0.3.1","date":"2013-08-01T15:55:23.634Z"},{"number":"0.4.0","date":"2013-09-19T10:02:10.618Z"},{"number":"0.4.1","date":"2013-09-19T12:17:39.518Z"},{"number":"0.4.2","date":"2014-04-03T06:50:23.324Z"},{"number":"0.4.3","date":"2014-04-03T07:43:22.299Z"},{"number":"0.4.4","date":"2014-04-09T09:20:00.640Z"},{"number":"0.4.5","date":"2014-05-15T13:18:37.399Z"},{"number":"0.4.6","date":"2014-05-30T08:35:53.507Z"},{"number":"0.4.7","date":"2015-05-21T08:09:14.377Z"},{"number":"0.4.8","date":"2015-12-16T16:12:48.388Z"},{"number":"0.5.0","date":"2016-04-29T09:07:39.216Z"}],"readme":"express-negotiator\n==================\n\nExpress/connect middleware for doing content negotiation with static\nfiles on disc. Heavily inspired by Apache's <a\nhref=\"http://httpd.apache.org/docs/2.2/mod/mod_negotiation.html\">mod_negotiation</a>.\n\nNegotiator rewrites `req.url` to the negotiated file name based on\nthese factors (in descending order of importance):\n\n* Whether `req.url` matches a file name on disc exactly\n* The `locale` GET parameter\n* The value of a locale cookie (optional, specified by `options.cookieName`)\n* The `Accept-Language` and `Accept` headers\n\n... and of course the availability of suitable files on disc. If no\nacceptable match is found, `req.url` is left untouched.\n\nLike `mod_negotiation`, `express-negotiator` interprets the extensions\nof the files on disc as an unordered set. A file called `foo.html.fr`\nwould be treated the same as one called `foo.fr.html` except when the\nrequest url specifies an exact match.\n\nThe negotiator middleware is intended to run right before `static`\npointed at the same directory as `options.root`.\n\nIf `options.cookieName` is specified, the `cookieParser` middleware\nmust also be in the middleware chain.\n\n\nConditional requests\n====================\n\nWhen the url is rewritten, negotiator sets the ETag header to the same\nvalue as the `static` middleware would\n(`\"<size>-<modificationTime>\"`), but with the negotiated Content-Type\nand locale id bits suffixed. This prevents false positive 304\nresponses with `If-None-Match` when the same client (or reverse proxy)\nrequests the same url later with different headers (eg. after a locale\ncookie change). That would happen if the files happened to have the\nsame size and modification times.\n\nAlso, the `If-Modified-Since` header is removed since that would cause\nthe `static` middleware to reply `304 Not Modified` in similar\nsituations. ETags are a superior concept anyway.\n\nInstallation\n============\n\nMake sure you have <a href=\"http://nodejs.org/\">node.js</a> and <a\nhref=\"http://npmjs.org/\">npm</a> installed, then run:\n\n```\n$ npm install express-negotiator\n```\n\nExample usage\n=============\n\n```javascript\nvar express = require('express'),\n    negotiator = require('express-negotiator'),\n    root = '/path/to/static/files',\n    app = express.createServer();\n\napp\n    .use(express.cookieParser())\n    .use(negotiator({root: root, cookieName: 'mycookie'}))\n    .use(express.static(root))\n    .listen(1337);\n```\n\nIf the root dir contains the files `index.en.html`, `index.da.html`,\nand `foo.png` these example requests would be rewritten as follows:\n\n```\nGET / HTTP/1.1\nAccept: text/html\nAccept-Language: en\n\n=> /index.en.html\nResponse ETag: \"<size>-<modificationTime>-text/html-en\"\n```\n\n```\nGET /?locale=da HTTP/1.1\nAccept: text/html\nAccept-Language: en\n\n=> /index.da.html\nResponse ETag: \"<size>-<modificationTime>-text/html-da\"\n```\n\n```\nGET /index HTTP/1.1\nCookie: mycookie=da\nAccept: text/html\nAccept-Language: en\n\n=> /index.da.html\nResponse ETag: \"<size>-<modificationTime>-text/html-da\"\n```\n\n```\nGET /foo HTTP/1.1\nAccept: image/*\n\n=> /foo.png\nResponse ETag: \"<size>-<modificationTime>-image/png\"\n```\n\nSee the test suite for more examples.\n\nLicense\n=======\n\nexpress-negotiator is licensed under a standard 3-clause BSD license\n-- see the `LICENSE` file for details.\n","starsCount":1,"created":"2012-11-04T22:32:50.266Z","modified":"2017-05-22T17:19:56.219Z","lastPublisher":{"name":"papandreou","email":"andreas@one.com"},"owners":[{"email":"mail@mwinter.nl","name":"maartenwinter"},{"email":"andreas@one.com","name":"papandreou"}],"other":{"_attachments":{},"_from":".","_id":"express-negotiator","_nodeVersion":"0.10.42","_npmOperationalInternal":{"host":"packages-16-east.internal.npmjs.com","tmp":"tmp/express-negotiator-0.5.0.tgz_1461920858166_0.36700824927538633"},"_npmUser":{"name":"papandreou","email":"andreas@one.com"},"_npmVersion":"2.14.19","_rev":"2-362afb846d11a78689c0be2545f40adf","_shasum":"d1b8a0b0e86c9477945852bbb77899c04818e36a","author":{"name":"Andreas Lind Petersen","email":"andreas@one.com"},"directories":{},"dist-tags":{"latest":"0.5.0"},"dist":{"shasum":"d1b8a0b0e86c9477945852bbb77899c04818e36a","tarball":"http://registry.npmjs.org/express-negotiator/-/express-negotiator-0.5.0.tgz"},"maintainers":[{"email":"mail@mwinter.nl","name":"maartenwinter"},{"email":"andreas@one.com","name":"papandreou"}],"readmeFilename":"README.md","time":{"modified":"2017-05-22T17:19:56.219Z","created":"2012-11-04T22:32:50.266Z","0.0.1":"2012-11-04T22:32:52.448Z","0.1.0":"2013-01-10T13:06:56.701Z","0.2.0":"2013-04-09T11:04:19.554Z","0.2.1":"2013-04-09T12:17:32.948Z","0.2.2":"2013-04-09T12:38:03.370Z","0.2.3":"2013-04-09T12:49:52.073Z","0.2.4":"2013-04-10T13:25:34.987Z","0.2.5":"2013-05-01T11:26:28.061Z","0.2.6":"2013-05-01T12:48:59.657Z","0.2.7":"2013-06-26T06:59:09.959Z","0.2.8":"2013-07-01T09:21:27.817Z","0.3.0":"2013-07-18T11:28:03.358Z","0.3.1":"2013-08-01T15:55:23.634Z","0.4.0":"2013-09-19T10:02:10.618Z","0.4.1":"2013-09-19T12:17:39.518Z","0.4.2":"2014-04-03T06:50:23.324Z","0.4.3":"2014-04-03T07:43:22.299Z","0.4.4":"2014-04-09T09:20:00.640Z","0.4.5":"2014-05-15T13:18:37.399Z","0.4.6":"2014-05-30T08:35:53.507Z","0.4.7":"2015-05-21T08:09:14.377Z","0.4.8":"2015-12-16T16:12:48.388Z","0.5.0":"2016-04-29T09:07:39.216Z"},"users":{"snowdream":true}}}