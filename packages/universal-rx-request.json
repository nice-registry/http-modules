{"name":"universal-rx-request","version":"1.0.3","description":"Lightweight HTTP requests library based on superagent that returns a RxJS 5 observable. This library works on browser and server side.","keywords":["rxjs","rx","redux-observable","superagent","universal","http","request","fetch","observable","isomorphic","redux"],"main":"lib/index.js","scripts":{"test":"mocha --compilers js:babel-core/register","lint":"eslint src/*.js","coverage":" babel-node node_modules/.bin/babel-istanbul cover ./node_modules/mocha/bin/_mocha --report lcovonly -- -R spec","report-coverage":"npm run coverage && better-npm-run report-coverage","start":"webpack -w","build":"npm run lint && npm run test && webpack -p","prepublish":"npm run build"},"betterScripts":{"report-coverage":"codecov"},"repository":"https://github.com/datacamp/universal-rx-request","license":"MIT","devDependencies":{"babel-cli":"^6.18.0","babel-istanbul":"^0.12.1","babel-loader":"^6.2.10","babel-plugin-add-module-exports":"^0.2.1","babel-preset-es2015":"^6.18.0","babel-preset-stage-1":"^6.16.0","better-npm-run":"0.0.13","chai":"^3.5.0","codecov":"^1.0.1","eslint":"^3.12.2","eslint-config-airbnb":"^13.0.0","eslint-plugin-import":"^2.2.0","eslint-plugin-jsx-a11y":"^2.2.3","eslint-plugin-react":"^6.8.0","mocha":"^3.2.0","rxjs":"^5.0.1","superagent":"^3.3.1","superagent-mock":"^3.0.0","webpack":"^1.14.0"},"peerDependencies":{"rxjs":">= 5.0.1","superagent":">= 3.3.0"},"gitHead":"bb6c16a6cae5a4d454670bbe6eb37700529abbe3","homepage":"https://github.com/datacamp/universal-rx-request#readme","versions":[{"number":"1.0.0","date":"2016-12-20T14:15:24.993Z"},{"number":"1.0.1","date":"2016-12-20T14:22:15.238Z"},{"number":"1.0.2","date":"2016-12-20T15:57:52.591Z"},{"number":"1.0.3","date":"2017-02-08T16:05:24.137Z"}],"readme":"# universal-rx-request \n[![codecov](https://codecov.io/gh/datacamp/universal-rx-request/branch/master/graph/badge.svg)](https://codecov.io/gh/datacamp/universal-rx-request)\n[![npm](https://img.shields.io/npm/l/universal-rx-request.svg)](https://www.npmjs.com/package/universal-rx-request)\n[![npm](https://img.shields.io/npm/dt/universal-rx-request.svg)](https://www.npmjs.com/package/universal-rx-request)\n[![npm](https://img.shields.io/npm/v/universal-rx-request.svg)](https://www.npmjs.com/package/universal-rx-request)\n\nLightweight HTTP requests library based on [superagent](https://github.com/visionmedia/superagent) that returns a [RxJS 5](https://github.com/ReactiveX/rxjs) observable. This library works on browser and server side. \n\n## Install \nThis library has peer dependencies of `rxjs@>=5.0.1` and `superagent@>=3.3.0`.\nTo install via npm for node environment:\n```bash\nnpm install --save superagent rxjs universal-rx-request\n```\n\nTo install on the browser:\n```html\n<script type=\"text/javascript\" src=\"/lib/index.js\"></script>\n```\nThe library exposed a global variable called `rxRequest`. It also works with AMD api.\n\n## Basic Example\n\nThe library exposes a function which makes directly the HTTP request depending of the configuration you give. The request will return an observable.\n```js\nimport rxRequest from 'universal-rx-request';\n\nrxRequest({ method: 'get', url: 'https://api.ipify.org?format=json' })\n  .subscribe(result => console.log(result.body.ip), console.error);\n// print your current ip\n\nrxRequest({ method: 'get', url: 'https://wrong-api.com/notFound' })\n  .subscribe(result => console.log, error => console.error(error.error.errno));\n// print ENOTFOUND\n```\n\n## Works great with redux and redux-observable\n\nYou can import rx extensions which allow you to have more controls on the different steps that the request will going through (fetching => success|error). \n```js\nimport rxRequest from 'universal-rx-request';\n\nrxRequest.importRxExtensions(); // will add operators for the observables. You only have to do once\n\nrxRequest({ method: 'get', url: 'https://api.ipify.org?format=json' })\n  .mapToAction({ type: 'get_my_ip' })\n  .subscribe(console.log, console.error);\n// print the emitted items as a stream\n//  |--- { type: 'get_my_ip_fetching', requestStatus: 'fetching' } ------ { type: 'get_my_ip_success', requestStatus: 'success',  data: reponse } ----|\n\nrxRequest({ method: 'get', url: 'https://wrong-api.com/notFound' })\n  .mapToAction({ type: 'get_my_ip' })\n  .subscribe(console.log, console.error);\n// print the emitted items as a stream\n//  |--- { type: 'get_my_ip_fetching', requestStatus: 'fetching' } ------ { type: 'get_my_ip_error', requestStatus: 'error',  error: error } ----|\n```\nThanks to this rx extension you will be able to handle your state after each step of the HTTP request.\n\nThe rx extensions provide some other useful operators:\n```js\nimport rxRequest from 'universal-rx-request';\nimport { Observable } from 'rxjs/Observable';\nimport 'rxjs/add/observable/of';\n\nrxRequest.importRxExtensions();\n\nrxRequest({ method: 'get', url: 'https://api.ipify.org?format=json' })\n  .mapToAction({ type: 'get_my_ip' })\n  .mergeMapOnSucceedRequest(result => Observable.of({ ip: result.data.body.ip }))\n  .subscribe(console.log, console.error);\n// print the emitted items as a stream\n//  |--- { type: 'get_my_ip_fetching', requestStatus: 'fetching' } ------ { ip: 'xxx.xxx.xxx.x' } ----|\n```\n\nOnce you map the request to an action with `maptoAction`, We recommand you to use the extended operators to deal with succeed or failure request. these are the extended operators which may be useful:\n- `throwErrorOnFailedRequest()`: It will throw an error if the result of the http request is an error. To handle the error, you will have to catch it in the observable flow.\n- `mergeMapOnSucceedRequest((result) => {...})`: It acts like a classic [mergeMap](http://reactivex.io/rxjs/class/es6/Observable.js~Observable.html#instance-method-mergeMap) in the Rx world except that it will mergeMap only on succeed request (not fetching or error status). The function given as argument has to return an observable.\n- `flatMapOnSucceedRequest((result) => {...})`: It's an alias for `mergeMapOnSucceedRequest`.\n- `concatMapOnSucceedRequest((result) => {...})`: It's like `mergeMapOnSucceedRequest` except that it use the [concatMap](http://reactivex.io/rxjs/class/es6/Observable.js~Observable.html#instance-method-concatMap) operator.\n- `doOnSucceedRequest((result) => {...})`: It's like `mergeMapOnSucceedRequest` except that it use the [do](http://reactivex.io/rxjs/class/es6/Observable.js~Observable.html#instance-method-do) operator to do side effects.\n- `filterOnSucceedRequest()`: It's like `mergeMapOnSucceedRequest` except that it use the [filter](http://reactivex.io/rxjs/class/es6/Observable.js~Observable.html#instance-method-filter) operator.\n\nI invite you to check out the test folder which contains great example of how to use these operators correctly.\n\n## APIs\n\n### rxRequest(settings)\nFunction that will make the HTTP request and returns an observable. Shape of the settings (only url and method fields are required):\n```js\n {\n  url: 'https://...',\n  method: 'get|post|update|...',\n  query: {},\n  data: {},\n  options: {\n    only2xx: true|false,\n    agent: superagent.agent(),\n    json: true|false,\n    headers: {},\n    withCredentials: true|false,\n    responseType: 'blob|...',\n    timeout: {\n      response: 5000,\n      deadline: 60000,\n    },\n    auth: ['tobi', 'learnboost'],\n    redirects: 2,\n    attaches: [ ['file', 'test.png'], ...],\n    fields: [ ['user', 'Bob'], ...],\n  }\n }\n```\nThe function will return an observable which will emit an object corresponding to the response of the HTTP request. If an error occurs, the observable will emit an error which can be catch in the observable flow. The error emitted will be an object containing the `error` and `response` field. For more details about the shapes of the error and response object, please check the superagent library.\n\n### rxRequest.STATUS\nIt's an object containg all the different possible state of the HTTP request:\n```js\n{\n  FETCHING: 'fetching',\n  SUCCESS: 'success',\n  ERROR: 'error',\n}\n```\n\n### rxRequest.getStatus(action, status)\nFacility to get the type of the emitted action depending of the action object (`{ type: ... }`) and the status (rxRequest.STATUS).\n\n### rxRequest.importRxExtensions()\nFunction to extend the observable with new operators described above.\n","starsCount":1,"created":"2016-12-20T14:15:24.993Z","modified":"2017-02-08T16:05:24.137Z","lastPublisher":{"name":"herve-eerebout","email":"rv2e@icloud.com"},"owners":[{"name":"herve-eerebout","email":"rv2e@icloud.com"}],"other":{"_attachments":{},"_from":".","_id":"universal-rx-request","_nodeVersion":"6.3.0","_npmOperationalInternal":{"host":"packages-18-east.internal.npmjs.com","tmp":"tmp/universal-rx-request-1.0.3.tgz_1486569922918_0.5979988614562899"},"_npmUser":{"name":"herve-eerebout","email":"rv2e@icloud.com"},"_npmVersion":"3.10.3","_rev":"5-2589e9dcf1c02b6ac61b472a0f7c8e0c","_shasum":"3c8dc3c20a5d8ca439cf83a3c0cd8e01fc72e2c5","author":{"name":"Herve Eerebout"},"bugs":{"url":"https://github.com/datacamp/universal-rx-request/issues"},"contributors":[{"name":"Ludovic Vannoorenberghe"}],"directories":{},"dist-tags":{"latest":"1.0.3"},"dist":{"shasum":"3c8dc3c20a5d8ca439cf83a3c0cd8e01fc72e2c5","tarball":"https://registry.npmjs.org/universal-rx-request/-/universal-rx-request-1.0.3.tgz"},"maintainers":[{"name":"herve-eerebout","email":"rv2e@icloud.com"}],"readmeFilename":"README.md","time":{"modified":"2017-02-08T16:05:24.137Z","created":"2016-12-20T14:15:24.993Z","1.0.0":"2016-12-20T14:15:24.993Z","1.0.1":"2016-12-20T14:22:15.238Z","1.0.2":"2016-12-20T15:57:52.591Z","1.0.3":"2017-02-08T16:05:24.137Z"},"users":{"ludov":true}}}