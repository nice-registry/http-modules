{"name":"changed-http","version":"0.0.3","description":"Polls HTTP resources and fires events when they change","main":"index.js","scripts":{"test":"make test"},"repository":"https://github.com/robinjmurphy/changed","keywords":["poll","http","changed"],"license":"ISC","homepage":"https://github.com/robinjmurphy/changed","devDependencies":{"mocha":"~1.17.1","nock":"~0.27.2","winston":"~0.7.2","aws-sdk":"~2.0.0-rc9","diff":"~1.0.8","sinon":"~1.8.2"},"dependencies":{"lodash":"~2.4.0"},"versions":[{"number":"0.0.1","date":"2014-02-23T13:26:50.930Z"},{"number":"0.0.2","date":"2014-02-23T13:35:18.627Z"},{"number":"0.0.3","date":"2014-02-26T19:47:58.550Z"}],"readme":"# changed\n\n[![Build Status](https://travis-ci.org/robinjmurphy/changed.png?branch=master)](https://travis-ci.org/robinjmurphy/changed) [![Code Climate](https://codeclimate.com/github/robinjmurphy/changed.png)](https://codeclimate.com/github/robinjmurphy/changed)\n\nPolls HTTP resources and fires events when they change.\n\n## Features\n\n* Supports HTTP and HTTPS\n* Transparently decodes gzipped resources\n\n## Installation\n\n```\nnpm install robinjmurphy/changed\n```\n\n## Usage\n\n```javascript\nvar changed = require('changed-http');\n\nvar resource = new changed.Resource('http://www.example.com');\n\nresource.on('changed', function (current, previous) {\n  console.log('Resource changed. Response body was ' + previous + ' , is now ' + current + '.');\n});\n\nresource.startPolling(5000);\n```\n\n## API\n\n#### `new changed.Resource(url, options)`\n\n##### Parameters\n\n* `url` - _string_\n* `options` - _object_ - configuration options\n\n##### Options\n\nThe `options` object supports all of the standard options from [http.request](http://nodejs.org/api/http.html#http_http_request_options_callback) and [https.request](http://nodejs.org/api/https.html#https_https_request_options_callback). In addition, it supports the following properties:\n\n* `compare` - _function_ - overrides the default response body comparison. Receives the current response body as its first argument and the previous response body as its second argument. Should return `true` if the responses differ.\n\n---\n\n#### `.startPolling(interval)`\n\nStart polling the resource for changes.\n\n##### Parameters\n\n* `interval` - _number_ - the interval time in milliseconds (default `10000`)\n\n---\n\n#### `.stopPolling()`\n\nStop polling the resource.\n\n---\n\n### Events\n\n##### `changed`\n\nFired when the resource's body changes.\n\n```javascript\nresource.on('changed', function (current, previous) {\n  // `current` is a string containing the curent response body\n  // `previous` is a string containing previous response body \n});\n```\n\n##### `error`\n\nFired when an error occurs.\n\n```javascript\nresource.on('error', function (error) {\n  // `error` is an Error object\n});\n```\n\n##### `response`\n\nFired each time a response is received whilst polling.\n\n```javascript\nresource.on('response', function (body, res) {\n  // `body` is a string containig the response body\n  // `res` is the http/https response object\n});\n```\n\n## Logging\n\nAll polling requests are logged using `console.info` by default. To use a custom logger, like [Winston](https://github.com/flatiron/winston), just set the `changed.logger` property:\n\n```javascript\nvar changed = require('changed-http');\nvar winston = require('winston');\n\nchanged.logger = winston;\n```\n\n## Examples\n\n### Custom response comparison\n\nIn the following example the `changed` event is only fired when the `foo` property in a JSON response changes.\n\n```javascript\nvar changed = require('changed-http');\n\nvar resource = new changed.Resource('http://www.example.com/some/json/file.json', {\n  compare: function (current, previous) {\n    var currentJson = JSON.parse(current);\n    var previousJson = JSON.parse(previous);\n    \n    return (currentJson.foo !== previousJson.foo);\n  }\n});\n\nresource.startPolling(5000);\n```","created":"2014-02-23T13:26:50.930Z","modified":"2014-02-26T19:47:58.550Z","lastPublisher":{"name":"robinmurphy","email":"robin@robinmurphy.co.uk"},"owners":[{"name":"robinmurphy","email":"robin@robinmurphy.co.uk"}],"other":{"_attachments":{},"_from":".","_id":"changed-http","_npmUser":{"name":"robinmurphy","email":"robin@robinmurphy.co.uk"},"_npmVersion":"1.4.3","_rev":"1-0c425eed65fed3ef6feb140bd711f66e","author":{"name":"robin@robinmurphy.co.uk"},"bugs":{"url":"https://github.com/robinjmurphy/changed/issues"},"directories":{},"dist-tags":{"latest":"0.0.3"},"dist":{"shasum":"a614164b70ee01293aba7902cf089511e8b65d35","tarball":"http://registry.npmjs.org/changed-http/-/changed-http-0.0.3.tgz"},"maintainers":[{"name":"robinmurphy","email":"robin@robinmurphy.co.uk"}],"readmeFilename":"README.md","time":{"modified":"2014-02-26T19:47:58.550Z","created":"2014-02-23T13:26:50.930Z","0.0.1":"2014-02-23T13:26:50.930Z","0.0.2":"2014-02-23T13:35:18.627Z","0.0.3":"2014-02-26T19:47:58.550Z"}}}