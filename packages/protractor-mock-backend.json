{"name":"protractor-mock-backend","version":"0.9.1","description":"Mock HTTP calls in your protractor specs.","main":"index.js","scripts":{"example":"grunt example","test":"grunt verify","webdriver-update":"node node_modules/grunt-protractor-runner/scripts/webdriver-manager-update"},"license":"BSD-2-Clause","devDependencies":{"grunt":"~1.0.1","grunt-browserify":"^5.0.0","grunt-contrib-connect":"^1.0.2","grunt-contrib-jasmine":"^1.0.3","grunt-contrib-jshint":"~1.0.0","grunt-jasmine-nodejs":"^1.5.2","grunt-protractor-runner":"^3.1.0","phantomjs-prebuilt":"^2.1.3","protractor-http-mock-sample-plugin":"0.0.1"},"repository":"https://github.com/coldhamix/protractor-mock-backend","dependencies":{"query-string":"^4.1.0"},"engines":{"node":">=4.0.0"},"gitHead":"23780959a3649c8a9f01b756b3aea19487ede234","homepage":"https://github.com/coldhamix/protractor-mock-backend#readme","versions":[{"number":"0.9.0","date":"2016-10-07T07:22:25.835Z"},{"number":"0.9.1","date":"2016-10-07T07:31:30.588Z"}],"readme":"# Protractor Mock\r\nA NodeJS module to be used alongside [Protractor](https://github.com/angular/protractor) to facilitate setting up mocks for HTTP calls for the AngularJS applications under test.\r\n\r\nThis allows the developer to isolate the UI and client-side application code in our tests without any dependencies on an API.\r\n\r\n**This plugin does not depend on Angular Mocks (ngMockE2E) being loaded into your app; therefore, there is no need to modify anything within your current Angular web application.**\r\n\r\n[![Build Status](https://travis-ci.org/atecarlos/protractor-http-mock.png)](https://travis-ci.org/atecarlos/protractor-http-mock)\r\n\r\n## Installation\r\n\tnpm install protractor-http-mock --save-dev\r\n## Configuration\r\nIn your protractor configuration file, we can set the following options:\r\n\r\n### Mocks\r\nWe can set a collection of default mocks to load for every test, and the name of the folder where your mocks will reside. More on this later.\r\n\r\n  \tmocks: {\r\n    \tdefault: ['mock-login'], // default value: []\r\n    \tdir: 'my-mocks' // default value: 'mocks'\r\n  \t},\r\n\r\n### Directories and file names\r\nWe can also configure our root directory where the mocks and protractor configuration will be located; as well as, the name of the protractor configuration file.\r\n\r\n  \tonPrepare: function(){\r\n    \trequire('protractor-http-mock').config = {\r\n\t\t\trootDirectory: __dirname, // default value: process.cwd()\r\n\t\t\tprotractorConfig: 'my-protractor-config.conf' // default value: 'protractor-conf.js'\r\n    \t};\r\n  \t}\r\n\r\n## Usage\r\nMocks are defined as JSON objects describing the request and response for a particular HTTP call:\r\n\r\n  \t  {\r\n\t\trequest: {\r\n\t      path: '/users/1',\r\n\t      method: 'GET'\r\n\t    },\r\n\t    response: {\r\n\t      data: {\r\n\t        userName: 'pro-mock',\r\n\t        email: 'pro-mock@email.com'\r\n\t      }\r\n\t    }\r\n\t  }\r\n\r\nAnd then set the mock at the beginning of your test before your application loads:\r\n\r\n\tvar mock = require('protractor-http-mock');\r\n\t...\r\n\r\n\t  mock([{\r\n\t    request: {\r\n\t      path: '/users/1',\r\n\t      method: 'GET'\r\n\t    },\r\n\t    response: {\r\n\t      data: {\r\n\t        userName: 'pro-mock',\r\n\t        email: 'pro-mock@email.com'\r\n\t      }\r\n\t    }\r\n\t  }]);\r\n\r\nMake sure to clean up after test execution. This should be typically done in the `afterEach` call to ensure the teardown is executed regardless of what happens in the test execution:\r\n\r\n\tafterEach(function(){\r\n\t  mock.teardown();\r\n\t});\r\n\r\nPlease note that the `mock()` function needs to be called before the browser opens. If you have different mock data for different tests, please make sure that, either the tests always start in a new browser window, or that its possible to setup all the mocks for each test case before any of tests start running.\r\n\r\n### Mock files\r\nMocks can also be loaded from physical files located in the `mocks.dir` directory that we defined in our configuration:\r\n\r\n  \ttests\r\n\t    e2e\r\n\t      protractor.conf.js\r\n\t      mocks\r\n\t        users.js\r\n\t      specs\r\n\t        ...\r\n\r\n\r\nYou could simply load your mocks as follows:\r\n\r\n\tmock(['users']);\r\n\r\nFiles are structured as standard node modules. The strings passed are the path of the file relative to the mocks directory - the same as if you would be doing a standard `require()` call.\r\n\r\n\tmodule.exports = { ... }; // for a single mock.\r\n\r\nor\r\n\r\n\tmodule.exports = [ ... ]; // for multiple mocks.\r\n\r\n\r\n### Schema\r\nThe full GET schema for defining your mocks is as follows:\r\n\r\n\t  request: {\r\n\t    path: '/products/1/items',\r\n\t    method: 'GET',\r\n\t\t\tregex: false, // Boolean to enable Regular Expression matching on path. This is an optional field.\r\n\t    params: { // These match params as they would be passed to the $http service. This is an optional field.\r\n\t      page: 2,\r\n\t      status: 'onsale'\r\n\t    },\r\n\t    queryString: { // These match query string parameters that are part of the URL as passed in to the $http service. This is an optional field.\r\n\t      param1: 'My first qs parameters',\r\n\t      param2: 'Second parameter'\r\n\t    },\r\n\t    headers: { //These match headers as the end result of the expression provided to the $http method.\r\n\t    \thead1: 'val1',\r\n\t    \thead2: 'val2'\r\n\t    }\r\n\t  },\r\n\t  response: {\r\n\t  \tdata: {}, // This is the return value for the matched request\r\n\t    status: 500 // The HTTP status code for the mocked response. This is an optional field.\r\n\t    delay: 2 // number of milliseconds to delay sending back the response.\r\n\t  }\r\n\r\nA full mock for a POST call takes the following options:\r\n\r\n\t  request: {\r\n\t    path: '/products/1/items',\r\n\t    method: 'POST',\r\n\t\t\tregex: false, // Boolean to enable Regular Expression matching on path. This is an optional field.\r\n\t    data: { // These match POST data. This is an optional field.\r\n\t      status: 'onsale',\r\n\t      title: 'Blue Jeans',\r\n          price: 24.99\r\n\t    }\r\n\t  },\r\n\t  response: {\r\n\t    data: { // This is the return value for the matched request\r\n\t      status: 'onsale',\r\n\t      title: 'Blue Jeans',\r\n          id: 'abc123',\r\n          price: 24.99\r\n        },\r\n\t    status: 204 // The HTTP status code for the mocked response. This is an optional field.\r\n\t  }\r\n\r\nPUT, DELETE, HEAD, PATCH, and JSONP methods are also supported. Please see the examples in the source code for more information.\r\n\r\n#### Request\r\nDefining `params`, `queryString`, `headers`, or `data` will help the plugin match more specific responses but neither is required. Both correspond to their matching objects as they would be passed into the $http object call.\r\n\r\nHeaders must be defined as the headers that will be used in the http call. Therefore, if in the code to be tested, the headers are defined using properties with function values, these functions will be evaluated as per the $http specification and matched by end result.\r\n\r\n#### Response\r\nThe default `status` value is 200 if none is specified.\r\n\r\nAn optional `delay` value can be set on the response to assert any state that occurs when waiting for the response in your application, i.e. loading messages or spinners. Please note that UI tests with timing expectations can be somewhat unstable and provide inconsistent results. Please use this feature carefully.\r\n\r\n### Precendence\r\nprotractor-http-mock will respond with the **last** matched request in case there are several matches. The plugin will start matching the default mocks first, followed by those added within the test itself in the order they are added. In other words, the last mock defined will always win.\r\n\r\n### Inspection\r\nFor testing or debugging purposes, it is possible to extract a list of http requests. Simply call the `requestsMade` function as follows:\r\n\r\n\tvar mock = require('protractor-http-mock');\r\n\t...\r\n\r\n\t  expect(mock.requestsMade()).toEqual([\r\n\t\t\t{ url : '/default', method : 'GET' },\r\n\t\t\t{ url : '/users', method : 'GET' }\r\n\t\t]);\r\n\r\nIt is also possible to clear the list of requests with the `clearRequests()` method.\r\n\r\nIf you wish to assert anything but the full list of requests, then you can do the following to piece out the information needed on the requests:\r\n\r\n\tmock.requestsMade().then(function(requests){\r\n\t\texpect(requests[1]).toEqual({ url : '/users', method : 'GET' })\r\n\t});\r\n\r\n### Runtime mocks\r\nIf there is a need to add or remove mocks during test execution, please use the `add()` and `remove()` functions:\r\n\r\n\tmock.add([{\r\n\t\trequest: {\r\n\t\t\tpath: '/users',\r\n\t\t\tmethod: 'GET',\r\n\t\t\tparams: {\r\n\t\t\t\tname: 'Charlie'\r\n\t\t\t}\r\n\t\t},\r\n\t\tresponse: {\r\n\t\t\tdata: {\r\n\t\t\t\tname: 'Override'\r\n\t\t\t}\r\n\t\t}\r\n\t}]);\r\n\r\n\t...\r\n\r\n\tmock.remove([{\r\n\t\trequest: {\r\n\t\t\tpath: '/users',\r\n\t\t\tmethod: 'GET',\r\n\t\t\tparams: {\r\n\t\t\t\tname: 'Charlie'\r\n\t\t\t}\r\n\t\t},\r\n\t\tresponse: {\r\n\t\t\tdata: {\r\n\t\t\t\tname: 'Override'\r\n\t\t\t}\r\n\t\t}\r\n\t}]);\r\n\r\nThese will dynamically modify your current set of mocks, and any new request that happens after that will work with the updated set of mocks. Please note that these functions only work by adding or removing mocks using inline objects. As of now, it is not possible to add or remove mocks using mock files.\r\n\r\n### Plugins\r\n\r\nPlugins can be used to extend the matching functionality of protractor-http-mock. These are separate from protractor plugins.\r\n\r\nA plugin can be defined as either an NPM package or a function.\r\n\r\nThey can be declared in your protractor configuration to be consumed by all your tests:\r\n\r\n\tbaseUrl: 'http://localhost:8000/',\r\n    specs: [\r\n      'spec/*.spec.js'\r\n    ],\r\n    httpMockPlugins: {\r\n      default: ['protractor-http-mock-sample-plugin']\r\n    }\r\n\r\nor in each individual test:\r\n\r\n\tmock([\r\n\t\t//mocks go here\r\n\t], [\r\n\t\t{\r\n\t\t\tmatch: function(mockRequest, requestConfig){\r\n\t\t\t\t...\r\n\t\t\t}\r\n\t\t}\r\n\t]);\r\n\r\nNote that in both your protractor configuration and tests, a plugin can be declared as either an npm package name, or definining the object inline.\r\n\r\nSee this [sample plugin](https://github.com/atecarlos/protractor-http-mock-sample-plugin) for more information.\r\n\r\n### Defaults\r\n\r\nIf necessary, default mocks and plugins can be skipped for a particular test simply by passing true at the end of your `mock` call:\r\n\r\n\tmock(mocks, plugins, true);\r\n\r\n\r\n### Examples\r\nIncluded in the code base is an extensive list examples on how to use all the features of this plugin. Please take a look if you have any questions.\r\n\r\nTo run these tests locally, please follow these steps from the root directory:\r\n\r\n1. `npm install`\r\n2. `npm run webdriver-update`\r\n3. `npm run example`\r\n","created":"2016-10-07T07:22:25.835Z","modified":"2016-10-07T07:31:30.588Z","lastPublisher":{"name":"coldhamix","email":"khamzin@haulmont.com"},"owners":[{"name":"coldhamix","email":"khamzin@haulmont.com"}],"other":{"_attachments":{},"_from":".","_id":"protractor-mock-backend","_nodeVersion":"4.5.0","_npmOperationalInternal":{"host":"packages-16-east.internal.npmjs.com","tmp":"tmp/protractor-mock-backend-0.9.1.tgz_1475825488016_0.20814781938679516"},"_npmUser":{"name":"coldhamix","email":"khamzin@haulmont.com"},"_npmVersion":"2.15.9","_rev":"1-d5cf17b06d0a8a2466bac0f868f01898","_shasum":"3c9b5fb043ae714d541c293003986828848e132f","author":{"name":"Carlos Atencio"},"bugs":{"url":"https://github.com/coldhamix/protractor-mock-backend/issues"},"directories":{},"dist-tags":{"latest":"0.9.1"},"dist":{"shasum":"3c9b5fb043ae714d541c293003986828848e132f","tarball":"http://registry.npmjs.org/protractor-mock-backend/-/protractor-mock-backend-0.9.1.tgz"},"maintainers":[{"name":"coldhamix","email":"khamzin@haulmont.com"}],"readmeFilename":"README.md","time":{"modified":"2016-10-07T07:31:30.588Z","created":"2016-10-07T07:22:25.835Z","0.9.0":"2016-10-07T07:22:25.835Z","0.9.1":"2016-10-07T07:31:30.588Z"}}}