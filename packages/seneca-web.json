{"name":"seneca-web","description":"Http route mapping for Seneca microservices.","version":"2.1.0","keywords":["seneca","web","plugin"],"license":"MIT","main":"web.js","scripts":{"test":"lab -v -L -t 80 -m 5000","coveralls":"lab -s -r lcov | coveralls","coverage":"lab -v -L -r html > docs/coverage.html","annotate":"docco web.js -o docs/annotated"},"files":["LICENSE","README.md","web.js","lib"],"dependencies":{"eraro":"^0.4.1","lodash":"^4.17.4"},"devDependencies":{"body-parser":"^1.15.2","code":"^4.1.0","connect":"^3.5.0","cookie-parser":"^1.4.3","coveralls":"^2.11.12","docco":"^0.7.0","eslint-config-seneca":"^3.0.0","eslint-plugin-hapi":"^4.0.0","eslint-plugin-standard":"^2.0.0","express":"^4.14.0","express-session":"^1.14.1","hapi":"^15.0.3","hapi-auth-basic":"^4.2.0","lab":"^13.1.0","passport":"^0.3.2","passport-local":"^1.0.0","pre-commit":"^1.1.3","request":"^2.74.0","seneca":"plugin"},"repository":"https://github.com/senecajs/seneca-web","pre-commit":["test"],"gitHead":"fdbbd69d1b40ed87a8a53e9358555138aa06c561","homepage":"https://github.com/senecajs/seneca-web#readme","versions":[{"number":"0.1.0","date":"2013-11-06T13:14:24.287Z"},{"number":"0.1.1","date":"2014-01-28T07:35:33.648Z"},{"number":"0.1.3","date":"2014-04-10T13:52:43.687Z"},{"number":"0.2.0","date":"2014-07-13T06:28:26.613Z"},{"number":"0.2.1","date":"2014-07-25T00:05:48.085Z"},{"number":"0.2.2","date":"2014-09-30T08:57:19.254Z"},{"number":"0.3.0","date":"2015-01-26T18:16:29.567Z"},{"number":"0.3.1","date":"2015-01-29T18:57:52.097Z"},{"number":"0.3.2","date":"2015-02-01T11:39:06.525Z"},{"number":"0.3.3","date":"2015-02-01T20:30:15.798Z"},{"number":"0.1.4","date":"2015-06-10T16:49:28.099Z"},{"number":"0.4.0","date":"2015-06-12T15:34:59.479Z"},{"number":"0.4.1","date":"2015-06-15T14:41:52.227Z"},{"number":"0.4.2","date":"2015-06-21T23:59:34.815Z"},{"number":"0.4.3","date":"2015-07-09T15:00:41.700Z"},{"number":"0.4.4","date":"2015-11-18T22:54:31.142Z"},{"number":"0.5.0","date":"2016-01-13T19:43:00.918Z"},{"number":"0.6.0","date":"2016-01-28T22:09:11.876Z"},{"number":"0.7.0","date":"2016-02-03T17:54:24.414Z"},{"number":"0.7.1","date":"2016-02-18T19:18:23.893Z"},{"number":"0.8.0","date":"2016-07-23T06:59:27.225Z"},{"number":"1.0.0","date":"2016-09-11T22:26:53.216Z"},{"number":"2.0.0","date":"2016-10-01T08:48:05.019Z"},{"number":"2.1.0","date":"2017-06-13T14:25:45.513Z"}],"readme":"![Seneca][Logo]\n\n# seneca-web\n[![npm version][npm-badge]][npm-url]\n[![Build Status][travis-badge]][travis-url]\n[![Coverage Status][coveralls-badge]][coveralls-url]\n[![Dependency Status][david-badge]][david-url]\n[![Gitter chat][gitter-badge]][gitter-url]\n\n- __Sponsor:__ [nearForm][Sponsor]\n- __Node:__ 4.x, 6.x\n- __Seneca:__ 1.x - 3.x\n\n\nThis plugin allows http requests to be mapped to seneca actions. Http actions handled\nlocally can access the raw `request` and `response` objects. Actions handled over\ntransport can access a reduced set of request data including payloads and headers.\n\nIf you're using this module, and need help, you can:\n\n- Post a [github issue][],\n- Tweet to [@senecajs][],\n- Ask on the [Gitter][gitter-url].\n\nIf you are new to Seneca in general, please take a look at [senecajs.org][]. We have\neverything from tutorials to sample apps to help get you up and running quickly.\n\n\n## Install\n```\nnpm install seneca-web\n```\n\n## Test\nTo run tests locally,\n\n```\nnpm run test\n```\n\nTo obtain a coverage report,\n\n```\nnpm run coverage; open docs/coverage.html\n```\n\n## Quick example\n__Route map__\n```js\nvar Routes = [{\n  pin: 'role:admin,cmd:*',\n  prefix: '/v1',\n  postfix: '/?param=true',\n  map: {\n    home: {\n      GET: true,\n      POST: true,\n      alias: '/home'\n    },\n    logout: {\n      GET: true,\n      redirect: '/'\n    },\n    profile: {\n      GET: true,\n      autoreply: false\n    },\n    login: {\n      POST: true,\n      auth: {\n        strategy: 'local',\n        pass: '/profile',\n        fail: '/'\n      }\n    }\n  }\n}]\n```\n\n## Adapters\n\nAn adapter that maps the routes to routes in a web framework must be provided via the `adapter` parameter\n\nThe following adapters are provided:\n\n* [seneca-web-adapter-connect](https://github.com/senecajs/seneca-web-adapter-connect)\n* [seneca-web-adapter-express](https://github.com/senecajs/seneca-web-adapter-express)\n* [seneca-web-adapter-hapi](https://github.com/senecajs/seneca-web-adapter-hapi)\n* [seneca-web-adapter-koa1](https://github.com/senecajs/seneca-web-adapter-koa1)\n* [seneca-web-adapter-koa2](https://github.com/senecajs/seneca-web-adapter-koa2)\n\n__Hapi__\n```js\n'use strict'\n\nvar Hapi = require('hapi')\nvar Seneca = require('seneca')\nvar Web = require('../../')\nvar Routes = require('./common/routes')\nvar Plugin = require('./common/plugin')\n\nvar config = {\n  routes: Routes,\n  adapter: require('seneca-web-adapter-hapi'),\n  context: (() => {\n    var server = new Hapi.Server()\n    server.connection({port: 4000})\n    return server\n  })()\n}\n\nvar seneca = Seneca()\n  .use(Plugin)\n  .use(Web, config)\n  .ready(() => {\n    var server = seneca.export('web/context')()\n\n    server.start(() => {\n      console.log('server started on: ' + server.info.uri)\n    })\n  })\n```\n\n__Express__\n```js\n'use strict'\n\nvar Seneca = require('seneca')\nvar Express = require('Express')\nvar Web = require('../../')\nvar Routes = require('./common/routes')\nvar Plugin = require('./common/plugin')\n\nvar config = {\n  routes: Routes,\n  adapter: require('seneca-web-adapter-express'),\n  context: Express()\n}\n\nvar seneca = Seneca()\n  .use(Plugin)\n  .use(Web, config)\n  .ready(() => {\n    var server = seneca.export('web/context')()\n\n    server.listen('4000', () => {\n      console.log('server started on: 4000')\n    })\n  })\n\n```\n\n__Connect__\n```js\n'use strict'\n\nvar Seneca = require('seneca')\nvar Connect = require('connect')\nvar Http = require('http')\nvar Web = require('../../')\nvar Routes = require('./common/routes')\nvar Plugin = require('./common/plugin')\n\nvar config = {\n  routes: Routes,\n  adapter: require('seneca-web-adapter-connect'),\n  context: Connect()\n}\n\nvar seneca = Seneca()\n  .use(Plugin)\n  .use(Web, config)\n  .ready(() => {\n    var connect = seneca.export('web/context')()\n    var http = Http.createServer(connect)\n\n    http.listen(4060, () => {\n      console.log('server started on: 4060')\n    })\n  })\n\n```\n\n## Action Patterns\n\n### role:web,route:*\nDefine a web service as a mapping from URL routes to action patterns.\n\n```js\nseneca.act('role:web', {routes: Routes}, (err, reply) => {\n  console.log(err || reply.routes)\n})\n```\n\n## Exported Methods\n\n### context\nProvides the current context so it can be used to start the server or\nadd custom logic, strategies, or middleware.\n\n```js\nvar seneca = Seneca()\n  .use(Plugin)\n  .use(Web, config)\n  .ready(() => {\n\n    // This will be whatever server is being used.\n    // seneca-web doesn't autostart the server, it\n    // must first be exported and then started.\n    var context = seneca.export('web/context')()\n  })\n```\n\n### mapRoutes\nAllows routes to be mapped outside of using seneca directly. Provides the\nsame functionality as `role:web,route:*`.\n\n```js\nvar seneca = Seneca()\n  .use(Plugin)\n  .use(Web, config)\n  .ready(() => {\n\n    // Provides the same functionality as seneca.act('role:web', {routes ...})\n    // can be used to add more routes at runtime without needing seneca.\n    seneca.export('web/mapRoutes')(Routes, (err, reply) => {\n      ...\n    })\n  })\n```\n\n### setServer\nAllows the server and adapter to be swapped out after runtime.\n\n```js\nvar seneca = Seneca()\n  .use(Plugin)\n  .use(Web, config)\n  .ready(() => {\n\n    var config = {\n      context: Express(),\n      adapter: require('seneca-web-adapter-express'),\n      routes: Routes\n    }\n\n    // Provides the same functionality as seneca.act('role:web', {routes ...})\n    // can be used to add more routes at runtime without needing seneca.\n    seneca.export('web/setServer')(config, (err, reply) => {\n      ...\n    })\n  })\n```\n\n## Auth\nBoth Hapi and Express support secure routing. Hapi support is via it's built in\nauth mechanism and allows Bell and custom strategies. Express auth is provided\nvia passport, which supports 100s of strategies.\n\n__Secure Express routes__\n```js\nmap: {\n  home: {\n    GET: true,\n    POST: true,\n    alias: '/'\n  },\n  logout: {\n    GET: true,\n    redirect: '/'\n  },\n  profile: {\n    GET: true,\n    secure: {\n      fail: '/'\n    }\n  },\n  login: {\n    POST: true,\n    auth: {\n      strategy: 'local',\n      pass: '/profile',\n      fail: '/'\n    }\n  }\n```\n\nExpress routes use `auth` for `passport.authorize` and `secure` for checking the\nexistence of `request.user`. Both secure and auth guards support fail redirects. Auth\nalso supports pass routing.\n\n__Secure Hapi routes__\n```js\nmap: {\n  home: {\n    GET: true,\n    POST: true,\n    alias: '/'\n  },\n  profile: {\n    GET: true,\n    auth: {\n      strategy: 'simple',\n      fail: '/'\n    }\n  },\n  admin: {\n    GET: true,\n    auth: {\n      strategy: 'simple',\n      pass: '/profile',\n      fail: '/'\n    }\n  }\n}\n```\nHapi routes do not use the `secure` option. All routes are secured using `auth`. Both\npass and fail redirects are supported.\n\n## Body Parser\n\nIf a body parser has not been provided using express or connect, seneca-web will attempt\nto parse the body. This will not work if a body-parser has already been defined for the app.\nTo disable this behavior, pass `{options: {parseBody: false}}` to the plugin options.\n\n```js\n.use(SenecaWeb, {\n        routes: Routes,\n        context: express,\n        adapter: require('seneca-web-adapter-express'),\n        options: {parseBody: false}\n    })\n```\n\n## Examples\nA number of examples showing basic and secure usage for hapi and express as well as\nshowing connect and log usage are provided in [./docs/examples](). Examples include,\n\n- Logging routes when building maps (via log adapter).\n- Basic expres, hapi, and connect usage.\n- Securing Express and Hapi routes.\n- Proxying some routes over to transport\n\n## Contributing\nThe [Senecajs org][] encourage open participation. If you feel you can help in any way,\nbe it with documentation, examples, extra testing, or new features please get in touch.\n\n\n## License\nCopyright (c) 2013 - 2016, Richard Rodger and other contributors.\nLicensed under [MIT][].\n\n[Sponsor]: http://nearform.com\n[Logo]: http://senecajs.org/files/assets/seneca-logo.png\n[npm-badge]: https://badge.fury.io/js/seneca-web.svg\n[npm-url]: https://badge.fury.io/js/seneca-web\n[travis-badge]: https://api.travis-ci.org/senecajs/seneca-web.svg\n[travis-url]: https://travis-ci.org/senecajs/seneca-web\n[coveralls-badge]:https://coveralls.io/repos/senecajs/seneca-web/badge.svg?branch=master&service=github\n[coveralls-url]: https://coveralls.io/github/senecajs/seneca-web?branch=master\n[david-badge]: https://david-dm.org/senecajs/seneca-web.svg\n[david-url]: https://david-dm.org/senecajs/seneca-web\n[gitter-badge]: https://badges.gitter.im/senecajs/seneca.png\n[gitter-url]: https://gitter.im/senecajs/seneca\n[MIT]: ./LICENSE\n[Senecajs org]: https://github.com/senecajs/\n[Seneca.js]: https://www.npmjs.com/package/seneca\n[senecajs.org]: http://senecajs.org/\n[github issue]: https://github.com/senecajs/seneca-web/issues\n[@senecajs]: http://twitter.com/senecajs\n","starsCount":3,"created":"2013-11-06T13:14:20.547Z","modified":"2017-06-13T14:25:45.513Z","lastPublisher":{"name":"rjrodger","email":"richard.rodger@nearform.com"},"owners":[{"name":"davidmarkclements","email":"huperekchuno@googlemail.com"},{"name":"mcdonnelldean","email":"mcdonnelldean@outlook.com"},{"name":"mihaidma","email":"mihaizn@gmail.com"},{"name":"rjrodger","email":"richard.rodger@nearform.com"},{"name":"tswaters","email":"tyler.waters@gmail.com"},{"name":"wyatt","email":"wpreul@gmail.com"}],"other":{"_attachments":{},"_from":".","_id":"seneca-web","_nodeVersion":"6.10.2","_npmOperationalInternal":{"host":"s3://npm-registry-packages","tmp":"tmp/seneca-web-2.1.0.tgz_1497363944433_0.44242610898800194"},"_npmUser":{"name":"rjrodger","email":"richard.rodger@nearform.com"},"_npmVersion":"3.10.10","_rev":"3-dc9b946dfff33b3909b4f511cec65274","_shasum":"bf377e49120b3666906d8f16def0d13c0760e9b8","author":{"name":"Richard Rodger","url":"https://github.com/rjrodger"},"bugs":{"url":"https://github.com/senecajs/seneca-web/issues"},"contributors":[{"name":"Mircea Alexandru","url":"http://alexandrumircea.ro"},{"name":"Dean McDonnell","url":"http://github.com/mcdonnelldean"},{"name":"Mihai Dima","url":"https://github.com/mihaidma"},{"name":"Michael Robinson","url":"https://github.com/faceleg"},{"name":"Wyatt Preul","url":"https://github.com/geek"},{"name":"Cristian Kiss","url":"https://github.com/ckiss"},{"name":"Shane Lacey","url":"https://github.com/shanel262"},{"name":"William P. Riley-Land","url":"https://github.com/wprl"},{"name":"Adrien Becchis","url":"https://github.com/AdrieanKhisbe"},{"name":"Marius Ursache","url":"https://github.com/bamse16"},{"name":"Vito Tardia","url":"https://github.com/vtardia"},{"name":"Michele Capra","url":"https://github.com/piccoloaiutante"},{"name":"David Mark Clements","url":"https://github.com/davidmarkclements"},{"name":"Reto Inderbitzin","url":"https://github.com/indr"},{"name":"David Gonzalez","url":"http://github.com/dgonzalez"},{"name":"Tyler Waters","url":"https://github.com/tswaters"}],"directories":{},"dist-tags":{"latest":"2.1.0","rc0":"0.3.0"},"dist":{"shasum":"bf377e49120b3666906d8f16def0d13c0760e9b8","tarball":"https://registry.npmjs.org/seneca-web/-/seneca-web-2.1.0.tgz"},"maintainers":[{"name":"davidmarkclements","email":"huperekchuno@googlemail.com"},{"name":"mcdonnelldean","email":"mcdonnelldean@outlook.com"},{"name":"mihaidma","email":"mihaizn@gmail.com"},{"name":"rjrodger","email":"richard.rodger@nearform.com"},{"name":"tswaters","email":"tyler.waters@gmail.com"},{"name":"wyatt","email":"wpreul@gmail.com"}],"readmeFilename":"README.md","time":{"modified":"2017-06-13T14:25:45.513Z","created":"2013-11-06T13:14:20.547Z","0.1.0":"2013-11-06T13:14:24.287Z","0.1.1":"2014-01-28T07:35:33.648Z","0.1.3":"2014-04-10T13:52:43.687Z","0.2.0":"2014-07-13T06:28:26.613Z","0.2.1":"2014-07-25T00:05:48.085Z","0.2.2":"2014-09-30T08:57:19.254Z","0.3.0":"2015-01-26T18:16:29.567Z","0.3.1":"2015-01-29T18:57:52.097Z","0.3.2":"2015-02-01T11:39:06.525Z","0.3.3":"2015-02-01T20:30:15.798Z","0.1.4":"2015-06-10T16:49:28.099Z","0.4.0":"2015-06-12T15:34:59.479Z","0.4.1":"2015-06-15T14:41:52.227Z","0.4.2":"2015-06-21T23:59:34.815Z","0.4.3":"2015-07-09T15:00:41.700Z","0.4.4":"2015-11-18T22:54:31.142Z","0.5.0":"2016-01-13T19:43:00.918Z","0.6.0":"2016-01-28T22:09:11.876Z","0.7.0":"2016-02-03T17:54:24.414Z","0.7.1":"2016-02-18T19:18:23.893Z","0.8.0":"2016-07-23T06:59:27.225Z","1.0.0":"2016-09-11T22:26:53.216Z","2.0.0":"2016-10-01T08:48:05.019Z","2.1.0":"2017-06-13T14:25:45.513Z"},"users":{"rjrodger":true,"stevenzeiler":true,"tmurngon":true}}}