{"name":"btrz-service-req-res","version":"1.6.2","description":"HTTP request/response related utilities for Betterez APIs","main":"index.js","scripts":{"test":"NODE_ENV=test node_modules/istanbul/lib/cli.js cover node_modules/mocha/bin/_mocha -- --ui bdd -t 5000 test/*.js","test-w":"NODE_ENV=test node_modules/mocha/bin/mocha -w  test/*.js","publish":"publish"},"repository":"https://github.com/Betterez/btrz-service-req-res","keywords":["request","response","handlers","http"],"license":"MIT","homepage":"https://github.com/Betterez/btrz-service-req-res#readme","dependencies":{"express-mung":"^0.4.2"},"devDependencies":{"chai":"latest","istanbul":"^0.4.1","mocha":"latest","publish":"^0.5.0"},"versions":[{"number":"1.0.0","date":"2016-01-19T19:08:52.924Z"},{"number":"1.1.0","date":"2016-01-22T19:35:15.023Z"},{"number":"1.2.0","date":"2016-02-01T16:30:20.021Z"},{"number":"1.3.0","date":"2016-02-03T12:46:26.016Z"},{"number":"1.3.1","date":"2016-03-08T15:01:10.067Z"},{"number":"1.4.0","date":"2016-03-21T19:03:56.042Z"},{"number":"1.4.1","date":"2016-05-18T19:49:20.585Z"},{"number":"1.5.0","date":"2016-05-24T19:36:14.486Z"},{"number":"1.5.1","date":"2016-05-25T16:57:40.544Z"},{"number":"1.5.2","date":"2016-05-27T13:12:55.982Z"},{"number":"1.5.3","date":"2016-05-27T13:46:05.235Z"},{"number":"1.5.4","date":"2016-08-12T17:34:55.689Z"},{"number":"1.6.0","date":"2016-11-29T16:03:03.747Z"},{"number":"1.6.1","date":"2016-11-29T18:51:52.683Z"},{"number":"1.6.2","date":"2016-11-29T19:41:02.851Z"}],"readme":"btrz-service-req-res\n====================\n\nHTTP request/response related utilities for Betterez APIs\n\nUtilities:\n\n* Swagger request handler formatter\n\nGenerates a definition for swagger including a request handler and it's schema.\n\nAn example Handler Class must implement \"getSpec()\" and \"handler(req, res)\" methods, like:\n\n    class RequestHandler {\n      getSpec () {\n        return {\n          \"description\" : \"endpoint description\",\n          \"path\" : \"/endpoint\",\n          \"summary\" : \"endpoint summary\",\n          \"method\": \"POST\",\n          \"parameters\": [\n            this.swagger.paramTypes.body(\"items\", \"the items\", \"Schema\", null, true),\n          ],\n          \"produces\" : [\"application/json\"],\n          \"type\" : \"Schema\",\n          \"errorResponses\" : [],\n          \"nickname\" : \"nick\"\n        };\n      }\n      handler (req, res) {\n        .... request handler code ...\n      }\n    }\n\nSo to generate the swagger request handler:\n\n    let swaggerRequestHandler = require(\"btrz-service-req-res\").swaggerRequestHandler;\n    let handler = new RequestHandler();\n    let swaggerHandler = swaggerRequestHandler(handler);\n\nJust like in Express with Connect, \"multiple callback functions that behave just like middleware\" can be given to swaggerRequestHandler, and they will be called one after the other.\nMiddleware callbacks must have the following signature: function (req, res, next)\nThe last argument of swaggerRequestHandler must always be a Handler instance implementing \"getSpec()\" and \"handler(req, res)\" methods. \nAn example:\n\n    let swaggerRequestHandler = require(\"btrz-service-req-res\").swaggerRequestHandler;\n    let handler = new RequestHandler();\n    let swaggerHandler = swaggerRequestHandler(passportAuthenticate, otherMiddleware, handler);\n\n* Success/Error handlers\n\nSuccess handler expects data to be send with 200 OK status code.\n\nError handler expects an Error (or a ValidationError, see below). And responds with the error message and status code 400 (status code can be overriden, see below).\n\nSample usage:\n\n    class RequestHandler {\n      getSpec () {\n       .......\n      }\n      handler (req, res) {\n       doSomethingAsync(req.body)\n         .then(function () {\n          return doSomethingElse();\n        })\n        .then(ResponseHandlers.success(res))\n        .catch(ResponseHandlers.error(res));\n     }\n    }\n\nNotice that ResponseHandlers.success and ResponseHandlers.error both expect the response object, and return a function.\n\nNotice that ResponseHandlers.success and ResponseHandlers.error must be added at the end of the promises chain, and only once.\n\n* Swagger Schema Validation\n\nValidates a body against a handler schema (a schema like the one in getSpec() above).\nReturns an array of ValidationErrors with any schema mismatch.\n  \n    let validateSwaggerSchema = require(\"btrz-service-req-res\").validateSwaggerSchema;\n    validateSwaggerSchema(validatorFunction, handlerSpec, schemaModelsDefinitionJSON, requestObject)\n\n* ValidationError error type\n\nSubclass of Error, supporting an error code, message, and HTTP status override.\nUsage:\n\n    throw new ValidationError(errorCode, message, statusCode);\n    throw new ValidationError(\"CODE\", \"readable message\", 418)\n\nThe Error request handler will catch any error and send a 500 response with the message.\n\nIf it recieves a ValidationError or an array of ValidationErrors, it will send a response with the message and status code 400.\n\nTo change the HTTP status code, throw a validation error like:\n\n    throw new ValidationError(errorCode, message, statusCode);\n\nfor example:\n\n    throw new ValidationError(\"NO_CART\", \"Cart not found\", 404);\n\n","created":"2016-01-19T19:08:52.924Z","modified":"2016-11-29T19:41:02.851Z","lastPublisher":{"name":"betterez","email":"support@betterez.com"},"owners":[{"name":"betterez","email":"support@betterez.com"}],"other":{"_attachments":{},"_from":".","_id":"btrz-service-req-res","_nodeVersion":"4.2.4","_npmOperationalInternal":{"host":"packages-12-west.internal.npmjs.com","tmp":"tmp/btrz-service-req-res-1.6.2.tgz_1480448460708_0.35505567281506956"},"_npmUser":{"name":"betterez","email":"support@betterez.com"},"_npmVersion":"2.15.11","_rev":"4-9996199b478df4db8f3348c5416daf03","_shasum":"9d763bd02da89fe46b3ec38ed95b8c1d05582134","author":{"name":"Betterez"},"bugs":{"url":"https://github.com/Betterez/btrz-service-req-res/issues"},"directories":{},"dist-tags":{"latest":"1.6.2"},"dist":{"shasum":"9d763bd02da89fe46b3ec38ed95b8c1d05582134","tarball":"http://registry.npmjs.org/btrz-service-req-res/-/btrz-service-req-res-1.6.2.tgz"},"maintainers":[{"name":"betterez","email":"support@betterez.com"}],"readmeFilename":"README.md","time":{"modified":"2016-11-29T19:41:02.851Z","created":"2016-01-19T19:08:52.924Z","1.0.0":"2016-01-19T19:08:52.924Z","1.1.0":"2016-01-22T19:35:15.023Z","1.2.0":"2016-02-01T16:30:20.021Z","1.3.0":"2016-02-03T12:46:26.016Z","1.3.1":"2016-03-08T15:01:10.067Z","1.4.0":"2016-03-21T19:03:56.042Z","1.4.1":"2016-05-18T19:49:20.585Z","1.5.0":"2016-05-24T19:36:14.486Z","1.5.1":"2016-05-25T16:57:40.544Z","1.5.2":"2016-05-27T13:12:55.982Z","1.5.3":"2016-05-27T13:46:05.235Z","1.5.4":"2016-08-12T17:34:55.689Z","1.6.0":"2016-11-29T16:03:03.747Z","1.6.1":"2016-11-29T18:51:52.683Z","1.6.2":"2016-11-29T19:41:02.851Z"}}}