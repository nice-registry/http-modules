{"name":"http-monitor","version":"0.3.5","description":"Monitor an http application, and invoke if the server status changes. Both a module and a commandline tool.","main":"index.js","repository":"https://github.com/freeall/http-monitor","dependencies":{"httpcheck":"~0.2.0","optimist":"~0.6.0","parse-duration":"~0.1.0"},"devDependencies":{"tap":"~0.4.8","request":"~2.33.0"},"scripts":{"test":"tap test/index.js","test-server":"node test/server.js"},"bin":{"http-monitor":"bin/http-monitor"},"keywords":["http","monitor","https","uptime","check","checker","ping","pinger","listen","exec","execute","command"],"license":"MIT","homepage":"https://github.com/freeall/http-monitor","versions":[{"number":"0.0.1","date":"2014-01-17T09:12:15.383Z"},{"number":"0.1.0","date":"2014-01-21T15:43:20.754Z"},{"number":"0.2.0","date":"2014-01-22T12:44:53.931Z"},{"number":"0.3.0","date":"2014-01-23T10:51:46.715Z"},{"number":"0.3.1","date":"2014-01-23T11:02:37.594Z"},{"number":"0.3.2","date":"2014-01-23T12:36:57.321Z"},{"number":"0.3.3","date":"2014-01-23T13:00:33.355Z"},{"number":"0.3.4","date":"2014-01-23T13:43:09.092Z"},{"number":"0.3.5","date":"2014-02-04T12:06:23.608Z"}],"readme":"# http-monitor [![build status](https://secure.travis-ci.org/freeall/http-monitor.png)](http://travis-ci.org/freeall/http-monitor)\n\nCheck if a server is running. Is both a module and an executable.\n\nWill report an error if there is the statuscode is 4xx, 5xx or if the server doesn't respond.\n\n## Installation\n\n\tnpm install -g http-monitor\n\n## Usage (command-line)\n\nWith the commandline tool you can set up commands that will be executed when the status of the server changes:\n\n* The server responds with a 4xx or 5xx error code\n* The server doesn't respond (no reply)\n* The server recovers after some time where it errored\n\nThe commands will only be called once if the state of the server changes. Like this scenario:\n\n\tThe server is running perfectly for 3 days, but now stops replying.  \n\tThis will cause the on-connection-error to be executed once.  \n\tAfter 30 minutes the server starts to reply again, and then the on-recovery command is executed once.\n\n```\nhttp-monitor http://localhost:12345/foo\n\t--on-http-error \"command...\"       # When there is a 4xx or 5xx response code\n\t--on-connection-error \"command...\" # When there is a connection errror (no reply) from the server\n\t--on-error \"command...\"            # When either a connection/http error occur\n\t--on-recovery \"command...\"         # When the server recovers after a period with errors\n\t--interval 5min                    # How often to check\n\t--retries 4                        # How many times to retry\n\t--allow 501                        # Allow a 4xx or 5xx code which would otherwise cause an error\n\t--disallow 301                     # Disallow a 1xx, 2xx, or 3xx code which wouldn't otherwise cause an error\n\t--once                             # Only run once, then call callback and exit\n ```\n\nThe `\"command...\"` part is a command you want executed when an error occurs. You can use `%url`, `%statuscode`, and `%body` in this. e.g. `--on-http-error \"call 1234567890 Hi Bill. Server crashed, %url. Returned %statuscode and %body\"`.\n\n## Usage (module)\n\n### Example\n\n``` js\nvar monitor = require('http-monitor');\n\nmonitor('http://localhost:13532/', {\n\tretries: 1\n}).on('http-error', function(err) {\n\tconsole.log('The server returned a '+err.statusCode+' statuscode, with the body:'+err.body);\n}).on('connection-error', function() {\n\tconsole.log('The server could not be reached');\n}).on('error', function(err) {\n\tconsole.log('This is triggered on both http-error and connection-error');\n}).on('recovery', function() {\n\tconsole.log('The server just recovered after downtime');\n});\n```\n\n### Stopping the monitoring\n\nThe `monitor` function returns a stop-function. Call this to stop the monitor.\n\n``` js\nvar monitor = require('http-monitor');\n\nvar localhost = monitor('http://localhost:13532/', {\n\tretries: 1\n});\n\nsetTimeout(function() {\n\t// Stop the monitor after 60 seconds\n\tlocalhost.destroy();\n}, 60000);\n```\n\n### Options\n\n#### interval (miliseconds)\n\nHow many miliseconds to wait between the checks. Default is `5000`.\n\n#### retries (integer)\n\nHow many tries in a row that should fail before it will call the callback with an error. Default is `1`.\n\n#### timeout (integer)\n\nHow many miliseconds should each request maximum take before it is seen as an error. Default is `30000`.\n\n#### allowed (array)\n\nAs default http-monitor will call the callback with an error if the server returned a 4xx or 5xx status code. This allows http-monitor to allow certain error codes. `[501, 502]` would allow the server to return 501 and 502. Default is `[]`.\n\n#### disallowed (array)\n\nAs default http-monitor will call the callback without an error if the server returned a 1xx, 2xx, or 3xx status code. Use this to disallow certain error codes and call the callback with an error. `[301, 307]` would disallow the server to return 301 and 307. Default is `[]`.\n\n#### once (bool)\n\nNormally http-monitor will keep pinging the server at the url, but if you set once to true, then it will only happen once and after the callback has been called the first time, it will stop. Default is `false`.\n","starsCount":1,"created":"2014-01-17T09:12:14.501Z","modified":"2014-02-04T12:06:23.608Z","lastPublisher":{"name":"freeall","email":"freeall@gmail.com"},"owners":[{"name":"freeall","email":"freeall@gmail.com"}],"other":{"_attachments":{},"_from":".","_id":"http-monitor","_npmUser":{"name":"freeall","email":"freeall@gmail.com"},"_npmVersion":"1.3.14","_rev":"1-ceaed1ceca711400de95112deee96172","bugs":{"url":"https://github.com/freeall/http-monitor/issues"},"directories":{},"dist-tags":{"latest":"0.3.5"},"dist":{"shasum":"8c8292bdfd0348764710f477c9ca6dfada92bc20","tarball":"http://registry.npmjs.org/http-monitor/-/http-monitor-0.3.5.tgz"},"maintainers":[{"name":"freeall","email":"freeall@gmail.com"}],"readmeFilename":"README.md","time":{"modified":"2014-02-04T12:06:23.608Z","created":"2014-01-17T09:12:14.501Z","0.0.1":"2014-01-17T09:12:15.383Z","0.1.0":"2014-01-21T15:43:20.754Z","0.2.0":"2014-01-22T12:44:53.931Z","0.3.0":"2014-01-23T10:51:46.715Z","0.3.1":"2014-01-23T11:02:37.594Z","0.3.2":"2014-01-23T12:36:57.321Z","0.3.3":"2014-01-23T13:00:33.355Z","0.3.4":"2014-01-23T13:43:09.092Z","0.3.5":"2014-02-04T12:06:23.608Z"},"users":{"michelmelo":true}}}