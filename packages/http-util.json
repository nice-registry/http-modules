{"name":"http-util","version":"0.1.4","description":"Miscellaneous HTTP gimmicks","repository":"https://github.com/biril/http-util","license":"MIT","keywords":["http","https","util","request","proxy","stream"],"dependencies":{"colors":"^1.1.2","underscore":"^1.8.3"},"devDependencies":{"concat-stream":"^1.5.2","eslint":"^3.7.1","jasmine-node":"^1.14.5","nock":"^8.1.0"},"scripts":{"lint":"eslint --quiet --config .eslintrc.json ./lib/*","test":"jasmine-node --verbose --color ./test/spec/"},"engines":{"node":">=0.12"},"gitHead":"5a46986b7b25f3358f00261e236cb1234f51ab20","homepage":"https://github.com/biril/http-util#readme","versions":[{"number":"0.1.0","date":"2013-06-28T17:16:46.247Z"},{"number":"0.1.1","date":"2013-06-28T18:22:46.688Z"},{"number":"0.1.2","date":"2013-06-30T00:09:25.874Z"},{"number":"0.1.3","date":"2016-10-11T21:32:25.502Z"},{"number":"0.1.4","date":"2016-11-05T16:43:06.208Z"}],"readme":"HTTP Util\n=========\n\n[![Build Status](https://travis-ci.org/biril/http-util.png)](https://travis-ci.org/biril/http-util)\n[![NPM version](https://badge.fury.io/js/http-util.png)](http://badge.fury.io/js/http-util)\n\n\nAuthor's HTTP/S toolbox for Node.js. A compact collection of helpers especially applicable to\nstreaming, proxying, etc. Evolved from (and meant as a DRY replacement for) a number of common Node\npatterns. Currently focused on debuggability rather than performance.\n\n\nSet up\n------\n\n`git clone git://github.com/biril/http-util` or `npm install http-util` and `require`:\n\n```javascript\nvar httpUtil = require(\"http-util\");\nconsole.log(\"HTTP Util version: \" + httpUtil.version);\n```\n\n\nReference\n---------\n\nThe module's public API consists primarily of the `request` and `forward` methods which are\ndescribed here. An [annotated version](http://biril.github.io/http-util/) of the source is also\nmaintained as a complete reference.\n\n### request (url, rspOrStr[, opts]) â†’ http.ClientRequest\n\nMake a request to some given host (the 'origin-server') and write received data into given\n`rspOrStr` - a `stream.Writable` or `http.ServerResponse`.\n\nThe `url` parameter is the _absolute_ URL of the resource to be requested. This may be a plain\n string or a URL object.\n\nThe `opts` parameter indicates further options. None of these is mandatory as they all default to\n sane values. [Note that in the following, 'response' does _not_ refer to the given `rspOrStr` but\n rather at the response received from the origin-server. This isn't accessible to API consumers so\n they need not be concerned with it. It nevertheless referred to, for clarification purposes. A\n request argument passed as `rspOrStr` will always be refered to as 'request-from-client'.]\n\n* `method`: Request method - an HTTP verb. 'GET' by default\n* `headers`: A hash of request headers. This may empty as 'host' (the only mandatory header\n    in HTTP/1.1) will be derived from given `url` if absent. Special headers that should be\n    noted are described in\n    [Node docs](http://nodejs.org/api/http.html#http_http_request_options_callback).\n* `maxContentLength`: The maximum allowed length for the received content. Lengthier responses will\n    be truncated. Optional (& experimental) - no max by default.\n* `followRedirects`: Indicates whether redirects should be silently followed, up until the request\n    reaches the origin-server (instead of interpreting the first redirect as a response-to-client).\n    Enabling this will buffer the request's content so that it may be resent on subsequent,\n    post-redirect requests. (This should especially be noted in cases where the request carries\n    sizable content.) False by default.\n* `onResponse`: Invoked, only once, when a response is first received. It will be passed the\n    response's status-code and headers. In the case where `rspOrStr` is an `http.ServerResponse`,\n    the caller may modify the received headers or inject new ones prior to them being written\n* `onResponseContent`: Invoked, only once, either when response content is first received or, if\n    there's no content for the response, when the response ends. Note that the handler is invoked\n    *before* the content is written to given stream / response-to-client. The received data chunk\n    (if there is one involved) is passed to the handler.\n* `onClose`: Invoked when the underlying connection to the origin-server is terminated before the\n    response ends or is able to flush. The caller may choose to abort the request in case it hasn't\n    already ended.\n* `onError`: Invoked in the event of a response-related error. The caller may choose to abort the\n    request in case it hasn't already ended. Note that the caller should primarily listen for errors\n    on the returned `http.ClientRequest` object.\n\nReturns the request made - an `http.ClientRequest`. This is in line with Node's\n [http.request](http://nodejs.org/api/http.html#http_http_request_options_callback): The request\n object may be used to push content to the origin-server, for example as part of a POST. The caller\n should always `end()` it (whether it writes any content to the body or not). In the event of an\n error during the request (be that with DNS resolution, TCP level errors, or actual HTTP parse\n errors) it will emit an 'error' event which the caller is expected to handle.\n\n\n### forward (request, response[, opts])\n\nForward a client request (`http.IncomingMessage`) to indicated server (the 'origin-server') and\n write received data into given response (`http.ServerResponse`). Particularly applicable in\n proxying scenarios\n\nThe `opts` parameter includes all options applicable to the request method with the (nonmandatory)\n addition of a `url` option:\n\n* In absense of this, requests will be forwarded to the original URL, i.e. `request.url`. Suitable\n   for authoring a forward proxy.\n* If `opts.url` is present, the request's original URL will be overriden, effectively forwarding to\n   a different host. This will also force an appropriately modified 'host' header derived from the\n   given URL. The caller may enforce a _specific_ 'host' by use of `opts.headers`. This method of\n   forwarding is suited to authoring a reverse proxy.\n\nIt should be noted that in the case of `forward`, the headers provided by use of `opts.headers` act\n as overrides. That is to say, the forwarded request will include _all_ of the original request's\n headers, either extended or overriden by those present in `opts.headers`. \n\n\nExamples\n--------\n\n\n### Forward proxy\n\n```javascript\nvar http = require(\"http\"),\n    httpUtil = require(\"http-util\");\n\nhttp.createServer(function (req, rsp) {\n    httpUtil.forward(req, rsp);\n}).listen(8080);\n```\n\n\n### Forward proxy with custom logic\n\nFake Googlebot:\n\n```javascript\nvar http = require(\"http\"),\n    httpUtil = require(\"http-util\");\n\nhttp.createServer(function (req, rsp) {\n    httpUtil.forward(req, rsp, {\n        headers: {\n        \t\"user-agent\": \"Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)\"\n        }\n    });\n}).listen(8080);\n```\n\nDisallow inferior search engines:\n\n```javascript\nvar http = require(\"http\"),\n\tparseUrl = require(\"url\").parse,\n    httpUtil = require(\"http-util\");\n\nhttp.createServer(function (req, rsp) {\n    httpUtil.forward(req, rsp, {\n        url: req.url.replace(\"bing\", \"google\"),\n        onResponse: function (statusCode, headers) {\n            headers[\"friendly-tip\"] = \"use google\";\n        }\n    });\n}).listen(8080);\n```\n\n\n### Reverse proxy\n\n// TODO\n\n\n### Fetching a resource\n\nDownload google's front-page HTML. Note the necessary `followRedirects` option.\n\n```javascript\nvar httpUtil = require(\"http-util\"),\n    file = require(\"fs\").createWriteStream(__dirname + \"/google.html\", { flags: \"w\" });\n\nhttpUtil.request(\"http://google.com\", file, {\n    followRedirects: true\n}).end();\n```\n\n\nTesting\n-------\n\n`make test` or `npm test`.\n\n\nLicense\n-------\n\nLicensed and freely distributed under the MIT License (LICENSE.txt).\n\nCopyright (c) 2012-2016 Alex Lambiris\n","created":"2013-06-28T17:16:17.959Z","modified":"2016-11-05T16:43:06.208Z","lastPublisher":{"name":"biril","email":"alexlambiris@gmail.com"},"owners":[{"name":"biril","email":"alexlambiris@gmail.com"}],"other":{"_attachments":{},"_from":".","_id":"http-util","_nodeVersion":"7.0.0","_npmOperationalInternal":{"host":"packages-18-east.internal.npmjs.com","tmp":"tmp/http-util-0.1.4.tgz_1478364185641_0.17536985035985708"},"_npmUser":{"name":"biril","email":"alexlambiris@gmail.com"},"_npmVersion":"3.10.8","_rev":"2-fbf4ab66a7a10e40383a82b1b2dc473d","_shasum":"b3dcd55687627b1d3d009b0fbd24ead6d6ce2785","author":{"name":"biril","email":"alexlambiris@gmail.com"},"bugs":{"url":"https://github.com/biril/http-util/issues"},"contributors":[],"directories":{"test":"test"},"dist-tags":{"latest":"0.1.4"},"dist":{"shasum":"b3dcd55687627b1d3d009b0fbd24ead6d6ce2785","tarball":"http://registry.npmjs.org/http-util/-/http-util-0.1.4.tgz"},"maintainers":[{"name":"biril","email":"alexlambiris@gmail.com"}],"readmeFilename":"README.md","time":{"modified":"2016-11-05T16:43:06.208Z","created":"2013-06-28T17:16:17.959Z","0.1.0":"2013-06-28T17:16:46.247Z","0.1.1":"2013-06-28T18:22:46.688Z","0.1.2":"2013-06-30T00:09:25.874Z","0.1.3":"2016-10-11T21:32:25.502Z","0.1.4":"2016-11-05T16:43:06.208Z"}}}