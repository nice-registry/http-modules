{"name":"ocbesbn-service-client","version":"1.0.23","description":"Module for http based inter-service-communication for OpusCapitaBusinessNetwork.","main":"index.js","scripts":{"start":"npm run test","test":"npm run clean ; ${NODE_PATH}/.bin/nyc ${NODE_PATH}/.bin/mocha --timeout 30000 -R mocha-junit-reporter","test-raw":"npm run clean ; ${NODE_PATH}/.bin/nyc ${NODE_PATH}/.bin/mocha --timeout 30000","test-coverage":"${NODE_PATH}/.bin/nyc --reporter=lcov ${NODE_PATH}/.bin/mocha --timeout 30000 && sed -i 's/\\/home\\/node\\/service-client\\//\\.\\//g' coverage/lcov.info","upload-coverage":"cat ./coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","clean":"${NODE_PATH}/.bin/rimraf .nyc_output coverage test-results.xml","doc":"${NODE_PATH}/.bin/jsdoc2md index.js > wiki/Home.md"},"repository":"https://github.com/OpusCapitaBusinessNetwork/service-client","keywords":["inter-service-communication","http","REST"],"license":"Apache-2.0","homepage":"https://github.com/OpusCapitaBusinessNetwork/service-client#readme","dependencies":{"bluebird":"^3.5.0","bluebird-retry":"^0.10.1","body-parser":"^1.17.2","express":"^4.15.3","extend":"^3.0.1","ocbesbn-cache":"^1.0.4","ocbesbn-config":"^2.2.7","ocbesbn-logger":"^1.0.2","redis":"^2.7.1"},"devDependencies":{"coveralls":"^2.12.0","jsdoc-to-markdown":"^3.0.0","mocha":"^3.2.0","mocha-junit-reporter":"^1.12.1","nyc":"^10.1.2","rimraf":"^2.6.0"},"versions":[{"number":"0.1.0","date":"2017-03-03T14:24:31.907Z"},{"number":"0.1.1","date":"2017-03-08T10:17:49.973Z"},{"number":"0.1.2","date":"2017-03-08T13:25:49.760Z"},{"number":"0.1.3","date":"2017-03-21T16:13:32.665Z"},{"number":"0.1.4","date":"2017-03-22T12:40:01.898Z"},{"number":"0.1.5","date":"2017-03-22T12:52:38.183Z"},{"number":"0.1.6","date":"2017-03-22T13:06:22.276Z"},{"number":"0.1.7","date":"2017-03-24T11:14:31.155Z"},{"number":"0.1.8","date":"2017-03-24T11:32:52.913Z"},{"number":"0.1.9","date":"2017-03-27T11:51:25.908Z"},{"number":"0.1.10","date":"2017-04-05T13:38:43.131Z"},{"number":"0.1.11","date":"2017-04-13T07:09:19.611Z"},{"number":"0.1.12","date":"2017-04-13T07:41:38.046Z"},{"number":"0.1.13","date":"2017-04-13T08:15:33.906Z"},{"number":"0.1.14","date":"2017-04-13T08:28:00.851Z"},{"number":"0.1.15","date":"2017-04-13T08:49:02.832Z"},{"number":"0.1.16","date":"2017-04-13T11:46:44.076Z"},{"number":"1.0.0","date":"2017-04-13T14:01:00.383Z"},{"number":"1.0.1","date":"2017-04-19T07:43:54.250Z"},{"number":"1.0.2","date":"2017-05-12T09:02:37.228Z"},{"number":"1.0.3","date":"2017-05-12T10:25:12.233Z"},{"number":"1.0.4","date":"2017-05-15T07:45:37.485Z"},{"number":"1.0.5","date":"2017-05-15T08:37:43.926Z"},{"number":"1.0.6","date":"2017-06-07T08:44:36.919Z"},{"number":"1.0.7","date":"2017-06-07T08:57:53.570Z"},{"number":"1.0.8","date":"2017-06-09T15:03:31.146Z"},{"number":"1.0.9","date":"2017-06-12T11:46:17.094Z"},{"number":"1.0.10","date":"2017-06-12T12:18:11.838Z"},{"number":"1.0.11","date":"2017-06-12T13:13:39.815Z"},{"number":"1.0.12","date":"2017-06-13T07:56:26.595Z"},{"number":"1.0.13","date":"2017-06-13T08:12:52.966Z"},{"number":"1.0.14","date":"2017-06-13T11:23:20.126Z"},{"number":"1.0.15","date":"2017-06-13T15:00:13.555Z"},{"number":"1.0.16","date":"2017-06-13T15:21:31.979Z"},{"number":"1.0.17","date":"2017-06-19T08:15:06.772Z"},{"number":"1.0.18","date":"2017-06-21T09:52:22.058Z"},{"number":"1.0.19","date":"2017-06-21T10:14:22.047Z"},{"number":"1.0.20","date":"2017-06-22T10:37:13.829Z"},{"number":"1.0.21","date":"2017-06-22T15:01:19.018Z"},{"number":"1.0.22","date":"2017-06-23T18:14:41.770Z"},{"number":"1.0.23","date":"2017-06-23T18:50:15.129Z"}],"readme":"# ocbesbn-service-client\n[![Coverage Status](https://coveralls.io/repos/github/OpusCapitaBusinessNetwork/service-client/badge.svg?branch=master&rand=2)](https://coveralls.io/github/OpusCapitaBusinessNetwork/service-client?branch=master&rand=1)\n![Build status](https://circleci.com/gh/OpusCapitaBusinessNetwork/service-client.svg?style=shield&circle-token=0db8535ca279a541e26aea88b0dd14fbd46e4790)\n\n**WARNING:** Starting with **version 1.0**, calls to the methods .get(), .post(), .put(), .patch() and .delete() will resolve and reject the returned promises in a different way that is **not compatible** to prior versions anymore. In order to be able to  rate a server response in an enhanced way, **resolved** promises get an array passed as input value containing two indexes. The first array **index (0)** inside represents the **result body** sent by the remote server. The second **index (1)** represents a light-weight **response object** containing status code and headers sent. **Rejected** promises are getting an **Error object** as usual containing the original (unparsed) **result body** inside their **message property**. And additional property called **response** provides status code and header sent.\n\n---\n\nThis module provides a simple client class for inter-service communication for OpusCapita Business Network.\nIt is used for easily accessing remote HTTP services and is designed to use Consul in order to\ndynamically get endpoint configurations to access the target service requested.\n\nTo have a look at the full API, please visit the related [wiki page](https://github.com/OpusCapitaBusinessNetwork/service-client/wiki).\n\n\n### Minimum setup\nFirst got to your local code directory and run:\n```\nnpm install ocbesbn-service-client\n```\nTo go with the minimum setup, you need to have access to a running Consul server to get your endpoint configuration. Additionally you need a running web server to use the ServiceClient class.\n\nIf all this is set up, go to you code and add the following command:\n\n```JS\nconst ServiceClient = require('ocbesbn-service-client');\n\nvar client = new ServiceClient({ consul : { host : '{{your-consul-host}}' } });\n\n// main => name of service endpoint in Consul.\n// / => path to access on the web server.\nclient.get('main', '/').spread((result, response) => console.log(result, response));\n\n// example: response contains an error.\nclient.get('main', '/invalid').catch(e => console.log(e.message, e.response.statusCode));\n```\n\n---\n\n### Result and Response objects\n\n#### On resolve\nWhen a returned request promise is **resolved**, two objects are passed as the result. The **first** contains the **actual object returned** from the server, the **second** contains information about the **response context**. This object is defined like this:\n\n```JS\nresponseObject = {\n    statusCode : response.statusCode, // HTTP status code.\n    headers : response.headers, // Array of HTTP headers.\n    result : resultData // Instance of the actual result object.\n}\n```\n\n#### On reject\nId a returned request promise gets **rejected**, an Error object is passed to the catch methods available. The passed object **gets extended by a response key** containing a response object like defined above.\n\n---\n\n### Origin service based authentication\nServiceClient allows using a service based **authentication** for service to service calls so an origin service can log-in using its **own security credentials**. To do calls using service credentials, you have to pass the **forceServiceToken** parameter to either of the request methods.\n\nFor configuration details see the **originService** key under [DefaultConfig](#default-configuration).\n\nIn order to use the consul configuration here, you have to provide the following keys set up in consul:\n\n* {{your-service-name}}/service-client/client-username\n* {{your-service-name}}/service-client/client-password\n* {{your-service-name}}/service-client/scope\n* {{your-service-name}}/service-client/client-key\n* {{your-service-name}}/service-client/client-secret\n\nThe following keys are optional:\n\n* {{your-service-name}}/originService/authService/name\n\n---\n\n### Default configuration\n\nThe default configuration object provides hints about what the module's standard behavior is like.\n\n```JS\n{\n    mode : process.env.NODE_ENV === 'development' ? ServiceClient.Mode.Dev : ServiceClient.Mode.Productive,\n    serializer : JSON.stringify,\n    parser : JSON.parse,\n    parserContentType : 'application/json',\n    serializerContentType : 'application/json',\n    alwaysResolveResponses : false,\n    logger : null,\n    consul : {\n        host : 'consul'\n    }\n    additionalHeaders : {\n        'Content-Type' : 'application/json',\n        'X-Service-Type' : 'ocbesbn'\n    },\n    context : {\n        headers : { }\n    },\n    caching : {\n        driver : 'dummy',\n        defaultExpire : 600\n    },\n    originService: {\n        getConfigFromConsul : true,\n        authService : {\n            name : 'auth'\n        },\n        username : null,\n        password : null,\n        scope : null,\n        clientKey : null,\n        clientSecret : null,\n        scope : 'id, roles',\n        tokenKey : 'X-USER-ID-TOKEN'\n    }\n}\n```\n","created":"2017-03-03T14:24:31.907Z","modified":"2017-06-23T18:50:15.129Z","lastPublisher":{"name":"kwierchris","email":"christian.drengenberg@opuscapita.com"},"owners":[{"name":"kwierchris","email":"christian.drengenberg@opuscapita.com"}],"other":{"_attachments":{},"_from":".","_id":"ocbesbn-service-client","_nodeVersion":"4.2.6","_npmOperationalInternal":{"host":"s3://npm-registry-packages","tmp":"tmp/ocbesbn-service-client-1.0.23.tgz_1498243814182_0.9770223482046276"},"_npmUser":{"name":"kwierchris","email":"christian.drengenberg@opuscapita.com"},"_npmVersion":"2.14.12","_rev":"41-dbe986b78e72270a7762552c2e11d01c","_shasum":"0a2596605975ec2ca5aa33e59df98655085823da","author":{"name":"Christian Drengenberg","email":"Christian.Drengenberg@opuscapita.com"},"bugs":{"url":"https://github.com/OpusCapitaBusinessNetwork/service-client/issues"},"directories":{},"dist-tags":{"latest":"1.0.23"},"dist":{"shasum":"0a2596605975ec2ca5aa33e59df98655085823da","tarball":"https://registry.npmjs.org/ocbesbn-service-client/-/ocbesbn-service-client-1.0.23.tgz"},"maintainers":[{"name":"kwierchris","email":"christian.drengenberg@opuscapita.com"}],"readmeFilename":"README.md","time":{"modified":"2017-06-23T18:50:15.129Z","created":"2017-03-03T14:24:31.907Z","0.1.0":"2017-03-03T14:24:31.907Z","0.1.1":"2017-03-08T10:17:49.973Z","0.1.2":"2017-03-08T13:25:49.760Z","0.1.3":"2017-03-21T16:13:32.665Z","0.1.4":"2017-03-22T12:40:01.898Z","0.1.5":"2017-03-22T12:52:38.183Z","0.1.6":"2017-03-22T13:06:22.276Z","0.1.7":"2017-03-24T11:14:31.155Z","0.1.8":"2017-03-24T11:32:52.913Z","0.1.9":"2017-03-27T11:51:25.908Z","0.1.10":"2017-04-05T13:38:43.131Z","0.1.11":"2017-04-13T07:09:19.611Z","0.1.12":"2017-04-13T07:41:38.046Z","0.1.13":"2017-04-13T08:15:33.906Z","0.1.14":"2017-04-13T08:28:00.851Z","0.1.15":"2017-04-13T08:49:02.832Z","0.1.16":"2017-04-13T11:46:44.076Z","1.0.0":"2017-04-13T14:01:00.383Z","1.0.1":"2017-04-19T07:43:54.250Z","1.0.2":"2017-05-12T09:02:37.228Z","1.0.3":"2017-05-12T10:25:12.233Z","1.0.4":"2017-05-15T07:45:37.485Z","1.0.5":"2017-05-15T08:37:43.926Z","1.0.6":"2017-06-07T08:44:36.919Z","1.0.7":"2017-06-07T08:57:53.570Z","1.0.8":"2017-06-09T15:03:31.146Z","1.0.9":"2017-06-12T11:46:17.094Z","1.0.10":"2017-06-12T12:18:11.838Z","1.0.11":"2017-06-12T13:13:39.815Z","1.0.12":"2017-06-13T07:56:26.595Z","1.0.13":"2017-06-13T08:12:52.966Z","1.0.14":"2017-06-13T11:23:20.126Z","1.0.15":"2017-06-13T15:00:13.555Z","1.0.16":"2017-06-13T15:21:31.979Z","1.0.17":"2017-06-19T08:15:06.772Z","1.0.18":"2017-06-21T09:52:22.058Z","1.0.19":"2017-06-21T10:14:22.047Z","1.0.20":"2017-06-22T10:37:13.829Z","1.0.21":"2017-06-22T15:01:19.018Z","1.0.22":"2017-06-23T18:14:41.770Z","1.0.23":"2017-06-23T18:50:15.129Z"}}}