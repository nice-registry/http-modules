{"name":"grab-http","version":"0.1.4","license":"Apache-2.0","description":"A promisified XMLHttpRequest with an API close to fetch","keywords":["grab","fetch","xmlhttprequest","request","network","ajax","promise"],"homepage":"https://github.com/pauldijou/grab","repository":"https://github.com/pauldijou/grab","main":"lib/node.js","browser":"lib/browser.js","scripts":{"clean":"rimraf lib","build":"babel src --out-dir lib","dist":"rimraf dist && webpack --config webpack.config.js --colors","prepublish":"npm run clean && npm run build","start":"npm run dist && node ./example/server.js","test":"karma start","ci":"karma start karma-ci.conf.js"},"dependencies":{"xmlhttprequest":"^1.7.0"},"devDependencies":{"webpack":"^1.12.0","babel":"^5.8.21","babel-loader":"^5.3.0","rimraf":"^2.4.3","express":"^4.13.3","body-parser":"^1.14.0","multer":"^1.0.5","cors":"^2.7.1","jasmine":"^2.3.0","karma":"^0.13.0","karma-jasmine":"^0.3.6","karma-chrome-launcher":"^0.2.0","karma-firefox-launcher":"^0.1.6","karma-ie-launcher":"^0.2.0","karma-safari-launcher":"^0.1.1","karma-webpack":"^1.7.0","karma-sauce-launcher":"^0.2.14","phantomjs":"1.9.17","node-libs-browser":">= 0.4.0 <=0.6.0","es6-promise":"^3.0.2","es5-shim":"^4.1.13","form-data":"1.0.0-rc3"},"gitHead":"0d7c5b64e38986d137f6140868d73fe4fb1e6eca","versions":[{"number":"0.1.0","date":"2015-09-22T15:16:55.199Z"},{"number":"0.1.1","date":"2015-09-22T15:40:52.194Z"},{"number":"0.1.2","date":"2015-09-23T09:59:47.097Z"},{"number":"0.1.3","date":"2015-09-23T15:35:11.516Z"},{"number":"0.1.4","date":"2015-09-29T10:30:16.520Z"}],"readme":"# grab\n\nA promisified XMLHttpRequest with an API close to fetch.\n\n## Install\n\n```bash\nnpm install grab-http --save\n```\n\n**Requirements**\n\nThe Promise API. You can use [any](https://github.com/jakearchibald/es6-promise) [polyfill](https://github.com/petkaantonov/bluebird) [you](https://github.com/kriskowal/q) want, just be sure it's present inside the window / global object. Browser support is now [pretty good](http://caniuse.com/#search=promise) (except IE).\n\nFor very old browsers, consider including a [ES5 shim](https://github.com/es-shims/es5-shim) for methods like `Object.keys`.\n\n**Dependencies**\n- Browser: none (only 400 LOC)\n- Node: [xmlhttprequest](https://www.npmjs.com/package/xmlhttprequest) (check [defaults.FormData](#defaults) if you need to use `FormData` in Node)\n\n**Features**\n- support old browsers\n- onProgress listener\n- timeout\n- cancel\n\n## Usage\n\n```javascript\nimport grab from 'grab-http';\n\n// GET /api/users?limit=10\ngrab('/api/users', { params: { limit: 10 }}).then(response => {\n  console.log(response.json());\n}).catch(error => {\n  console.error(error);\n});\n\n// POST /api/users\ngrab({method: 'POST', url: '/api/users', body: { name: 'Paul' }})\n  .then(response => console.log('User created'))\n  .catch(error => console.error(error));\n```\n\n## FAQ\n\n- **What's the point? There is the fetch API now.** That's true, and if that's fine with you, use it. But right now, `fetch` has too many limitations for some projects, like no progress nor abort like XMLHttpRequest.\n\n- **Is it the same API as fetch? Can I use it as a polyfill?** Not at all. It's quite close but not the same. For example, `cache` is just a boolean and not a string. All methods reading the response body are synchronous since there is no way to handle a XMLHttpRequest response asynchronously. Refer to the [API](#api) below for the full documentation.\n\n## API\n\n### grab(input, options)\n\n#### Parameters\n\n- **input**: either a string matching a valid url or an object used as the options parameter.\n- **options**: object containing the request configuration\n  - **url** (required if no  string input): a string containing the direct URL of the resource you want to grab.\n  - **method** (default: 'GET'): the request method, e.g., GET, POST.\n  - **body** (any): the body of the request. If JavaScript object, will be stringified and `Content-Type: application/json` header will be added\n  - **params** (object): a map of key/value which will be added to the query string\n  - **headers** (object): a map of key/value for all the request headers\n  - **timeout** (number): the number of milliseconds before stopping the request, rejecting it with a TimeoutError.\n  - **cancel** (Promise): when this promise is resolved, it will stop the request, rejecting it with a CancelError.\n  - **credentials** (boolean): flag for `xhr.withCredentials`\n  - **responseType** (string): assigned to `xhr.responseType`\n  - **onProgress** (function): a function called by the XMLHttpRequest with a [progress event](https://developer.mozilla.org/en-US/docs/Web/Events/progress).\n  - **urlEncoded** (boolean): if true, body objects will be serialized as form url encoded and `Content-Type: application/x-www-form-urlencoded` will be added.\n  - **username** (string): optional user name to use for authentication purposes.\n  - **password** (string): optional password to use for authentication purposes.\n\n#### Returns\n\nA promise that will eventually be resolved with a [Response](#response) object. This promise has a bonus method `cancel` that will abort the XMLHttpRequest if called. This method is not transitive, if you chain the promise, you will lose it.\n\n### Response\n\n#### Attributes\n\n- **type**: contains the type of the response . Always 'default' right now\n- **status**: contains the status code of the response (e.g., 200 for a success).\n- **statusText**: contains the status message corresponding to the status code (e.g., OK for 200).\n- **ok**: contains a boolean stating whether the response was successful (status in the range 200-299) or not.\n- **headers**: contains all headers associated with the response as a map object of key/value.\n- **body**: contains the raw body of the response.\n\n#### Methods\n\n- **text()**: return the raw body as string.\n- **json()**: return the body as a JavaScript object (using JSON.parse).\n- **formData()**: return the body as a FormData instance if possible.\n\n### Defaults\n\nYou can override or add any default parameter using `grab.defaults`.\n\n- **method** (string): `GET`\n- **log** (function): empty. See [logging section](#logging).\n- **timeout** (number): `0`\n- **headers** (object): `{}`\n- **cache** (boolean): `false` in most case except for some IE.\n- **base** (string): `''`\n- **credentials** (boolean): `false`\n- **FormData** (object): `window.FormData` in the browser and `undefined` in Node.You can assign [any implementation](https://www.npmjs.com/package/form-data) you want if you need to use `FormData` inside Node. You can also override the browser default if needed.\n\n```javascript\n// Set a timeout to all requests\ngrab.defaults.timeout = 60000;\n\n// Add a custom header to all requests\ngrab.defaults.headers['X-Custom-Header'] = 'CustomValue';\n```\n\nAny parameter inside **options** when calling `grab` will override the defaults. For example, you can put a timeout for all your requests by default but disable it for a particular long request by setting `timeout: 0` inside the options. Objects will also be overridden and not merged. Feel free to add any other default you need, they will be copied inside the options if possible. For example, you can do `grab.defaults.urlEncoded = true;` to make all your requests form url encoded by default.\n\n### Shortcuts\n\nThere is a shortcut for every HTTP methods, the syntax is `grab.[METHOD](url, [body], options)`. `POST`, `PUT` and `PATCH` supports a body parameter, all others don't.\n\n```javascript\ngrab.get('/users');\ngrab.post('/users', { id: 1, name: 'Paul', admin: true });\ngrab.put('/users/1', { name: 'Alex', admin: false });\ngrab.patch('/users/1', { admin: true })\ngrab.delete('/users/1');\n```\n\n### Methods\n\n#### grab.serialize\n\n**Parameters**\n\nA JavaScript object of key / value parameters.\n\n**Returns**\n\nA valid url query string.\n\n```javascript\ngrab.serialize({page: 2, limit: 20});\n// returns 'page=2&limit=20'\n```\n\n#### grab.resetDefaults\n\n**Parameters**\n\nNone\n\n**Returns**\n\nReset all defaults to their initial value and return it.\n\n### Logging\n\nYou can enable logs by providing a `grab.defaults.log` function. It takes only one parameter which has the following attributes:\n\n- **ok** (boolean): `true` if it's just an info, `false` if something went wrong.\n- **message** (string): what just happened.\n\n```javascript\ngrab.defaults.log = function (out) {\n  if (out.ok) {\n    console.log(out.message);\n  } else {\n    console.error(out.message);\n  }\n};\n```\n\n### Errors\n\nDepending on your parameters or the network response, the following errors can be triggered.\n\n- **TypeError**: probably something wrong with your parameters.\n- **NetworkError**: the XMLHttpRequest has failed.\n- **TimeoutError**: the request has reached its timeout.\n- **CancelError**: you have manually canceled the request.\n- **AbortError**: the XMLHttpRequest has been aborted but we don't really know why. Both `TimeoutError` and `CancelError` extend this error.\n\n```javascript\nimport grab from 'grab-http';\nimport { TimeoutError, CancelError } from 'grab-http';\n\ngrab('/api/users', { timeout: 10 })\n  .then(response=> {\n    console.log('All users', response.json());\n  })\n  .catch(error=> {\n    if (error instanceof TimeoutError) {\n      console.warn('Couldn\\'t make it in time...');\n    } else if (error instanceof CancelError) {\n      console.warn('Who canceled the request?!');\n    } else {\n      console.error(error);\n    }\n  });\n```\n\nYou can also use error codes from `grab.errors`, you have `network`, `timeout`, `cancel` and `abort`.\n\n```javascript\nimport grab from 'grab-http';\n\ngrab('/api/users', { timeout: 10 })\n  .then(response=> {\n    console.log('All users', response.json());\n  })\n  .catch(error=> {\n    if (error.code === grab.errors.timeout) {\n      console.warn('Couldn\\'t make it in time...');\n    } else if (error.code === grab.errors.cancel) {\n      console.warn('Who canceled the request?!');\n    } else {\n      console.error(error);\n    }\n  });\n```\n\n## Tests\n\nFirst start the dev server using `npm start` and then run the tests with `npm test`.\n\n## Thanks\n\nThanks a lot to [@gre](https://github.com/gre) for all the inspiration from [qajax](https://github.com/gre/qajax).\n\n## License\n\nThis software is licensed under the Apache 2 license, quoted below.\n\nCopyright 2015 Paul Dijou ([http://pauldijou.fr](http://pauldijou.fr)).\n\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use this project except in compliance with the License. You may obtain a copy of the License at [http://www.apache.org/licenses/LICENSE-2.0](http://www.apache.org/licenses/LICENSE-2.0).\n\nUnless required by applicable law or agreed to in writing, software distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.\n","created":"2015-09-22T15:16:55.199Z","modified":"2015-09-29T10:30:16.520Z","lastPublisher":{"name":"pauldijou","email":"paul.dijou@gmail.com"},"owners":[{"name":"pauldijou","email":"paul.dijou@gmail.com"}],"other":{"_attachments":{},"_from":".","_id":"grab-http","_nodeVersion":"3.3.0","_npmUser":{"name":"pauldijou","email":"paul.dijou@gmail.com"},"_npmVersion":"2.13.3","_rev":"1-4f6aade4890384783052d91169550728","_shasum":"4b0ada266ecc5d4c8ce1d81081313bd754477231","author":{"name":"Paul Dijou","url":"http://pauldijou.fr"},"bugs":{"url":"https://github.com/pauldijou/grab/issues"},"directories":{},"dist-tags":{"latest":"0.1.4"},"dist":{"shasum":"4b0ada266ecc5d4c8ce1d81081313bd754477231","tarball":"http://registry.npmjs.org/grab-http/-/grab-http-0.1.4.tgz"},"maintainers":[{"name":"pauldijou","email":"paul.dijou@gmail.com"}],"readmeFilename":"README.md","time":{"modified":"2015-09-29T10:30:16.520Z","created":"2015-09-22T15:16:55.199Z","0.1.0":"2015-09-22T15:16:55.199Z","0.1.1":"2015-09-22T15:40:52.194Z","0.1.2":"2015-09-23T09:59:47.097Z","0.1.3":"2015-09-23T15:35:11.516Z","0.1.4":"2015-09-29T10:30:16.520Z"}}}