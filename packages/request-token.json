{"name":"request-token","version":"0.2.0","description":"Generates tokens from http requests by converting the method, url and headers to parameters and rendering them with a [hogan](http://twitter.github.io/hogan.js/) template.","main":"index.js","scripts":{"test":"mocha --recursive tests"},"repository":"https://github.com/guidesmiths/request-token","keywords":["http","request","token","cache","key","template"],"license":"ISC","homepage":"https://github.com/guidesmiths/request-token","devDependencies":{"mocha":"^2.2.1","request":"^2.54.0"},"dependencies":{"async":"^0.9.0","debug":"^2.1.3","hogan.js":"^3.0.2","lodash":"^3.6.0","path-to-regexp":"^1.0.3"},"gitHead":"f6af8b5b6fb950f48155fbcc62ab8ade9b920151","versions":[{"number":"0.1.0","date":"2015-04-04T15:59:13.642Z"},{"number":"0.1.1","date":"2015-04-04T17:55:47.655Z"},{"number":"0.1.2","date":"2015-04-04T17:56:16.076Z"},{"number":"0.2.0","date":"2015-04-06T09:52:20.411Z"}],"readme":"# request-token\n\nGenerates tokens from http requests by converting the method, url and headers to parameters and rendering them with a [hogan](http://twitter.github.io/hogan.js/) template.\nPotentially useful for generating cache keys.\n\n## Installation\n```\nnpm install request-token\n```\n\n## Usage\n```js\nvar requestToken = require('request-token')\n\nfunction(req, res, next) {\n    requestToken({\n        pattern: '/api/:system/:version/:entity',\n        template: '{{method}}:{{params.system}}.{{params.version}}.{{params.entity}}:{{query.sortBy}}:{{query.page}}:{{headers:content-type}}'\n    }).generate(req, function(err, token) {\n        if (err) return next(err)\n        res.status(200).send(token + '\\n')\n    })\n})\n\n```\n\n```\n$ curl http://yourserver:3000/api/library/v1/books?sortBy=author&page=2 -H '{ Content-Type: application/json }'\nGET:library.v1.books:author:2:application/json\n```\n\n## Alternative HTTP Method Names\nThe most obvious use for this module is to generate cache keys, but we're using in [httq](https://github.com/guidesmiths/httq) to generate AMQP routing keys.\nOur architecture is event based, so instead of \"POST /api/library/v1/books\" we want \"library.v1.books.created\". We achieve this by configuring request-token with \"method_alt\" text.\n\n```js\nvar requestToken = require('request-token')\n\nfunction(req, res, next) {\n    requestToken({\n        pattern: '/api/:system/:version/:entity',\n        template: '{{params.system}}.{{params.version}}.{{params.entity}}.{{method_alt}}',\n        method_alt: {\n            \"GET\": \"requested\",\n            \"POST\": \"created\",\n            \"PUT\": \"amended\",\n            \"DELETED\": \"deleted\"\n        }\n    }).generate(req, function(err, token) {\n        if (err) return next(err)\n        res.status(200).send(token + '\\n')\n    })\n})\n\n```\n\n```\n$ curl -X POST http://yourserver:3000/api/library/v1/books\nlibrary.v1.books:created\n```\n\n## Available variables\n```json\n{\n  \"url\": {\n    \"protocol\": null,\n    \"slashes\": null,\n    \"auth\": null,\n    \"host\": null,\n    \"port\": null,\n    \"hostname\": null,\n    \"hash\": null,\n    \"search\": \"?sortBy=author&page=2\",\n    \"pathname\": \"/api/library/v1/books\",\n    \"path\": \"/api/library/v1/books?sortBy=author&page=2\",\n    \"href\": \"/api/library/v1/books?sortBy=author&page=2\"\n  },\n  \"url_lc\": {\n    \"protocol\": null,\n    \"slashes\": null,\n    \"auth\": null,\n    \"host\": null,\n    \"port\": null,\n    \"hostname\": null,\n    \"hash\": null,\n    \"search\": \"?sortby=author&page=2\",\n    \"pathname\": \"/api/library/v1/books\",\n    \"path\": \"/api/library/v1/books?sortby=author&page=2\",\n    \"href\": \"/api/library/v1/books?sortby=author&page=2\"\n  },\n  \"url_uc\": {\n    \"protocol\": null,\n    \"slashes\": null,\n    \"auth\": null,\n    \"host\": null,\n    \"port\": null,\n    \"hostname\": null,\n    \"hash\": null,\n    \"search\": \"?SORTBY=AUTHOR&PAGE=2\",\n    \"pathname\": \"/API/LIBRARY/V1/BOOKS\",\n    \"path\": \"/API/LIBRARY/V1/BOOKS?SORTBY=AUTHOR&PAGE=2\",\n    \"href\": \"/API/LIBRARY/V1/BOOKS?SORTBY=AUTHOR&PAGE=2\"\n  },\n  \"method\": \"GET\",\n  \"method_alt\": \"GET\",\n  \"method_lc\": \"get\",\n  \"method_uc\": \"GET\",\n  \"headers\": {\n    \"content-type\": \"application/json\",\n    \"host\": \"localhost:3000\",\n    \"connection\": \"keep-alive\"\n  },\n  \"headers_lc\": {\n    \"content-type\": \"application/json\",\n    \"host\": \"localhost:3000\",\n    \"connection\": \"keep-alive\"\n  },\n  \"headers_uc\": {\n    \"content-type\": \"APPLICATION/JSON\",\n    \"host\": \"LOCALHOST:3000\",\n    \"connection\": \"KEEP-ALIVE\"\n  },\n  \"params\": {\n    \"system\": \"library\",\n    \"version\": \"v1\",\n    \"entity\": \"books\"\n  },\n  \"params_lc\": {\n    \"system\": \"library\",\n    \"version\": \"v1\",\n    \"entity\": \"books\"\n  },\n  \"params_uc\": {\n    \"system\": \"LIBRARY\",\n    \"version\": \"V1\",\n    \"entity\": \"BOOKS\"\n  },\n  \"query\": {\n    \"sortBy\": \"author\",\n    \"page\": \"2\"\n  },\n  \"query_lc\": {\n    \"sortBy\": \"author\",\n    \"page\": \"2\"\n  },\n  \"query_uc\": {\n    \"sortBy\": \"AUTHOR\",\n    \"page\": \"2\"\n  }\n}\n```\n\n## Gotchas\n\n1. Depending on your client / server you may notice header names being lowercased automatically.\n\n","created":"2015-04-04T15:59:13.642Z","modified":"2015-04-06T09:52:20.411Z","lastPublisher":{"name":"guidesmiths","email":"stephen.cresswell@guidesmiths.com"},"owners":[{"name":"guidesmiths","email":"stephen.cresswell@guidesmiths.com"}],"other":{"_attachments":{},"_from":".","_id":"request-token","_npmUser":{"name":"guidesmiths","email":"stephen.cresswell@guidesmiths.com"},"_npmVersion":"1.4.28","_rev":"1-9ea7bdcc9526e1f62b9327f020d2ed55","_shasum":"3c8e5e166411041021cb0dea1fb09d7ce2b27096","author":{"name":"Stephen Cresswell"},"bugs":{"url":"https://github.com/guidesmiths/request-token/issues"},"directories":{},"dist-tags":{"latest":"0.2.0"},"dist":{"shasum":"3c8e5e166411041021cb0dea1fb09d7ce2b27096","tarball":"http://registry.npmjs.org/request-token/-/request-token-0.2.0.tgz"},"maintainers":[{"name":"guidesmiths","email":"stephen.cresswell@guidesmiths.com"}],"readmeFilename":"README.md","time":{"modified":"2015-04-06T09:52:20.411Z","created":"2015-04-04T15:59:13.642Z","0.1.0":"2015-04-04T15:59:13.642Z","0.1.1":"2015-04-04T17:55:47.655Z","0.1.2":"2015-04-04T17:56:16.076Z","0.2.0":"2015-04-06T09:52:20.411Z"}}}