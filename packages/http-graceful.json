{"name":"http-graceful","version":"1.0.0","description":"Gracefully open and close your http server","main":"index.js","scripts":{"test":"tape test.js"},"keywords":["http","server","open","close","sockets"],"license":"MIT","repository":"https://github.com/vweevers/http-graceful","dependencies":{"async-eventemitter":"^0.2.2","debug":"^2.1.0","http-close":"^0.0.2","xtend":"^4.0.0"},"devDependencies":{"cli-prompt":"^0.4.1","tape":"^3.0.3"},"gitHead":"fb40fa5e7f6a272399dba735ede43df47d422a3a","homepage":"https://github.com/vweevers/http-graceful","versions":[{"number":"0.0.1","date":"2014-11-26T23:07:23.292Z"},{"number":"1.0.0","date":"2014-12-01T15:08:14.835Z"}],"readme":"# http-graceful\n\n>Gracefully open and close a http server, its sockets and perhaps a database.\n\n## about\n\nCreates a function `start` that creates and opens a http server. Because `start` is an [AsyncEventEmitter](https://www.npmjs.org/package/async-eventemitter), you can add hooks, e.g. to open a database, that execute before or after the http server is opened. Likewise, you can add hooks that execute before or after the server is closed - either with `start.close()` or if the process receives a termination signal. Optionally, `http-graceful` will also close open connections.\n\nNote that if you don't call `start`, it will start in the next tick. Say you have an `app.js`, which exports `start`, like so:\n\n```js\nvar app = express()\n\nvar start = module.exports = httpGraceful(app, {\n  close_sockets: true,\n  sockets_timeout: 100\n})\n\nstart.on('before listen', function(opts, next){\n  openMyDatabase(function(err, db){\n    app.db = db\n    next(err)\n  })\n})\n\n// There's also a \"before close\" event, but\n// let's be safe and close the database \n// after all sockets have been closed.\nstart.on('close', function(opts, next){\n  app.db.close(next)\n})\n```\n\nTo start the server, the usual still works: `node app.js`. But also, in some other file:\n\n```js\nvar start = require('./app')\n\n// Bonus: you can override options\nstart({sockets_timeout: 200}, function(err, app){\n   // Server has started, database is open\n   doSomething()\n\n   // Or add your own options\n   start.close({foo: 'bar'}, function(){ \n      //..\n   })\n})\n\n// Without a callback argument, events are\n// synchronous (see `async-eventemitter`)\nstart.once('before close', function(opts){\n  assert(opts.foo==='bar')\n})\n```\n\nIf you call `start` when the server has already started, your callback will be called immediately and no events will be emitted. Same goes for `start.close()`.\n\nSee also the examples:\n\n    DEBUG=http-graceful node example/app.js \n    DEBUG=http-graceful node example/app-consumer.js \n\n## install\n\nWith [npm](https://npmjs.org) do:\n\n```\nnpm install http-graceful\n```\n\n## license\n\nMIT\n","created":"2014-11-26T23:07:23.292Z","modified":"2014-12-01T15:08:14.835Z","lastPublisher":{"name":"vweevers","email":"dev@vincentweevers.nl"},"owners":[{"name":"vweevers","email":"dev@vincentweevers.nl"}],"other":{"_attachments":{},"_from":".","_id":"http-graceful","_npmUser":{"name":"vweevers","email":"dev@vincentweevers.nl"},"_npmVersion":"1.4.14","_rev":"1-5595200725cec784ec65e6899a53ad23","_shasum":"1d7b1dcec513f51ce46f3af68ca9e69caa1c3965","author":{"name":"Vincent Weevers"},"bugs":{"url":"https://github.com/vweevers/http-graceful/issues"},"directories":{},"dist-tags":{"latest":"1.0.0"},"dist":{"shasum":"1d7b1dcec513f51ce46f3af68ca9e69caa1c3965","tarball":"http://registry.npmjs.org/http-graceful/-/http-graceful-1.0.0.tgz"},"maintainers":[{"name":"vweevers","email":"dev@vincentweevers.nl"}],"readmeFilename":"README.md","time":{"modified":"2014-12-01T15:08:14.835Z","created":"2014-11-26T23:07:23.292Z","0.0.1":"2014-11-26T23:07:23.292Z","1.0.0":"2014-12-01T15:08:14.835Z"}}}