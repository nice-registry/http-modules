{"name":"static-route","version":"0.2.0","description":"A route for an http server to safely serve static files","main":"./static-route.js","scripts":{"test":"for f in test/*.js; do echo \"$f\"; node \"$f\" || exit 1; echo; done; echo; echo Passed; exit 0"},"repository":"https://github.com/bahamas10/node-static-route","license":"MIT","dependencies":{"mime":"~1.2.9","he":"~0.4.1"},"gitHead":"c89a2793ac8ae34565602a9523b187e39e50b710","homepage":"https://github.com/bahamas10/node-static-route#readme","versions":[{"number":"0.0.0","date":"2013-04-30T05:53:55.853Z"},{"number":"0.0.1","date":"2013-05-18T17:28:24.951Z"},{"number":"0.0.2","date":"2013-05-18T17:57:30.855Z"},{"number":"0.0.3","date":"2013-05-18T18:10:10.552Z"},{"number":"0.0.4","date":"2013-09-06T18:51:22.839Z"},{"number":"0.0.5","date":"2013-09-10T03:01:58.401Z"},{"number":"0.0.6","date":"2013-10-22T14:54:38.586Z"},{"number":"0.0.7","date":"2013-11-04T17:25:49.945Z"},{"number":"0.0.8","date":"2013-11-04T20:20:27.190Z"},{"number":"0.0.9","date":"2013-11-07T20:40:25.291Z"},{"number":"0.0.10","date":"2013-11-09T19:12:58.687Z"},{"number":"0.0.11","date":"2013-11-13T18:04:16.965Z"},{"number":"0.0.12","date":"2013-12-19T19:28:50.865Z"},{"number":"0.1.0","date":"2014-01-17T19:32:35.998Z"},{"number":"0.1.1","date":"2014-06-11T17:30:04.685Z"},{"number":"0.1.2","date":"2017-03-12T18:37:10.253Z"},{"number":"0.2.0","date":"2017-03-27T18:29:11.583Z"}],"readme":"static-route\n============\n\nA route for an http server to safely serve static files\n\n*now supports streaming and ranges*\n\nInstallation\n------------\n\n    npm install static-route\n\nUsage\n-----\n\n``` js\nvar http = require('http');\nvar staticroute = require('static-route');\n\n// basic\nhttp.createServer(staticroute());\n// => this server will serve static files from `process.cwd()`\n```\n\n### Basic Invocation\n\n``` js\nvar http = require('http');\nvar staticroute = require('static-route');\nvar callback = staticroute();\n\nvar server = http.createServer(callback);\nserver.listen(8080);\n```\n\nThis server will serve static files out of your current directory with correct\nresponse codes, headers, and etags. For example:\n\n```\n$ curl -i http://localhost:8080\nHTTP/1.1 403 Forbidden\nDate: Mon, 29 Apr 2013 19:25:42 GMT\nConnection: keep-alive\nTransfer-Encoding: chunked\n\n$ curl -i http://localhost:8080/fake\nHTTP/1.1 404 Not Found\nDate: Mon, 29 Apr 2013 19:25:43 GMT\nConnection: keep-alive\nTransfer-Encoding: chunked\n\n$ curl -i http://localhost:8080/package.json\nHTTP/1.1 200 OK\nLast-Modified: Mon, 29 Apr 2013 01:03:28 GMT\nContent-Length: 494\nContent-Type: application/json\nETag: \"494-1367197408000\"\nDate: Mon, 29 Apr 2013 19:25:45 GMT\nConnection: keep-alive\n\n{\n  \"name\": \"static-route\",\n...\n```\n\nYou can see a 403 was generated for the first request, as it was for a directory.\n\nThe second request generated a 404 as the asset does not exist.\n\nThe third request was successful, it generated the proper headers, complete\nwith `ETag`, `Last-Modified`, `Content-Length`, and `Content-Type` (from the\n`mime` module).  Files are also served with `fs.createReadStream` so the entire\nfile contents are not read into memory before being sent to the client.\n\n### Advanced Invocations\n\nUsing the code above and changing the callback line to:\n\n``` js\nvar callback = staticroute('/');\n```\n\n```\n$ curl -i http://localhost:8080/etc/passwd\nHTTP/1.1 200 OK\nLast-Modified: Wed, 22 Feb 2012 00:57:33 GMT\nContent-Length: 5148\nContent-Type: application/octet-stream\nETag: \"5148-1329872253000\"\nDate: Mon, 29 Apr 2013 19:31:20 GMT\nConnection: keep-alive\n\nroot:*:0:0:root:/root:/bin/sh\n...\n```\n\nStatic files are being served from `/`, I wouldn't recommend doing this.\n\nSame thing as a above, modifying the callback line:\n\n``` js\nvar callback = staticroute({dir: process.cwd(), autoindex: true, logger: function() {}})\n```\n\nThis will serve out of your current directory (default behavior), with directory indexing enabled,\nand no logging.\n\n```\n$ curl -i http://localhost:8080/\nHTTP/1.1 200 OK\nContent-Type: text/html; charset=utf-8\nDate: Mon, 29 Apr 2013 19:37:13 GMT\nConnection: keep-alive\nTransfer-Encoding: chunked\n\n<ul>\n<li><a href=\"/\">.</a></li>\n<li><a href=\"/\">..</a></li>\n<li><a href=\"/REAMDE.md\">REAMDE.md</a></li>\n<li><a href=\"/examples\">examples</a></li>\n<li><a href=\"/node_modules\">node_modules</a></li>\n<li><a href=\"/package.json\">package.json</a></li>\n<li><a href=\"/static-route.js\">static-route.js</a></li>\n<li><a href=\"/test\">test</a></li>\n</ul>\n\n$ curl -i http://localhost:8080/?json\nHTTP/1.1 200 OK\nContent-Type: application/json; charset=utf-8\nDate: Mon, 29 Apr 2013 19:37:16 GMT\nConnection: keep-alive\nTransfer-Encoding: chunked\n\n[\".\", \"..\", \"REAMDE.md\",\"examples\",\"node_modules\",\"package.json\",\"static-route.js\",\"test\"]\n```\n\nAdd `?json` to directory requests to get JSON instead of HTML if `autoindex` is enabled\n\n### Logging\n\nBy default, any and all error messages from filesystem functions are logged\nwith `console.error`, this behavior can be changed, see below:\n\nFunctions\n---------\n\n### `staticroute([opts])`\n\nThe main export of the module.  This function, when called, returns a **function**\nsuitable for an http server request callback.\n\n`opts` is an optional object that contains configuration variables.  `opts` can also\nbe set to a string of the path to use to server static files.\n\n`opts`:\n\n- `dir`: The dir to serve static files from, defaults to `process.cwd()`\n- `autoindex`: If true, a request to a directory will return an index page for\nthe contents.  If false or unset, a request to a directory will return a 403.  Defaults to false\n- `logger`: The function to use to log error messages, defaults to `function () {}`\n- `tryfiles`: An array (defaults to `[]`) of files to try first, like NGINX. For example, set `opts.tryfiles = ['index.html']` to\nserve an index page if it exists\n- `slice`: A prefix to `req.url` to slice off\n\n### `function(req, res)`\n\nThe function returned from the above function.  This function takes the `req` and `res`\nobject from an http(s) server connection callback, and serves static contents.\n\nSecurity\n--------\n\nPath names are normalized and correctly joined (no regex, string manipulation, etc).  The `path` module\nand built in decoding functions are used to correctly parse the web addresses supplied.\n\n```\n$ curl -i http://localhost:8080/../../../../../../../etc/passwd\nHTTP/1.1 404 Not Found\nDate: Mon, 29 Apr 2013 19:39:54 GMT\nConnection: keep-alive\nTransfer-Encoding: chunked\n```\n\nand on the server\n\n```\nENOENT, stat '/Users/dave/dev/node-static-route/etc/passwd'\n```\n\nDirectory traversal is not possible, this module is stuck inside the directory you supply (or cwd).\nGo ahead, try it.\n\n```\n$ curl -i http://localhost:8080/%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd\nHTTP/1.1 404 Not Found\nDate: Mon, 29 Apr 2013 21:50:46 GMT\nConnection: keep-alive\nTransfer-Encoding: chunked\n```\n\nand on the server\n\n```\nENOENT, stat '/Users/dave/dev/node-static-route/%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd'\n```\n\nNotes\n-----\n\nI take security seriously.  If this module has any security holes, then this module has bugs.\nPlease report any and all security holes or bugs you find, or even better pull request a fix.\n\nLicense\n-------\n\nMIT\n","created":"2013-04-30T05:53:54.153Z","modified":"2017-03-27T18:29:11.583Z","lastPublisher":{"name":"bahamas10","email":"dave@daveeddy.com"},"owners":[{"name":"bahamas10","email":"dave@daveeddy.com"}],"other":{"_attachments":{},"_from":".","_id":"static-route","_nodeVersion":"0.10.40","_npmOperationalInternal":{"host":"packages-18-east.internal.npmjs.com","tmp":"tmp/static-route-0.2.0.tgz_1490639350969_0.9565150400158018"},"_npmUser":{"name":"bahamas10","email":"dave@daveeddy.com"},"_npmVersion":"2.14.4","_rev":"3-2cbe7824ce465707062da84d83d1cd8f","_shasum":"f7f44ef13ac7cceb521faf00fe8189f61f7d7769","author":{"name":"Dave Eddy","email":"dave@daveeddy.com","url":"http://www.daveeddy.com"},"bugs":{"url":"https://github.com/bahamas10/node-static-route/issues"},"directories":{},"dist-tags":{"latest":"0.2.0"},"dist":{"shasum":"f7f44ef13ac7cceb521faf00fe8189f61f7d7769","tarball":"https://registry.npmjs.org/static-route/-/static-route-0.2.0.tgz"},"maintainers":[{"name":"bahamas10","email":"dave@daveeddy.com"}],"readmeFilename":"README.md","time":{"modified":"2017-03-27T18:29:11.583Z","created":"2013-04-30T05:53:54.153Z","0.0.0":"2013-04-30T05:53:55.853Z","0.0.1":"2013-05-18T17:28:24.951Z","0.0.2":"2013-05-18T17:57:30.855Z","0.0.3":"2013-05-18T18:10:10.552Z","0.0.4":"2013-09-06T18:51:22.839Z","0.0.5":"2013-09-10T03:01:58.401Z","0.0.6":"2013-10-22T14:54:38.586Z","0.0.7":"2013-11-04T17:25:49.945Z","0.0.8":"2013-11-04T20:20:27.190Z","0.0.9":"2013-11-07T20:40:25.291Z","0.0.10":"2013-11-09T19:12:58.687Z","0.0.11":"2013-11-13T18:04:16.965Z","0.0.12":"2013-12-19T19:28:50.865Z","0.1.0":"2014-01-17T19:32:35.998Z","0.1.1":"2014-06-11T17:30:04.685Z","0.1.2":"2017-03-12T18:37:10.253Z","0.2.0":"2017-03-27T18:29:11.583Z"}}}