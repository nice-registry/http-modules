{"name":"node-fastcgi","version":"1.3.2","description":"Create FastCGI applications in node. Near drop-in replacement for node's http module.","keywords":["fcgi","fastcgi","server"],"homepage":"https://github.com/fbbdev/node-fastcgi","license":"MIT","main":"./index.js","engines":{"node":">= 0.12"},"dependencies":{"fastcgi-stream":"^1.0.0"},"repository":"https://github.com/fbbdev/node-fastcgi","devDependencies":{"chai":"^3.5.0","coveralls":"^2.11.9","fcgi-handler":"git+https://github.com/aredridel/fcgi-handler.git#afe16eae560280d5dd84241d0c45e5db0f939d25","istanbul":"^0.4.3","lodash":"^4.9.0","mocha":"^2.4.5","mocha-lcov-reporter":"^1.2.0","request":"^2.70.0"},"scripts":{"test":"mocha ./test/mocha/integration","coveralls":"istanbul cover --report lcovonly ./node_modules/mocha/bin/_mocha -- ./test/mocha/integration && cat ./coverage/lcov.info | ./node_modules/.bin/coveralls"},"gitHead":"2ce0cc956564d79800ac73da6047a54c7616a879","versions":[{"number":"0.1.2","date":"2013-12-19T14:09:18.360Z"},{"number":"0.1.4","date":"2013-12-19T22:29:59.027Z"},{"number":"0.1.5","date":"2013-12-19T23:17:53.075Z"},{"number":"0.1.6","date":"2013-12-20T00:22:37.492Z"},{"number":"0.1.7","date":"2013-12-20T21:51:22.873Z"},{"number":"0.1.8","date":"2014-08-27T10:27:04.991Z"},{"number":"0.1.9","date":"2015-02-06T14:11:31.866Z"},{"number":"0.1.10","date":"2015-05-29T08:11:14.756Z"},{"number":"0.1.11","date":"2016-04-09T16:17:58.707Z"},{"number":"1.0.0","date":"2016-04-09T16:22:38.658Z"},{"number":"1.1.0","date":"2016-05-20T08:41:36.856Z"},{"number":"1.2.0","date":"2016-05-20T11:54:46.906Z"},{"number":"1.2.1","date":"2016-05-30T11:59:19.664Z"},{"number":"1.2.2","date":"2016-08-06T08:40:57.108Z"},{"number":"1.3.0","date":"2016-08-24T00:11:26.999Z"},{"number":"1.3.1","date":"2016-09-29T08:20:38.760Z"},{"number":"1.3.2","date":"2016-10-18T13:58:14.788Z"}],"readme":"node-fastcgi\n============\n\n[![Build Status](https://travis-ci.org/fbbdev/node-fastcgi.svg?branch=master)](https://travis-ci.org/fbbdev/node-fastcgi)\n[![Coverage Status](https://coveralls.io/repos/github/fbbdev/node-fastcgi/badge.svg?branch=master)](https://coveralls.io/github/fbbdev/node-fastcgi?branch=master)\n[![Dependency Status](https://gemnasium.com/fbbdev/node-fastcgi.svg)](https://gemnasium.com/fbbdev/node-fastcgi)\n[![devDependency Status](https://david-dm.org/fbbdev/node-fastcgi/dev-status.svg)](https://david-dm.org/fbbdev/node-fastcgi#info=devDependencies)\n[![MIT License](http://img.shields.io/badge/license-MIT-blue.svg?style=flat)](LICENSE)\n\n[![NPM](https://nodei.co/npm/node-fastcgi.png?downloads=true)](https://nodei.co/npm/node-fastcgi/)\n\nThis module is a drop-in replacement for node's standard http module (server only). Code written for a http server should work without changes with FastCGI. It can be used to build FastCGI applications or to convert existing node applications to FastCGI.\n\nThe implementation is fully compliant with the [FastCGI 1.0 Specification](https://fast-cgi.github.io/spec).\n\n\nExample\n-------\n\n```javascript\nvar fcgi = require('node-fastcgi');\n\nfcgi.createServer(function(req, res) {\n  if (req.method === 'GET') {\n    res.writeHead(200, { 'Content-Type': 'text/plain' });\n    res.end(\"It's working\");\n  } else if (req.method === 'POST') {\n    res.writeHead(200, { 'Content-Type': 'text/plain' });\n    var body = \"\";\n\n    req.on('data', function(data) { body += data.toString(); });\n    req.on('end', function() {\n      res.end(\"Received data:\\n\" + body);\n    });\n  } else {\n    res.writeHead(501);\n    res.end();\n  }\n}).listen();\n```\n\n\nServer constructor\n------------------\n\nThe `createServer` function takes four **optional** parameters:\n\n  - `responder`: callback for FastCGI responder requests (normal HTTP requests, listener for the `'request'` event).\n  - `authorizer`: callback for FastCGI authorizer requests (listener for the `'authorize'` event)\n  - `filter`: callback for FastCGI filter requests (listener for the `'filter'` event)\n  - `config`: server configuration\n\n`config` is an object with the following defaults:\n\n```js\n{\n  maxConns: 2000,\n  maxReqs: 2000,\n  multiplex: true,\n  valueMap: {}\n}\n```\n\n`maxConns` is the maximum number of connections accepted by the server. This limit is not enforced, it is only used to provide the FCGI_MAX_CONNS value when queried by a FCGI_GET_VALUES record.\n\n`maxReqs` is the maximum number of total concurrent requests accepted by the server (over all connections). The limit is not enforced, but compliant clients should respect it, so do not set it too low. This setting is used to provide the FCGI_MAX_REQS value.\n\n`multiplex` enables or disables request multiplexing on a single connection. This setting is used to provide the FCGI_MPXS_CONNS value.\n\n`valueMap` maps FastCGI value names to keys in the `config` object. For more information read [the next section](#fastcgi-values)\n\n\nFastCGI values\n--------------\n\nFastCGI clients can query configuration values from applications with FCGI_GET_VALUES records. Those records contain a sequence of key-value pairs with empty values; the application must fetch the corresponding values for each key and send the data back to the client.\n\nThis module retrieves automatically values for standard keys (`FCGI_MAX_CONNS`, `FCGI_MAX_REQS`, `FCGI_MPXS_CONNS`) from server configuration.\n\nTo provide additional values, add them to the configuration object and add entries to the `valueMap` option mapping value names to keys in the config object. For example:\n\n```js\nfcgi.createServer(function (req, res) { /* ... */ }, {\n    additionalValue: 1350,\n    valueMap: {\n        'ADDITIONAL_VALUE': 'additionalValue'\n    }\n});\n```\n\n**WARNING: This `valueMap` thing is complete nonsense and is definitely going to change in the next release.**\n\n\nListening for connections\n-------------------------\n\nWhen a FastCGI service is started, the stdin descriptor (fd 0) [is replaced by a bound socket](https://fast-cgi.github.io/spec#accepting-transport-connections). The service application can then start listening on that socket and accept connections.\n\nThis is done automatically when you call the `listen` method on the server object without arguments, or with a callback as the only argument.\n\nThe `isService` function is provided to check if the listen method can be\ncalled without arguments. **WARNING: The function always returns false on\nwindows.** FastCGI services on Windows should obtain the stdin handle by\ncalling `GetStdHandle(-10)` from `kernel32.dll`.\n\n```js\nif (fcgi.isService()) {\n    fcgi.createServer(/* ... */).listen();\n} else {\n    console.log(\"This script must be run as a FastCGI service\");\n}\n```\n\n\nRequest URL components\n----------------------\n\nThe `url` property of the request object is taken from the `REQUEST_URI` CGI variable, which is non-standard. If `REQUEST_URI` is missing, the url is built by joining three CGI variables:\n\n  - [`SCRIPT_NAME`](https://tools.ietf.org/html/rfc3875#section-4.1.13)\n  - [`PATH_INFO`](https://tools.ietf.org/html/rfc3875#section-4.1.5)\n  - [`QUERY_STRING`](https://tools.ietf.org/html/rfc3875#section-4.1.7)\n\nFor more information read [section 4.1](https://tools.ietf.org/html/rfc3875#section-4.1) of the CGI spec.\n\nRaw CGI variables can be accessed through the `params` property of the socket object. More information [here](#the-socket-object).\n\n\nAuthorizer and filter requests\n------------------------------\n\nAuthorizer requests have no url. Response objects for the authorizer role expose three additional methods:\n\n  - `setVariable(name, value)`: sets CGI variables to be passed to subsequent request handlers.\n  - `allow()`: responds with 200 (OK) status code.\n  - `deny()`: responds with 403 (Forbidden) status code.\n\nFilter requests have an additional data stream exposed by the `data` property of [the socket object](#the-socket-object) (`req.socket.data`).\n\n\nThe socket object\n-----------------\n\nThe socket object exposed in requests and responses implements the `stream.Duplex` interface. It exposes the FastCGI stdin stream (request body)\nand translates writes to stdout FastCGI records.\nThe object also emulates the public API of `net.Socket`. Address fields contain HTTP server and client address and port (`localAddress`, `localPort`, `remoteAddress`, `remotePort` properties and the `address` method).\n\nThe socket object exposes three additional properties:\n  - `params` is a dictionary of raw CGI params.\n  - `dataStream` implements `stream.Readable`, exposes the FastCGI data stream for the filter role.\n  - `errorStream` implements `stream.Writable`, translates writes to stderr FastCGI Records.\n\n\nhttp module compatibility\n-------------------------\n\nThe API is almost compatible with the http module from node v0.12 all the way to v6.x (the current series). Only the server API is implemented.\n\nDifferences:\n  - A FastCGI server will never emit `'checkContinue'` and `'connect'` events because `CONNECT` method and `Expect: 100-continue` headers should be handled by the front-end http server\n  - The `'upgrade'` event is not currently implemented. Typically upgrade/websocket requests won't work with FastCGI applications because of input/output buffering.\n  - `server.listen()` can be called without arguments (or with a callback as the only argument) to listen on the default FastCGI socket `{ fd: 0 }`.\n  - `server.maxHeadersCount` is useless\n  - `req.socket` [is not a real socket](#the-socket-object).\n  - `req.trailers` will always be empty: CGI scripts never receive trailers\n  - `res.writeContinue()` works as expected but should not be used. See first item\n\n\nLicense\n=======\n\nThe MIT License (MIT)\n\nCopyright (c) 2016 Fabio Massaioli and other contributors\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of\nthis software and associated documentation files (the \"Software\"), to deal in\nthe Software without restriction, including without limitation the rights to\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\nthe Software, and to permit persons to whom the Software is furnished to do so,\nsubject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\nFOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\nCOPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\nIN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\nCONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n","created":"2013-12-19T14:03:28.246Z","modified":"2016-10-18T13:58:14.788Z","lastPublisher":{"name":"fbbdev","email":"fabio.massaioli@gmail.com"},"owners":[{"name":"fbbdev","email":"fabio@massaioli.it"}],"other":{"_attachments":{},"_from":".","_id":"node-fastcgi","_nodeVersion":"6.8.1","_npmOperationalInternal":{"host":"packages-16-east.internal.npmjs.com","tmp":"tmp/node-fastcgi-1.3.2.tgz_1476799091688_0.6536914010066539"},"_npmUser":{"name":"fbbdev","email":"fabio.massaioli@gmail.com"},"_npmVersion":"3.10.8","_rev":"1-3ca268f332ad116f39f6d568ad6adf7f","_shasum":"4246ab2803f344ed7f6dfb3b7e01d4144a73d4dd","author":{"name":"Fabio Massaioli","email":"fabio.massaioli@gmail.com"},"bugs":{"url":"https://github.com/fbbdev/node-fastcgi/issues"},"directories":{},"dist-tags":{"latest":"1.3.2"},"dist":{"shasum":"4246ab2803f344ed7f6dfb3b7e01d4144a73d4dd","tarball":"http://registry.npmjs.org/node-fastcgi/-/node-fastcgi-1.3.2.tgz"},"maintainers":[{"name":"fbbdev","email":"fabio@massaioli.it"}],"readmeFilename":"README.md","time":{"modified":"2016-10-18T13:58:14.788Z","created":"2013-12-19T14:03:28.246Z","0.1.2":"2013-12-19T14:09:18.360Z","0.1.4":"2013-12-19T22:29:59.027Z","0.1.5":"2013-12-19T23:17:53.075Z","0.1.6":"2013-12-20T00:22:37.492Z","0.1.7":"2013-12-20T21:51:22.873Z","0.1.8":"2014-08-27T10:27:04.991Z","0.1.9":"2015-02-06T14:11:31.866Z","0.1.10":"2015-05-29T08:11:14.756Z","0.1.11":"2016-04-09T16:17:58.707Z","1.0.0":"2016-04-09T16:22:38.658Z","1.1.0":"2016-05-20T08:41:36.856Z","1.2.0":"2016-05-20T11:54:46.906Z","1.2.1":"2016-05-30T11:59:19.664Z","1.2.2":"2016-08-06T08:40:57.108Z","1.3.0":"2016-08-24T00:11:26.999Z","1.3.1":"2016-09-29T08:20:38.760Z","1.3.2":"2016-10-18T13:58:14.788Z"}}}