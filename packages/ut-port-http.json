{"name":"ut-port-http","description":"UT port http module","version":"6.4.9","browser":{"request":"browser-request","timers":"timers-browserify"},"dependencies":{"browser-request":"0.3.3","lodash.assign":"4.2.0","request":"2.79.0","timers-browserify":"2.0.2","ut-error":"^5.4.0","when":"3.7.7","xml2js":"0.4.17"},"devDependencies":{"ut-tools":"^5.13.5"},"peerDependencies":{"ut-bus":"^5.9.0"},"scripts":{"lint":"ut-lint .","release":"ut-release","changelog":"ut-changelog","check":"ut-check","cover":"ut-cover","lint-js":"ut-lint-js .","postpublish":"ut-postpublish","postversion":"ut-postversion","precommit":"ut-precommit","prepublish":"ut-prepublish","prepush":"ut-prepush","pretest":"ut-pretest","preversion":"ut-preversion","test":"ut-test","version":"ut-version","jenkins":"ut-jenkins","gitlab":"ut-gitlab"},"repository":"https://github.com/softwaregroup-bg/ut-port-http","license":"Apache-2.0","gitHead":"b637f4db6cdc5e34218d7861573c8d274c1a64b5","homepage":"https://github.com/softwaregroup-bg/ut-port-http#readme","versions":[{"number":"6.1.4","date":"2016-08-12T18:36:26.721Z"},{"number":"6.2.0","date":"2016-08-26T11:33:12.402Z"},{"number":"6.3.0","date":"2016-09-15T05:43:18.968Z"},{"number":"6.3.1","date":"2016-09-20T09:21:26.513Z"},{"number":"6.3.5","date":"2016-09-21T08:50:59.402Z"},{"number":"6.3.6","date":"2016-09-26T10:43:41.477Z"},{"number":"6.3.7","date":"2016-10-11T06:23:09.606Z"},{"number":"6.3.8","date":"2016-10-11T19:14:20.011Z"},{"number":"6.3.9","date":"2016-10-12T14:53:12.772Z"},{"number":"6.3.10","date":"2016-10-12T14:57:25.299Z"},{"number":"6.3.11","date":"2016-10-24T12:28:55.375Z"},{"number":"6.3.12","date":"2016-11-04T09:33:14.425Z"},{"number":"6.3.13","date":"2016-11-23T13:52:53.722Z"},{"number":"6.3.14","date":"2016-11-25T13:42:07.889Z"},{"number":"6.3.15","date":"2016-12-15T08:32:00.819Z"},{"number":"6.4.0","date":"2016-12-23T12:32:18.570Z"},{"number":"6.4.1","date":"2017-03-08T10:01:56.254Z"},{"number":"6.4.2","date":"2017-04-24T09:35:42.296Z"},{"number":"6.4.3","date":"2017-05-04T12:00:30.259Z"},{"number":"6.4.4","date":"2017-05-22T12:30:43.070Z"},{"number":"6.4.5","date":"2017-05-22T12:48:28.442Z"},{"number":"6.4.6","date":"2017-05-22T13:03:45.340Z"},{"number":"6.4.7","date":"2017-05-22T13:14:57.567Z"},{"number":"6.4.8","date":"2017-05-22T13:21:09.340Z"},{"number":"6.4.9","date":"2017-05-22T13:30:26.965Z"}],"readme":"# UT Port HTTP Client\n\nCreate http/s requests based on [`request`](https://github.com/request/request/blob/master/README.md#requestoptions-callback) module\n\n## USAGE\n\n#### Configuration index file required otions:\n\n```\n    id: '',\n    type: 'http',\n    logLevel: '',\n    url: '',\n    uri: '',\n    method: '',\n\n    receive:function(msg) {\n        return msg;\n    },\n    send:function(msg) {\n        return msg;\n    }\n```\n\n * `id`: unique identification of port \n \n * `logLevel`: trace, debug or info. \n \n * `url`: remote server URL `http://example.com:80`.\n \n * `uri`: remote server request URI `/about.html`.\n \n * `method`: http request method `POST` or `GET`.  \n \n * `receive`: incoming message convert function , return object or promise.\n \n * `send`: outgoing message convert function, return object or promise .\n \n Additional configuration options:\n \n* `raw`: this property can be set in config file only, everything in this property will be merged with current configuration\n\n* `parseResponse`: to parse the response or not, defaults to `true`\n\n* `requestTimeout`: in ms, time before timeout error emmit, defaults to 30 sec.\n\n* `headers`: object containing request header values.\n\n* `namespace`: Array containing diferent namespaces of this port.\n\n* `start`: function that will be called once on creation of port. It can be used for setting global variables and initialising objects.\n\n#### Response:\n\nResponse is always an object containing response from remote server or error.           \nIf server returns status code different from `200 (OK)` or some error occured during the process, the response message object will look like:\n```javascript\n{\n    $$:{\n        mtid: 'error',\n        errorCode: '',\n        errorMessage: ''\n    }\n}\n```\n\nMessage proporties:\n* `payload`: Contains response data returned from the remote server. If header `content-type` contains `/xml` and `parseResponse = true` the data will be converted to javascript object, the same is for Json, if for some reason `parseResponse=true` and there is not parser available for parsing the response, error will be emitted \n* `headers`: Response headers.\n* `httpStatus`: Response status code.\n\n## Example\n\nExample `index.js` configuration file used for making web service requests to external system. `Send` and `receive` are used for modifying message object just before it is sent and just after response is received.\n```javascript\nvar xmpParser = require('./xmlParser');\nvar loadTemplate;\nmodule.exports = {\n    id: 't24',\n    type: 'http',\n    logLevel: 'trace',\n    url: 'http://twsdevcloudservice.cloudapp.net',\n    uri: '/swg/swg.svc',\n    method: 'post',\n    namespace: ['cbs'],\n\n    start: function() {\n        loadTemplate = this.bus.importMethod('template.load');\n    },\n\n    receive:function(msg) {\n        if(msg.$$.mtid == 'error'){\n            return msg;\n        }\n        return xmpParser.parse(msg.$$.opcode, msg.payload)\n            .then(function(res) {\n\n                if(res.successIndicator != 'Success'){\n                    msg.$$.mtid = 'error';\n                    msg.$$.errorCode = res.messageId;\n                    msg.$$.errorMessage = Array.isArray(res.message) ? res.message.join('; ') : res.message;\n                    return msg;\n                }\n                msg.payload = res;\n                return msg;\n            });\n    },\n\t\n    send:function(msg) {\n        msg.headers = {'Content-Type': 'text/xml'};\n        var templatePath = require.resolve('./' + msg.$$.opcode + '.xml.marko');\n\n        var template = loadTemplate(templatePath);\n\n        return template.render(msg).then(function(res) {\n            msg.payload = res;\n            msg.$$.opcode = msg.opcode || msg.$$.opcode;\n            return msg;\n        });\n    }\n};\n\n\n```\n","created":"2016-08-12T18:36:26.721Z","modified":"2017-05-22T13:30:26.965Z","lastPublisher":{"name":"kalin.krustev","email":"kalin.krustev@gmail.com"},"owners":[{"name":"kalin.krustev","email":"kalin.krustev@gmail.com"}],"other":{"_attachments":{},"_from":".","_id":"ut-port-http","_nodeVersion":"6.9.5","_npmOperationalInternal":{"host":"s3://npm-registry-packages","tmp":"tmp/ut-port-http-6.4.9.tgz_1495459825961_0.6253179693594575"},"_npmUser":{"name":"kalin.krustev","email":"kalin.krustev@gmail.com"},"_npmVersion":"3.10.9","_rev":"16-38f5baa769865c835988427af4f27711","_shasum":"41b69183023b37074be2b9f6d69eaa107fb6c86c","bugs":{"url":"https://github.com/softwaregroup-bg/ut-port-http/issues"},"directories":{},"dist-tags":{"latest":"6.4.9"},"dist":{"shasum":"41b69183023b37074be2b9f6d69eaa107fb6c86c","tarball":"https://registry.npmjs.org/ut-port-http/-/ut-port-http-6.4.9.tgz"},"maintainers":[{"name":"kalin.krustev","email":"kalin.krustev@gmail.com"}],"readmeFilename":"README.MD","time":{"modified":"2017-05-22T13:30:26.965Z","created":"2016-08-12T18:36:26.721Z","6.1.4":"2016-08-12T18:36:26.721Z","6.2.0":"2016-08-26T11:33:12.402Z","6.3.0":"2016-09-15T05:43:18.968Z","6.3.1":"2016-09-20T09:21:26.513Z","6.3.5":"2016-09-21T08:50:59.402Z","6.3.6":"2016-09-26T10:43:41.477Z","6.3.7":"2016-10-11T06:23:09.606Z","6.3.8":"2016-10-11T19:14:20.011Z","6.3.9":"2016-10-12T14:53:12.772Z","6.3.10":"2016-10-12T14:57:25.299Z","6.3.11":"2016-10-24T12:28:55.375Z","6.3.12":"2016-11-04T09:33:14.425Z","6.3.13":"2016-11-23T13:52:53.722Z","6.3.14":"2016-11-25T13:42:07.889Z","6.3.15":"2016-12-15T08:32:00.819Z","6.4.0":"2016-12-23T12:32:18.570Z","6.4.1":"2017-03-08T10:01:56.254Z","6.4.2":"2017-04-24T09:35:42.296Z","6.4.3":"2017-05-04T12:00:30.259Z","6.4.4":"2017-05-22T12:30:43.070Z","6.4.5":"2017-05-22T12:48:28.442Z","6.4.6":"2017-05-22T13:03:45.340Z","6.4.7":"2017-05-22T13:14:57.567Z","6.4.8":"2017-05-22T13:21:09.340Z","6.4.9":"2017-05-22T13:30:26.965Z"}}}